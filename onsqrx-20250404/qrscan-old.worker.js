"use strict";(()=>{var y=[];function ue(...r){}globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION||(globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION=globalThis.console);var ft=globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION;var mt=null,or=(y??[]).map(r=>r.split(".")),te=ft;globalThis.console===te&&(globalThis.console=new Proxy(te,{get:()=>ue}));function le(r){return yt(r,or)||mt&&!yt(r,mt)?{log:ue,warn:ue,error:(e,...t)=>te.error(`[${r}] ${e}`,...t),info:ue,debug:ue}:{log:(e,...t)=>te.log(`[${r}] ${e}`,...t),warn:(e,...t)=>te.warn(`[${r}] ${e}`,...t),error:(e,...t)=>te.error(`[${r}] ${e}`,...t),info:(e,...t)=>te.info(`[${r}] ${e}`,...t),debug:(e,...t)=>te.debug(`[${r}] ${e}`,...t)}}function yt(r,e){let t=r.split(".");for(let n of e){let o=0,s=!0;for(;o<t.length;){if(n[o]==="*"){if(n.length-1===o){s=!0;break}o+=1;continue}if(n[o]===t[o]){o+=1;continue}s=!1;break}if(s)return!0}return!1}var me=globalThis.browser??globalThis.chrome;me&&me.runtime&&(me.runtime.OnInstalledReason=me.runtime.OnInstalledReason??{INSTALL:"install",UPDATE:"update",CHROME_UPDATE:"chrome_update",SHARED_MODULE_UPDATE:"shared_module_update"});var sr={},oo=le("m.barcode_api_polyfill"),dt={"zbar.wasm":"./module_statics/barcode-api-polyfill/zbar.wasm"};var so=new Proxy(sr,{get:(r,e,t)=>{if(e==="Content"){let n=globalThis.ContentModule?.barcodeApiPolyfill;if(!n)throw globalThis.ServiceWorkerGlobalScope?new Error("Content modules can not be loaded in a background script"):new Error("Content modules can only be loaded after initialization");return n}if(e==="Background"){let n=globalThis.BackgroundModule?.barcodeApiPolyfill;if(!n)throw globalThis.ServiceWorkerGlobalScope?new Error("Background modules can only be loaded after initialization"):new Error("Background modules can not be loaded in a content script");return n}}});var Ee={};function Q(r,e,t,n){return new(t||(t=Promise))(function(o,s){function u(O){try{U(n.next(O))}catch(j){s(j)}}function m(O){try{U(n.throw(O))}catch(j){s(j)}}function U(O){var j;O.done?o(O.value):(j=O.value,j instanceof t?j:new t(function(c){c(j)})).then(u,m)}U((n=n.apply(r,e||[])).next())})}var Ve,ir=(Ve=Ee.url,async function(r={}){var e,t,n=r;n.ready=new Promise((i,a)=>{e=i,t=a});var o,s,u,m=Object.assign({},n),U=typeof window=="object",O=typeof importScripts=="function",j=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",c="";if(j){let{createRequire:i}=await Promise.resolve().then(()=>lr);var V=i(Ee.url),W=V("fs"),De=V("path");c=O?De.dirname(c)+"/":V("url").fileURLToPath(new URL("./",Ee.url)),o=(a,d)=>(a=xe(a)?new URL(a):De.normalize(a),W.readFileSync(a,d?void 0:"utf8")),u=a=>{var d=o(a,!0);return d.buffer||(d=new Uint8Array(d)),d},s=(a,d,l,v=!0)=>{a=xe(a)?new URL(a):De.normalize(a),W.readFile(a,v?void 0:"utf8",(H,$)=>{H?l(H):d(v?$.buffer:$)})},!n.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),n.inspect=()=>"[Emscripten Module object]"}else(U||O)&&(O?c=self.location.href:typeof document<"u"&&document.currentScript&&(c=document.currentScript.src),Ve&&(c=Ve),c=c.indexOf("blob:")!==0?c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=i=>{var a=new XMLHttpRequest;return a.open("GET",i,!1),a.send(null),a.responseText},O&&(u=i=>{var a=new XMLHttpRequest;return a.open("GET",i,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),s=(i,a,d)=>{var l=new XMLHttpRequest;l.open("GET",i,!0),l.responseType="arraybuffer",l.onload=()=>{l.status==200||l.status==0&&l.response?a(l.response):d()},l.onerror=d,l.send(null)});var pe,he,q,Jt=n.print||console.log.bind(console),ie=n.printErr||console.error.bind(console);Object.assign(n,m),m=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&n.quit,n.wasmBinary&&(pe=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&st("no native wasm support detected");var Ze,be,et=!1;function tt(){var i=he.buffer;n.HEAP8=new Int8Array(i),n.HEAP16=new Int16Array(i),n.HEAP32=new Int32Array(i),n.HEAPU8=Ze=new Uint8Array(i),n.HEAPU16=new Uint16Array(i),n.HEAPU32=be=new Uint32Array(i),n.HEAPF32=new Float32Array(i),n.HEAPF64=new Float64Array(i)}var rt=[],nt=[],ot=[],oe=0,fe=null;function st(i){n.onAbort&&n.onAbort(i),ie(i="Aborted("+i+")"),et=!0,i+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(i);throw t(a),a}var ae,Me,Xt="data:application/octet-stream;base64,";function it(i){return i.startsWith(Xt)}function xe(i){return i.startsWith("file://")}function at(i){if(i==ae&&pe)return new Uint8Array(pe);if(u)return u(i);throw"both async and sync fetching of the wasm failed"}function ut(i,a,d){return function(l){if(!pe&&(U||O)){if(typeof fetch=="function"&&!xe(l))return fetch(l,{credentials:"same-origin"}).then(v=>{if(!v.ok)throw"failed to load wasm binary file at '"+l+"'";return v.arrayBuffer()}).catch(()=>at(l));if(s)return new Promise((v,H)=>{s(l,$=>v(new Uint8Array($)),H)})}return Promise.resolve().then(()=>at(l))}(i).then(l=>WebAssembly.instantiate(l,a)).then(l=>l).then(d,l=>{ie("failed to asynchronously prepare wasm: "+l),st(l)})}n.locateFile?it(ae="zbar.wasm")||(Me=ae,ae=n.locateFile?n.locateFile(Me,c):c+Me):ae=new URL("zbar.wasm",Ee.url).href;var _e,$e=i=>{for(;i.length>0;)i.shift()(n)},Qt=i=>{var a=i-he.buffer.byteLength+65535>>>16;try{return he.grow(a),tt(),1}catch{}},lt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,er=[null,[],[]],tr=(i,a)=>{var d=er[i];a===0||a===10?((i===1?Jt:ie)(((l,v,H)=>{for(var $=v+H,z=v;l[z]&&!(z>=$);)++z;if(z-v>16&&l.buffer&&lt)return lt.decode(l.subarray(v,z));for(var J="";v<z;){var Y=l[v++];if(128&Y){var we=63&l[v++];if((224&Y)!=192){var Ae=63&l[v++];if((Y=(240&Y)==224?(15&Y)<<12|we<<6|Ae:(7&Y)<<18|we<<12|Ae<<6|63&l[v++])<65536)J+=String.fromCharCode(Y);else{var pt=Y-65536;J+=String.fromCharCode(55296|pt>>10,56320|1023&pt)}}else J+=String.fromCharCode((31&Y)<<6|we)}else J+=String.fromCharCode(Y)}return J})(d,0)),d.length=0):d.push(a)},rr={d:()=>!0,e:function(){return Date.now()},c:i=>{var a=Ze.length,d=2147483648;if((i>>>=0)>d)return!1;for(var l,v,H=1;H<=4;H*=2){var $=a*(1+.2/H);$=Math.min($,i+100663296);var z=Math.min(d,(l=Math.max(i,$))+((v=65536)-l%v)%v);if(Qt(z))return!0}return!1},f:i=>52,b:function(i,a,d,l,v){return 70},a:(i,a,d,l)=>{for(var v=0,H=0;H<d;H++){var $=be[a>>2],z=be[a+4>>2];a+=8;for(var J=0;J<z;J++)tr(i,Ze[$+J]);v+=z}return be[l>>2]=v,0}};function ct(){function i(){_e||(_e=!0,n.calledRun=!0,et||($e(nt),e(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)a=n.postRun.shift(),ot.unshift(a);var a;$e(ot)}()))}oe>0||(function(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)a=n.preRun.shift(),rt.unshift(a);var a;$e(rt)}(),oe>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),i()},1)):i()))}if(function(){var i,a,d,l,v={a:rr};function H($,z){var J,Y=$.exports;return he=(q=Y).g,tt(),q.s,J=q.h,nt.unshift(J),function(we){if(oe--,n.monitorRunDependencies&&n.monitorRunDependencies(oe),oe==0&&fe){var Ae=fe;fe=null,Ae()}}(),Y}if(oe++,n.monitorRunDependencies&&n.monitorRunDependencies(oe),n.instantiateWasm)try{return n.instantiateWasm(v,H)}catch($){ie("Module.instantiateWasm callback failed with error: "+$),t($)}(i=pe,a=ae,d=v,l=function($){H($.instance)},i||typeof WebAssembly.instantiateStreaming!="function"||it(a)||xe(a)||j||typeof fetch!="function"?ut(a,d,l):fetch(a,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,d).then(l,function(z){return ie("wasm streaming compile failed: "+z),ie("falling back to ArrayBuffer instantiation"),ut(a,d,l)}))).catch(t)}(),n._ImageScanner_create=()=>(n._ImageScanner_create=q.i)(),n._ImageScanner_destory=i=>(n._ImageScanner_destory=q.j)(i),n._ImageScanner_set_config=(i,a,d,l)=>(n._ImageScanner_set_config=q.k)(i,a,d,l),n._ImageScanner_enable_cache=(i,a)=>(n._ImageScanner_enable_cache=q.l)(i,a),n._ImageScanner_recycle_image=(i,a)=>(n._ImageScanner_recycle_image=q.m)(i,a),n._ImageScanner_get_results=i=>(n._ImageScanner_get_results=q.n)(i),n._ImageScanner_scan=(i,a)=>(n._ImageScanner_scan=q.o)(i,a),n._Image_create=(i,a,d,l,v,H)=>(n._Image_create=q.p)(i,a,d,l,v,H),n._Image_destory=i=>(n._Image_destory=q.q)(i),n._Image_get_symbols=i=>(n._Image_get_symbols=q.r)(i),n._free=i=>(n._free=q.t)(i),n._malloc=i=>(n._malloc=q.u)(i),fe=function i(){_e||ct(),_e||(fe=i)},n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return ct(),r.ready}),je;function Ke(r={}){je=function(){return Q(this,void 0,void 0,function*(){let e=yield ir(r);if(e)return e;throw Error("WASM was not loaded")})}()}function He(){return Q(this,void 0,void 0,function*(){return je||Ke(),yield je})}var se,ce,gt;(function(r){r[r.ZBAR_NONE=0]="ZBAR_NONE",r[r.ZBAR_PARTIAL=1]="ZBAR_PARTIAL",r[r.ZBAR_EAN2=2]="ZBAR_EAN2",r[r.ZBAR_EAN5=5]="ZBAR_EAN5",r[r.ZBAR_EAN8=8]="ZBAR_EAN8",r[r.ZBAR_UPCE=9]="ZBAR_UPCE",r[r.ZBAR_ISBN10=10]="ZBAR_ISBN10",r[r.ZBAR_UPCA=12]="ZBAR_UPCA",r[r.ZBAR_EAN13=13]="ZBAR_EAN13",r[r.ZBAR_ISBN13=14]="ZBAR_ISBN13",r[r.ZBAR_COMPOSITE=15]="ZBAR_COMPOSITE",r[r.ZBAR_I25=25]="ZBAR_I25",r[r.ZBAR_DATABAR=34]="ZBAR_DATABAR",r[r.ZBAR_DATABAR_EXP=35]="ZBAR_DATABAR_EXP",r[r.ZBAR_CODABAR=38]="ZBAR_CODABAR",r[r.ZBAR_CODE39=39]="ZBAR_CODE39",r[r.ZBAR_PDF417=57]="ZBAR_PDF417",r[r.ZBAR_QRCODE=64]="ZBAR_QRCODE",r[r.ZBAR_SQCODE=80]="ZBAR_SQCODE",r[r.ZBAR_CODE93=93]="ZBAR_CODE93",r[r.ZBAR_CODE128=128]="ZBAR_CODE128",r[r.ZBAR_SYMBOL=255]="ZBAR_SYMBOL",r[r.ZBAR_ADDON2=512]="ZBAR_ADDON2",r[r.ZBAR_ADDON5=1280]="ZBAR_ADDON5",r[r.ZBAR_ADDON=1792]="ZBAR_ADDON"})(se||(se={})),function(r){r[r.ZBAR_CFG_ENABLE=0]="ZBAR_CFG_ENABLE",r[r.ZBAR_CFG_ADD_CHECK=1]="ZBAR_CFG_ADD_CHECK",r[r.ZBAR_CFG_EMIT_CHECK=2]="ZBAR_CFG_EMIT_CHECK",r[r.ZBAR_CFG_ASCII=3]="ZBAR_CFG_ASCII",r[r.ZBAR_CFG_BINARY=4]="ZBAR_CFG_BINARY",r[r.ZBAR_CFG_NUM=5]="ZBAR_CFG_NUM",r[r.ZBAR_CFG_MIN_LEN=32]="ZBAR_CFG_MIN_LEN",r[r.ZBAR_CFG_MAX_LEN=33]="ZBAR_CFG_MAX_LEN",r[r.ZBAR_CFG_UNCERTAINTY=64]="ZBAR_CFG_UNCERTAINTY",r[r.ZBAR_CFG_POSITION=128]="ZBAR_CFG_POSITION",r[r.ZBAR_CFG_TEST_INVERTED=129]="ZBAR_CFG_TEST_INVERTED",r[r.ZBAR_CFG_X_DENSITY=256]="ZBAR_CFG_X_DENSITY",r[r.ZBAR_CFG_Y_DENSITY=257]="ZBAR_CFG_Y_DENSITY"}(ce||(ce={})),function(r){r[r.ZBAR_ORIENT_UNKNOWN=-1]="ZBAR_ORIENT_UNKNOWN",r[r.ZBAR_ORIENT_UP=0]="ZBAR_ORIENT_UP",r[r.ZBAR_ORIENT_RIGHT=1]="ZBAR_ORIENT_RIGHT",r[r.ZBAR_ORIENT_DOWN=2]="ZBAR_ORIENT_DOWN",r[r.ZBAR_ORIENT_LEFT=3]="ZBAR_ORIENT_LEFT"}(gt||(gt={}));var Re=class{constructor(e,t){this.ptr=e,this.inst=t}checkAlive(){if(!this.ptr)throw Error("Call after destroyed")}getPointer(){return this.checkAlive(),this.ptr}},Te=class{constructor(e,t){this.ptr=e,this.ptr32=e>>2,this.buf=t,this.HEAP8=new Int8Array(t),this.HEAPU32=new Uint32Array(t),this.HEAP32=new Int32Array(t)}},We=class r extends Te{get type(){return this.HEAPU32[this.ptr32]}get data(){let e=this.HEAPU32[this.ptr32+4],t=this.HEAPU32[this.ptr32+5];return Int8Array.from(this.HEAP8.subarray(t,t+e))}get points(){let e=this.HEAPU32[this.ptr32+7],t=this.HEAPU32[this.ptr32+8]>>2,n=[];for(let o=0;o<e;++o){let s=this.HEAP32[t+2*o],u=this.HEAP32[t+2*o+1];n.push({x:s,y:u})}return n}get orientation(){return this.HEAP32[this.ptr32+9]}get next(){let e=this.HEAPU32[this.ptr32+11];return e?new r(e,this.buf):null}get time(){return this.HEAPU32[this.ptr32+13]}get cacheCount(){return this.HEAP32[this.ptr32+14]}get quality(){return this.HEAP32[this.ptr32+15]}},qe=class extends Te{get head(){let e=this.HEAPU32[this.ptr32+2];return e?new We(e,this.buf):null}},ke=class r{constructor(e){this.type=e.type,this.typeName=se[this.type],this.data=e.data,this.points=e.points,this.orientation=e.orientation,this.time=e.time,this.cacheCount=e.cacheCount,this.quality=e.quality}static createSymbolsFromPtr(e,t){if(e==0)return[];let n=new qe(e,t).head,o=[];for(;n!==null;)o.push(new r(n)),n=n.next;return o}decode(e){return new TextDecoder(e).decode(this.data)}},Ge=class extends Re{static createFromGrayBuffer(e,t,n,o=0){return Q(this,void 0,void 0,function*(){let s=yield He(),u=new Uint8Array(n),m=e*t;if(m!==u.byteLength)throw Error(`data length (${u.byteLength} bytes) does not match width and height (${m} bytes)`);let U=s._malloc(m);return s.HEAPU8.set(u,U),new this(s._Image_create(e,t,808466521,U,m,o),s)})}static createFromRGBABuffer(e,t,n,o=0){return Q(this,void 0,void 0,function*(){let s=yield He(),u=new Uint8Array(n),m=e*t;if(4*m!==u.byteLength)throw Error(`data length (${u.byteLength} bytes) does not match width and height (${4*m} bytes)`);let U=s._malloc(m),O=U+m,j=s.HEAPU8;for(let c=U,V=0;c<O;c++,V+=4)j[c]=19595*u[V]+38469*u[V+1]+7472*u[V+2]>>16;return new this(s._Image_create(e,t,808466521,U,m,o),s)})}destroy(){this.checkAlive(),this.inst._Image_destory(this.ptr),this.ptr=0}getSymbols(){this.checkAlive();let e=this.inst._Image_get_symbols(this.ptr);return ke.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}},ze=class extends Re{static create(){return Q(this,void 0,void 0,function*(){let e=yield He();return new this(e._ImageScanner_create(),e)})}destroy(){this.checkAlive(),this.inst._ImageScanner_destory(this.ptr),this.ptr=0}setConfig(e,t,n){return this.checkAlive(),this.inst._ImageScanner_set_config(this.ptr,e,t,n)}enableCache(e=!0){this.checkAlive(),this.inst._ImageScanner_enable_cache(this.ptr,e)}recycleImage(e){this.checkAlive(),this.inst._ImageScanner_recycle_image(this.ptr,e.getPointer())}getResults(){this.checkAlive();let e=this.inst._ImageScanner_get_results(this.ptr);return ke.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}scan(e){return this.checkAlive(),this.inst._ImageScanner_scan(this.ptr,e.getPointer())}},Ye=()=>Q(void 0,void 0,void 0,function*(){let r=yield ze.create();return r.setConfig(se.ZBAR_NONE,ce.ZBAR_CFG_BINARY,1),r}),ht,ar=(r,e)=>Q(void 0,void 0,void 0,function*(){e===void 0&&(e=ht||(yield Ye()),ht=e);let t=e.scan(r);if(t<0)throw Error("Scan Failed");return t===0?[]:r.getSymbols()});var ur=(r,e,t,n)=>Q(void 0,void 0,void 0,function*(){let o=yield Ge.createFromRGBABuffer(e,t,r),s=yield ar(o,n);return o.destroy(),s}),bt=(r,e)=>Q(void 0,void 0,void 0,function*(){return yield ur(r.data.buffer,r.width,r.height,e)}),lr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var cr=function(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t},pr=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Be,f=class extends Error{constructor(e,t){super(t),Be.set(this,void 0),cr(this,Be,e,"f")}get key(){return pr(this,Be,"f")}};Be=new WeakMap;function L(r,e,t){return(n,o="")=>{try{let s=e.reduce((u,m)=>m(u,o),n);return t?.(s,o),fr(o,r,s)}catch(s){return xt(n,s)}}}function xt(r,e){return{initialValue:r,hasError:!0,error:e}}function fr(r,e,t){try{return e.forEach(n=>n(t,r)),{initialValue:t,result:t,hasError:!1}}catch(n){return xt(t,n)}}var G=(r,e,t,n)=>(o,s="")=>{if(!(r?!e(o):e(o)))throw new f(s,`${t??typeof o} '${o}' ${r?"is":"is not"} ${n}`)};function mr(r,e,t,n){return`${r} ${e} is${n?" ":" not "}${t}`}function re(r){return(e,t,n,o,s)=>{if(!t())throw new f(e,mr(r,n,o,s))}}var Se=re("array"),_t=r=>e=>(t,n="")=>{Se(n,()=>r?t.length!==e:t.length===e,`of length ${t.length}`,`of exact length ${e}`,r)},yr=r=>e=>(t,n="")=>{Se(n,()=>r?t.length<e:t.length>=e,`of length ${t.length}`,`within minimum length of ${e}`,r)},dr=r=>e=>(t,n="")=>{Se(n,()=>r?t.length>e:t.length<=e,`of length ${t.length}`,`within maximum length of ${e}`,r)},wt=r=>()=>(e,t="")=>{Se(t,()=>r?e.length!==0:e.length===0,`of length ${e.length}`,"empty",r)};function ye(r=[]){let e=[],t=L(e,r,(n,o="")=>{if(!Array.isArray(n))throw new f(o,`Value ${n} is not an array`)});return t.toString=D(t,n=>n.join(", ")),t.toNumber=Z(t,n=>Number(n)),t.toBoolean=M(t,n=>!!n),t.toCustom=F(t),t.assert=(n,o)=>(e.push(G(!1,n,"array",o)),t),t.ofExactLength=n=>(e.push(_t(!1)(n)),t),t.ofMinLength=n=>(e.push(yr(!1)(n)),t),t.ofMaxLength=n=>(e.push(dr(!1)(n)),t),t.empty=()=>(e.push(wt(!1)()),t),t.not={assert:(n,o)=>(e.push(G(!0,n,"array",o)),t),empty:()=>(e.push(wt(!0)()),t),ofExactLength:n=>(e.push(_t(!0)(n)),t)},t.items=function(n){return ye([(o,s="")=>{let u=t(o,s);if(u.hasError)throw u.error;let m=u.result.map((U,O)=>n(U,[s,`[${O}]`].filter(Boolean).join(".")));if(m.some(U=>U.hasError))throw m.filter(U=>U.hasError);return m.reduce((U,O)=>(O.hasError||U.push(O.result),U),[])}])},t}var Rt=re("boolean"),At=r=>()=>(e,t="")=>{Rt(t,()=>r?!e:e,e,"true",r)},Et=r=>()=>(e,t="")=>{Rt(t,()=>r?e:!e,e,"false",r)};function Ne(r=[]){let e=[],t=L(e,r,(o,s="")=>{if(typeof o!="boolean")throw new f(s,`Value ${o} is not a boolean`)});t.toString=D(t,o=>o.toString()),t.toNumber=Z(t,o=>o?1:0),t.toBoolean=M(t,o=>o),t.toCustom=F(t),t.toArray=K(t);let n=o=>(s,u)=>(e.push(G(o,s,"boolean",u)),t);return t.assert=n(!1),t.true=()=>(e.push(At(!1)()),de(!0,t)),t.false=()=>(e.push(Et(!1)()),de(!1,t)),t.not={assert:n(!0),true:()=>(e.push(At(!0)()),de(!1,t)),false:()=>(e.push(Et(!0)()),de(!0,t))},t}function Tt(r=[]){let t=L([],r,(n,o="")=>{if(typeof n!="boolean")throw new f(o,`Value ${n} is not a boolean`);if(n!==!1)throw new f(o,`Value ${n} must be false`)});return t.toString=D(t,n=>n.toString()),t.toNumber=Z(t,n=>n?1:0),t.toBoolean=M(t,n=>n),t.toCustom=F(t),t.toArray=K(t),t}function kt(r=[]){let t=L([],r,(n,o="")=>{if(typeof n!="boolean")throw new f(o,`Value ${n} is not a boolean`);if(n!==!0)throw new f(o,`Value ${n} must be true`)});return t.toString=D(t,n=>n.toString()),t.toNumber=Z(t,n=>n?1:0),t.toBoolean=M(t,n=>n),t.toCustom=F(t),t.toArray=K(t),t}function Bt(r=[]){let e=[],t=L(e,r);t.toString=D(t,()=>""),t.toNumber=Z(t,()=>0),t.toBoolean=M(t,()=>!1),t.toCustom=F(t),t.toArray=K(t);let n=o=>(s,u)=>(e.push(G(o,s,"custom value",u)),t);return t.assert=n(!1),t.not={assert:n(!0)},t}var ne=re("number"),St=r=>e=>(t,n="")=>{if(!(r?e.indexOf(t)===-1:e.indexOf(t)!==-1))throw new f(n,`Number value ${t} ${r?`is one of the disallowed values in [${e.join(", ")}]`:`is not one of the allowed values in [${e.join(", ")}]`}`)},Nt=r=>()=>(e,t="")=>{ne(t,()=>r?e<0:e>0,e,"positive",r)},Pt=r=>()=>(e,t="")=>{ne(t,()=>r?e>0:e<0,e,"negative",r)},It=r=>()=>(e,t="")=>{ne(t,()=>r?e!==0:e===0,e,"zero",r)},Ct=r=>e=>(t,n="")=>{ne(n,()=>r?t>=e:t<e,t,`less than ${e}`,r)},Ut=r=>e=>(t,n="")=>{ne(n,()=>r?t<=e:t>e,t,`more than ${e}`,r)},vt=r=>e=>(t,n="")=>{ne(n,()=>r?t!==e:t===e,t,`equal to ${e}`,r)},Ot=r=>e=>(t,n="")=>{ne(n,()=>r?t%e!==0:t%e===0,t,`a multiple of ${e}`,r)},Ft=r=>()=>(e,t="")=>{ne(t,()=>r?!Number.isInteger(e):Number.isInteger(e),e,"an integer",r)};function Pe(r=[]){let e=[],t=L(e,r,(o,s="")=>{if(typeof o!="number")throw new f(s,`Value ${o} is not a number`)});t.toString=D(t,o=>o.toString()),t.toNumber=Z(t,o=>o),t.toBoolean=M(t,o=>o!==0),t.toCustom=F(t),t.toArray=K(t);let n=o=>(s,u)=>(e.push(G(o,s,"number",u)),t);return t.assert=n(!1),t.allowed=(...o)=>(e.push(St(!1)(o)),t),t.integer=()=>(e.push(Ft(!1)()),t),t.positive=()=>(e.push(Nt(!1)()),t),t.negative=()=>(e.push(Pt(!1)()),t),t.lessThan=o=>(e.push(Ct(!1)(o)),t),t.moreThan=o=>(e.push(Ut(!1)(o)),t),t.zero=()=>(e.push(It(!1)()),t),t.multipleOf=o=>(e.push(Ot(!1)(o)),t),t.equals=o=>(e.push(vt(!1)(o)),t),t.not={assert:n(!0),allowed:(...o)=>(e.push(St(!0)(o)),t),integer:()=>(e.push(Ft(!0)()),t),positive:()=>(e.push(Nt(!0)()),t),negative:()=>(e.push(Pt(!0)()),t),lessThan:o=>(e.push(Ct(!0)(o)),t),moreThan:o=>(e.push(Ut(!0)(o)),t),zero:()=>(e.push(It(!0)()),t),multipleOf:o=>(e.push(Ot(!0)(o)),t),equals:o=>(e.push(vt(!0)(o)),t)},t}function Ie(r=[]){let e=[],t=L(e,r);t.toCustom=F(t);let n=o=>(s,u)=>(e.push(G(o,s,"custom value",u)),t);return t.assert=n(!1),t.not={assert:n(!0)},t}function D(r,e){return(t=e)=>Ce([(n,o="")=>{let s=r(n,o);if(s.hasError)throw s.error;try{return t(s.result)}catch(u){throw new f(o,`Unable to create a string from ${typeof s.result} ${s.result}

 ${u instanceof Error?u.message:u}`)}}])}function Z(r,e){return(t=e)=>Pe([(n,o="")=>{let s=r(n,o);if(s.hasError)throw s.error;try{return t(s.result)}catch(u){throw new f(o,`Unable to create a number from ${typeof s.result} ${s.result}

 ${u instanceof Error?u.message:u}`)}}])}function M(r,e){return(t=e)=>Ne([(n,o="")=>{let s=r(n,o);if(s.hasError)throw s.error;try{return t(s.result)}catch(u){throw new f(o,`Unable to create a booolean from ${typeof s.result} ${s.result}

 ${u instanceof Error?u.message:u}`)}}])}function F(r){return e=>Bt([(t,n="")=>{let o=r(t,n);if(o.hasError)throw o.error;try{return e(o.result)}catch(s){throw new f(n,`Unable to create custom type from ${typeof o.result} ${o.result}

 ${s instanceof Error?s.message:s}`)}}])}function K(r){return e=>ye([(t,n="")=>{let o=r(t,n);if(o.hasError)throw o.error;try{return e(o.result)}catch(s){throw new f(n,`Unable to create an array from ${typeof o.result} ${o.result}

 ${s instanceof Error?s.message:s}`)}}])}function Je(r){return Ie([(e,t="")=>{let n=r(e,t);if(n.hasError)throw n.error;return e}])}function de(r,e){return(r?kt:Tt)([(n,o="")=>{let s=e(n,o);if(s.hasError)throw s.error;return n}])}var $t=re("string"),Lt=(r,e)=>t=>(n,o="")=>{$t(o,()=>{let s=e?t:t.toLowerCase(),u=e?n:n.toLowerCase();return r?u!==s:u===s},n,"equal to",r)},Dt=(r,e)=>t=>(n,o="")=>{let s=e?t:t.map(U=>U.toLowerCase()),u=e?n:n.toLowerCase();if(!(r?s.indexOf(u)===-1:s.indexOf(u)!==-1))throw new f(o,`String value ${n} ${r?`is one of the disallowed values in [${t.join(", ")}]`:`is not one of the allowed values in [${t.join(", ")}]`}`)},Zt=r=>()=>(e,t="")=>{$t(t,()=>r?e.length!==0:e.length===0,e,"empty",r)},Mt=r=>e=>(t,n="")=>{if(!(r?!e.test(t):e.test(t)))throw new f(n,`String value '${t}' ${r?"matches":"does not match"} pattern ${e}`)};function Ce(r=[]){let e=[],t={enabled:!0},n=L(e,r,(s,u="")=>{if(typeof s!="string")throw new f(u,`Value ${s} is not a string`)});n.toString=D(n,s=>s),n.toNumber=Z(n,s=>Number(s)),n.toBoolean=M(n,s=>!!s),n.toCustom=F(n),n.toArray=K(n);let o=s=>(u,m)=>(e.push(G(s,u,"string",m)),n);return n.assert=o(!1),n.allowed=(...s)=>(e.push(Dt(!1,t.enabled)(s)),Je(n)),n.matches=s=>(e.push(Mt(!1)(s)),n),n.empty=()=>(e.push(Zt(!1)()),n),n.equals=s=>(e.push(Lt(!1,t.enabled)(s)),Je(n)),n.case=s=>(t.enabled=s==="sensitive",n),n.not={assert:o(!0),allowed:(...s)=>(e.push(Dt(!0,t.enabled)(s)),n),matches:s=>(e.push(Mt(!0)(s)),n),empty:()=>(e.push(Zt(!0)()),n),equals:s=>(e.push(Lt(!0,t.enabled)(s)),n)},n}function Ue(...r){return(e,t="")=>{let n=[];for(let o of r){let s=o(e,t);if(!s.hasError)return s;n.push(s)}return{hasError:!0,initialValue:e,error:n}}}function ve(r=[]){let e=L([],r,(t,n="")=>{if(t!==void 0)throw new f(n,`Value ${t} is not undefined`)});return e.toString=D(e,()=>String(void 0)),e.toNumber=Z(e,()=>NaN),e.toBoolean=M(e,()=>!1),e.toCustom=F(e),e.toArray=K(e),e}function Oe(...r){return Ue(ve(),...r)}function Fe(r=[]){let e=[],t=L(e,r,(o,s="")=>{if(o===null||typeof o!="object"||Array.isArray(o))throw new f(s,`Value ${o} is not an object`)});t.toString=D(t,o=>String(o)),t.toNumber=Z(t,o=>Number(o)),t.toBoolean=M(t,o=>!!o),t.toCustom=F(t);let n=o=>(s,u)=>(e.push(G(o,s,"object",u)),t);return t.assert=n(!1),t.not={assert:n(!0)},t.schema=function(o){return Fe([(s,u="")=>{let m=t(s,u);if(m.hasError)throw m.error;let U={...s??{},...m.result},O=Object.entries(o).map(([c,V])=>[c,V(U[c],[u,c].filter(Boolean).join("."))]),j=O.filter(([,c])=>c.hasError);if(j.length>0)throw j.reduce((c,[V,W])=>(c[V]=W,c),{});return O.reduce((c,[V,W])=>(W.hasError||(c[V]=W.result),c),U)}])},t.partial=function(o){return Fe([(s,u="")=>{let m=t(s,u);if(m.hasError)throw m.error;let U={...s??{},...m.result},O=Object.entries(o).map(([c,V])=>{let W=Oe(V)(U[c],[u,c].filter(Boolean).join("."));return W.hasError&&console.error("ERROR IS HERE",W.error),[c,W]}),j=O.filter(([,c])=>c.hasError);if(j.length>0)throw j.reduce((c,[V,W])=>(c[V]=W,c),{});return O.reduce((c,[V,W])=>(W.hasError||W.result!==void 0&&(c[V]=W.result),c),U)}])},t}function Vt(r=[]){let e=L([],r,(t,n="")=>{if(t!==null)throw new f(n,`Value ${t} is not null`)});return e.toString=D(e,()=>String(null)),e.toNumber=Z(e,()=>0),e.toBoolean=M(e,()=>!1),e.toCustom=F(e),e}function jt(){let r=L([],[],(e,t="")=>{if(e!==null)throw new f(t,`Value ${e} is not an error`)});return r.toString=D(r,e=>String(e)),r.toNumber=Z(r,()=>0),r.toBoolean=M(r,()=>!1),r.toCustom=F(r),r}function Ht(r){let e=(t,n="")=>{if(!t||typeof t!="object"||Array.isArray(t))return{initialValue:t,hasError:!0,error:new f(n,`Value ${t} is not a record`)};let o=Object.entries(t).map(([s,u],m)=>r(u,[s,`[${m}]`].filter(Boolean).join(".")));return o.some(s=>s.hasError)?{initialValue:t,hasError:!0,error:o.filter(s=>s.hasError)}:{hasError:!1,initialValue:t,result:t}};return e.toString=D(e,t=>String(t)),e.toNumber=Z(e,t=>Number(t)),e.toBoolean=M(e,t=>!!t),e.toCustom=F(e),e.toArray=K(e),e}var p={string:Ce,number:Pe,boolean:Ne,array:ye,object:Fe,error:jt,null:Vt,undefined:ve,oneof:Ue,stringUnion:Ie,record:Ht,optional:Oe,anything:()=>r=>({initialValue:r,hasError:!1,result:r})};function X(r){return e=>!r(e).hasError}function Wt(r){return!!(r&&typeof r=="object"&&!Array.isArray(r))}function qt(r){return{success:!1,error:r}}function Gt(r){return{success:!0,value:r}}function ge(r){try{let e=r();return zt(e)?e:Gt(e)}catch(e){return qt(e)}}async function Le(r){try{let e=await r();return zt(e)?e:Gt(e)}catch(e){return qt(e)}}function zt(r){return Wt(r)&&typeof r.success=="boolean"&&(r.success&&"value"in r||!r.success&&"error"in r)}function Kt(r){return ge(()=>JSON.stringify(r))}var ee=class r extends Error{_error;_type;_state;static SerializedType="JSONableError";constructor(e){super(typeof e=="string"?e:void 0),this._error=typeof e=="string"?this:e,this._type=r.SerializedType}toJSON(){return{__serialized_type:this._type,stack:this._error.stack,message:this._error.message,name:this._error.name,state:this._state}}static create(e){if(e instanceof Error)return new r(e);if(typeof e=="string"||typeof e=="boolean"||typeof e=="number"||typeof e=="symbol"||typeof e=="bigint"||typeof e=="function")return new r(e.toString());if(hr(e))return br(e);let t=Kt(e);return t.success?new r(t.value):new r("Unserializeable data error")}setState(e){this._state=e}},gr=p.object().schema({__serialized_type:p.string().equals(ee.SerializedType),stack:p.optional(p.string()),message:p.string(),name:p.string(),state:p.anything()}),hr=X(gr);function br(r){let e=new Error;return e.stack=r.stack,e.name=r.name,e.message=r.message,new ee(e)}var Xe=class r extends ee{static SerializedType="UnexpectedResponseError";constructor(e,t={}){super(`Expected [${e}] response was not valid`),this._type=r.SerializedType,this.setState({expectedType:e,errors:t})}},xr=p.object().schema({__serialized_type:p.string().equals(Xe.SerializedType),stack:p.optional(p.string()),message:p.string(),name:p.string(),state:p.object().schema({expectedType:p.string(),errors:p.record(p.string())})}),Wm=X(xr);var _r=p.object().schema({result_type:p.string().allowed("string_literal","serialized_error"),result_value:p.string()});function Qe(r,e){return{result_type:r,result_value:e}}var od=X(_r);var wr=p.object().schema({keepalive:p.oneof(p.number(),p.boolean().false()),maxConcurrency:p.oneof(p.string().equals("max"),p.number())}),Ar=p.object().schema({ready:p.boolean().true(),poolSettings:wr}),Ud=X(Ar),vd=le("offscreen.initialize_worker");function Yt(r){self.postMessage("ready"),self.addEventListener("message",async e=>{let{bytes:t,parameters:n}=e.data;t!==null&&!(t instanceof Uint8Array)&&self.postMessage(Qe("serialized_error",JSON.stringify(ee.create("Invalid binary data in request"))));try{let o=await r(t,n);self.postMessage(o)}catch(o){self.postMessage(Qe("serialized_error",JSON.stringify(ee.create(o))))}})}var Er=le("worker.zbar_barcode_scanner"),Rr=dt["zbar.wasm"];Ke({locateFile:()=>Rr});var Tr=p.object().schema({colorSpace:p.string().allowed("srgb","display-p3"),height:p.number(),width:p.number()}),kr=X(Tr);Yt(async(r,e)=>{if(!kr(e))throw new Error("Unknown call or parameters");if(!r)throw new Error("No image data was provided");let t=new Uint8ClampedArray(r),n=await Br(t,e);if(!n.success)return Er.warn("Error in QR code reading with ZBAR",n.error),JSON.stringify(null);let o=n.value.map(s=>ge(()=>s.decode())).filter(s=>s.success).map(s=>s.value);return JSON.stringify(Array.from(new Set(o)))});function Br(r,e){return Le(async()=>{let t=await Ye();return t.setConfig(se.ZBAR_NONE,ce.ZBAR_CFG_ENABLE,0),t.setConfig(se.ZBAR_QRCODE,ce.ZBAR_CFG_ENABLE,1),bt({...e,data:r},t)})}})();
