"use strict";(()=>{var qo=Object.defineProperty;var Ho=(n,e)=>{for(var t in e)qo(n,t,{get:e[t],enumerable:!0})};var x=[];globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION||(globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION=globalThis.console);var ni=globalThis.I_TRULY_NEED_THE_RAW_CONSOLE_NOT_THE_PROXY_VERSION;var Se=globalThis.browser??globalThis.chrome;Se&&Se.runtime&&(Se.runtime.OnInstalledReason=Se.runtime.OnInstalledReason??{INSTALL:"install",UPDATE:"update",CHROME_UPDATE:"chrome_update",SHARED_MODULE_UPDATE:"shared_module_update"});var Yo=function(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},Jo=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Ft,j=class extends Error{constructor(e,t){super(t),Ft.set(this,void 0),Yo(this,Ft,e,"f")}get key(){return Jo(this,Ft,"f")}};Ft=new WeakMap;function ie(n,e,t){return(r,i="")=>{try{let s=e.reduce((o,a)=>a(o,i),r);return t?.(s,i),Ko(i,n,s)}catch(s){return ii(r,s)}}}function ii(n,e){return{initialValue:n,hasError:!0,error:e}}function Ko(n,e,t){try{return e.forEach(r=>r(t,n)),{initialValue:t,result:t,hasError:!1}}catch(r){return ii(t,r)}}var ve=(n,e,t,r)=>(i,s="")=>{if(!(n?!e(i):e(i)))throw new j(s,`${t??typeof i} '${i}' ${n?"is":"is not"} ${r}`)};function Xo(n,e,t,r){return`${n} ${e} is${r?" ":" not "}${t}`}function ze(n){return(e,t,r,i,s)=>{if(!t())throw new j(e,Xo(n,r,i,s))}}var Lt=ze("array"),si=n=>e=>(t,r="")=>{Lt(r,()=>n?t.length!==e:t.length===e,`of length ${t.length}`,`of exact length ${e}`,n)},Qo=n=>e=>(t,r="")=>{Lt(r,()=>n?t.length<e:t.length>=e,`of length ${t.length}`,`within minimum length of ${e}`,n)},Zo=n=>e=>(t,r="")=>{Lt(r,()=>n?t.length>e:t.length<=e,`of length ${t.length}`,`within maximum length of ${e}`,n)},oi=n=>()=>(e,t="")=>{Lt(t,()=>n?e.length!==0:e.length===0,`of length ${e.length}`,"empty",n)};function gt(n=[]){let e=[],t=ie(e,n,(r,i="")=>{if(!Array.isArray(r))throw new j(i,`Value ${r} is not an array`)});return t.toString=se(t,r=>r.join(", ")),t.toNumber=oe(t,r=>Number(r)),t.toBoolean=ae(t,r=>!!r),t.toCustom=te(t),t.assert=(r,i)=>(e.push(ve(!1,r,"array",i)),t),t.ofExactLength=r=>(e.push(si(!1)(r)),t),t.ofMinLength=r=>(e.push(Qo(!1)(r)),t),t.ofMaxLength=r=>(e.push(Zo(!1)(r)),t),t.empty=()=>(e.push(oi(!1)()),t),t.not={assert:(r,i)=>(e.push(ve(!0,r,"array",i)),t),empty:()=>(e.push(oi(!0)()),t),ofExactLength:r=>(e.push(si(!0)(r)),t)},t.items=function(r){return gt([(i,s="")=>{let o=t(i,s);if(o.hasError)throw o.error;let a=o.result.map((l,u)=>r(l,[s,`[${u}]`].filter(Boolean).join(".")));if(a.some(l=>l.hasError))throw a.filter(l=>l.hasError);return a.reduce((l,u)=>(u.hasError||l.push(u.result),l),[])}])},t}var ui=ze("boolean"),ai=n=>()=>(e,t="")=>{ui(t,()=>n?!e:e,e,"true",n)},li=n=>()=>(e,t="")=>{ui(t,()=>n?e:!e,e,"false",n)};function Pt(n=[]){let e=[],t=ie(e,n,(i,s="")=>{if(typeof i!="boolean")throw new j(s,`Value ${i} is not a boolean`)});t.toString=se(t,i=>i.toString()),t.toNumber=oe(t,i=>i?1:0),t.toBoolean=ae(t,i=>i),t.toCustom=te(t),t.toArray=Ee(t);let r=i=>(s,o)=>(e.push(ve(i,s,"boolean",o)),t);return t.assert=r(!1),t.true=()=>(e.push(ai(!1)()),yt(!0,t)),t.false=()=>(e.push(li(!1)()),yt(!1,t)),t.not={assert:r(!0),true:()=>(e.push(ai(!0)()),yt(!1,t)),false:()=>(e.push(li(!0)()),yt(!0,t))},t}function ci(n=[]){let t=ie([],n,(r,i="")=>{if(typeof r!="boolean")throw new j(i,`Value ${r} is not a boolean`);if(r!==!1)throw new j(i,`Value ${r} must be false`)});return t.toString=se(t,r=>r.toString()),t.toNumber=oe(t,r=>r?1:0),t.toBoolean=ae(t,r=>r),t.toCustom=te(t),t.toArray=Ee(t),t}function fi(n=[]){let t=ie([],n,(r,i="")=>{if(typeof r!="boolean")throw new j(i,`Value ${r} is not a boolean`);if(r!==!0)throw new j(i,`Value ${r} must be true`)});return t.toString=se(t,r=>r.toString()),t.toNumber=oe(t,r=>r?1:0),t.toBoolean=ae(t,r=>r),t.toCustom=te(t),t.toArray=Ee(t),t}function di(n=[]){let e=[],t=ie(e,n);t.toString=se(t,()=>""),t.toNumber=oe(t,()=>0),t.toBoolean=ae(t,()=>!1),t.toCustom=te(t),t.toArray=Ee(t);let r=i=>(s,o)=>(e.push(ve(i,s,"custom value",o)),t);return t.assert=r(!1),t.not={assert:r(!0)},t}var qe=ze("number"),pi=n=>e=>(t,r="")=>{if(!(n?e.indexOf(t)===-1:e.indexOf(t)!==-1))throw new j(r,`Number value ${t} ${n?`is one of the disallowed values in [${e.join(", ")}]`:`is not one of the allowed values in [${e.join(", ")}]`}`)},hi=n=>()=>(e,t="")=>{qe(t,()=>n?e<0:e>0,e,"positive",n)},mi=n=>()=>(e,t="")=>{qe(t,()=>n?e>0:e<0,e,"negative",n)},gi=n=>()=>(e,t="")=>{qe(t,()=>n?e!==0:e===0,e,"zero",n)},yi=n=>e=>(t,r="")=>{qe(r,()=>n?t>=e:t<e,t,`less than ${e}`,n)},bi=n=>e=>(t,r="")=>{qe(r,()=>n?t<=e:t>e,t,`more than ${e}`,n)},wi=n=>e=>(t,r="")=>{qe(r,()=>n?t!==e:t===e,t,`equal to ${e}`,n)},vi=n=>e=>(t,r="")=>{qe(r,()=>n?t%e!==0:t%e===0,t,`a multiple of ${e}`,n)},xi=n=>()=>(e,t="")=>{qe(t,()=>n?!Number.isInteger(e):Number.isInteger(e),e,"an integer",n)};function Ut(n=[]){let e=[],t=ie(e,n,(i,s="")=>{if(typeof i!="number")throw new j(s,`Value ${i} is not a number`)});t.toString=se(t,i=>i.toString()),t.toNumber=oe(t,i=>i),t.toBoolean=ae(t,i=>i!==0),t.toCustom=te(t),t.toArray=Ee(t);let r=i=>(s,o)=>(e.push(ve(i,s,"number",o)),t);return t.assert=r(!1),t.allowed=(...i)=>(e.push(pi(!1)(i)),t),t.integer=()=>(e.push(xi(!1)()),t),t.positive=()=>(e.push(hi(!1)()),t),t.negative=()=>(e.push(mi(!1)()),t),t.lessThan=i=>(e.push(yi(!1)(i)),t),t.moreThan=i=>(e.push(bi(!1)(i)),t),t.zero=()=>(e.push(gi(!1)()),t),t.multipleOf=i=>(e.push(vi(!1)(i)),t),t.equals=i=>(e.push(wi(!1)(i)),t),t.not={assert:r(!0),allowed:(...i)=>(e.push(pi(!0)(i)),t),integer:()=>(e.push(xi(!0)()),t),positive:()=>(e.push(hi(!0)()),t),negative:()=>(e.push(mi(!0)()),t),lessThan:i=>(e.push(yi(!0)(i)),t),moreThan:i=>(e.push(bi(!0)(i)),t),zero:()=>(e.push(gi(!0)()),t),multipleOf:i=>(e.push(vi(!0)(i)),t),equals:i=>(e.push(wi(!0)(i)),t)},t}function Bt(n=[]){let e=[],t=ie(e,n);t.toCustom=te(t);let r=i=>(s,o)=>(e.push(ve(i,s,"custom value",o)),t);return t.assert=r(!1),t.not={assert:r(!0)},t}function se(n,e){return(t=e)=>Wt([(r,i="")=>{let s=n(r,i);if(s.hasError)throw s.error;try{return t(s.result)}catch(o){throw new j(i,`Unable to create a string from ${typeof s.result} ${s.result}

 ${o instanceof Error?o.message:o}`)}}])}function oe(n,e){return(t=e)=>Ut([(r,i="")=>{let s=n(r,i);if(s.hasError)throw s.error;try{return t(s.result)}catch(o){throw new j(i,`Unable to create a number from ${typeof s.result} ${s.result}

 ${o instanceof Error?o.message:o}`)}}])}function ae(n,e){return(t=e)=>Pt([(r,i="")=>{let s=n(r,i);if(s.hasError)throw s.error;try{return t(s.result)}catch(o){throw new j(i,`Unable to create a booolean from ${typeof s.result} ${s.result}

 ${o instanceof Error?o.message:o}`)}}])}function te(n){return e=>di([(t,r="")=>{let i=n(t,r);if(i.hasError)throw i.error;try{return e(i.result)}catch(s){throw new j(r,`Unable to create custom type from ${typeof i.result} ${i.result}

 ${s instanceof Error?s.message:s}`)}}])}function Ee(n){return e=>gt([(t,r="")=>{let i=n(t,r);if(i.hasError)throw i.error;try{return e(i.result)}catch(s){throw new j(r,`Unable to create an array from ${typeof i.result} ${i.result}

 ${s instanceof Error?s.message:s}`)}}])}function kr(n){return Bt([(e,t="")=>{let r=n(e,t);if(r.hasError)throw r.error;return e}])}function yt(n,e){return(n?fi:ci)([(r,i="")=>{let s=e(r,i);if(s.hasError)throw s.error;return r}])}var Ri=ze("string"),Si=(n,e)=>t=>(r,i="")=>{Ri(i,()=>{let s=e?t:t.toLowerCase(),o=e?r:r.toLowerCase();return n?o!==s:o===s},r,"equal to",n)},Ei=(n,e)=>t=>(r,i="")=>{let s=e?t:t.map(l=>l.toLowerCase()),o=e?r:r.toLowerCase();if(!(n?s.indexOf(o)===-1:s.indexOf(o)!==-1))throw new j(i,`String value ${r} ${n?`is one of the disallowed values in [${t.join(", ")}]`:`is not one of the allowed values in [${t.join(", ")}]`}`)},Ti=n=>()=>(e,t="")=>{Ri(t,()=>n?e.length!==0:e.length===0,e,"empty",n)},ki=n=>e=>(t,r="")=>{if(!(n?!e.test(t):e.test(t)))throw new j(r,`String value '${t}' ${n?"matches":"does not match"} pattern ${e}`)};function Wt(n=[]){let e=[],t={enabled:!0},r=ie(e,n,(s,o="")=>{if(typeof s!="string")throw new j(o,`Value ${s} is not a string`)});r.toString=se(r,s=>s),r.toNumber=oe(r,s=>Number(s)),r.toBoolean=ae(r,s=>!!s),r.toCustom=te(r),r.toArray=Ee(r);let i=s=>(o,a)=>(e.push(ve(s,o,"string",a)),r);return r.assert=i(!1),r.allowed=(...s)=>(e.push(Ei(!1,t.enabled)(s)),kr(r)),r.matches=s=>(e.push(ki(!1)(s)),r),r.empty=()=>(e.push(Ti(!1)()),r),r.equals=s=>(e.push(Si(!1,t.enabled)(s)),kr(r)),r.case=s=>(t.enabled=s==="sensitive",r),r.not={assert:i(!0),allowed:(...s)=>(e.push(Ei(!0,t.enabled)(s)),r),matches:s=>(e.push(ki(!0)(s)),r),empty:()=>(e.push(Ti(!0)()),r),equals:s=>(e.push(Si(!0,t.enabled)(s)),r)},r}function $t(...n){return(e,t="")=>{let r=[];for(let i of n){let s=i(e,t);if(!s.hasError)return s;r.push(s)}return{hasError:!0,initialValue:e,error:r}}}function jt(n=[]){let e=ie([],n,(t,r="")=>{if(t!==void 0)throw new j(r,`Value ${t} is not undefined`)});return e.toString=se(e,()=>String(void 0)),e.toNumber=oe(e,()=>NaN),e.toBoolean=ae(e,()=>!1),e.toCustom=te(e),e.toArray=Ee(e),e}function Vt(...n){return $t(jt(),...n)}function zt(n=[]){let e=[],t=ie(e,n,(i,s="")=>{if(i===null||typeof i!="object"||Array.isArray(i))throw new j(s,`Value ${i} is not an object`)});t.toString=se(t,i=>String(i)),t.toNumber=oe(t,i=>Number(i)),t.toBoolean=ae(t,i=>!!i),t.toCustom=te(t);let r=i=>(s,o)=>(e.push(ve(i,s,"object",o)),t);return t.assert=r(!1),t.not={assert:r(!0)},t.schema=function(i){return zt([(s,o="")=>{let a=t(s,o);if(a.hasError)throw a.error;let l={...s??{},...a.result},u=Object.entries(i).map(([f,d])=>[f,d(l[f],[o,f].filter(Boolean).join("."))]),c=u.filter(([,f])=>f.hasError);if(c.length>0)throw c.reduce((f,[d,h])=>(f[d]=h,f),{});return u.reduce((f,[d,h])=>(h.hasError||(f[d]=h.result),f),l)}])},t.partial=function(i){return zt([(s,o="")=>{let a=t(s,o);if(a.hasError)throw a.error;let l={...s??{},...a.result},u=Object.entries(i).map(([f,d])=>{let h=Vt(d)(l[f],[o,f].filter(Boolean).join("."));return h.hasError&&console.error("ERROR IS HERE",h.error),[f,h]}),c=u.filter(([,f])=>f.hasError);if(c.length>0)throw c.reduce((f,[d,h])=>(f[d]=h,f),{});return u.reduce((f,[d,h])=>(h.hasError||h.result!==void 0&&(f[d]=h.result),f),l)}])},t}function Ci(n=[]){let e=ie([],n,(t,r="")=>{if(t!==null)throw new j(r,`Value ${t} is not null`)});return e.toString=se(e,()=>String(null)),e.toNumber=oe(e,()=>0),e.toBoolean=ae(e,()=>!1),e.toCustom=te(e),e}function Ni(){let n=ie([],[],(e,t="")=>{if(e!==null)throw new j(t,`Value ${e} is not an error`)});return n.toString=se(n,e=>String(e)),n.toNumber=oe(n,()=>0),n.toBoolean=ae(n,()=>!1),n.toCustom=te(n),n}function _i(n){let e=(t,r="")=>{if(!t||typeof t!="object"||Array.isArray(t))return{initialValue:t,hasError:!0,error:new j(r,`Value ${t} is not a record`)};let i=Object.entries(t).map(([s,o],a)=>n(o,[s,`[${a}]`].filter(Boolean).join(".")));return i.some(s=>s.hasError)?{initialValue:t,hasError:!0,error:i.filter(s=>s.hasError)}:{hasError:!1,initialValue:t,result:t}};return e.toString=se(e,t=>String(t)),e.toNumber=oe(e,t=>Number(t)),e.toBoolean=ae(e,t=>!!t),e.toCustom=te(e),e.toArray=Ee(e),e}var y={string:Wt,number:Ut,boolean:Pt,array:gt,object:zt,error:Ni,null:Ci,undefined:jt,oneof:$t,stringUnion:Bt,record:_i,optional:Vt,anything:()=>n=>({initialValue:n,hasError:!1,result:n})};function Ne(n){return e=>!n(e).hasError}function Rr(n){return!!(n&&typeof n=="object"&&!Array.isArray(n))}function be(n){return{success:!1,error:n}}function xe(n){return{success:!0,value:n}}function Te(n){try{let e=n();return Ai(e)?e:xe(e)}catch(e){return be(e)}}async function le(n){try{let e=await n();return Ai(e)?e:xe(e)}catch(e){return be(e)}}async function Cr(n){let e=await n;return Di(e)}function Di(n){if(!n.success)throw n.error;return n.value}function Ai(n){return Rr(n)&&typeof n.success=="boolean"&&(n.success&&"value"in n||!n.success&&"error"in n)}function Oi(n){return y.oneof(y.object().schema({success:y.boolean().true(),value:n??y.anything()}),y.object().schema({success:y.boolean().false(),error:y.anything()}))}var ea=y.object().schema({type:y.string().equals("run-worker"),request_id:y.string(),name:y.string(),binary_location:y.string()});var Mi=Ne(ea),ta=y.object().schema({type:y.string().equals("run-deprecated-worker"),name:y.string(),binary_location:y.oneof(y.string(),y.null()),parameters:y.anything()});var Ii=Ne(ta),ra=y.object().schema({type:y.string().equals("run-service-document-module"),name:y.string(),args:y.oneof(y.object().schema({packing:y.string().equals("binary-pack"),location:y.string()}),y.object().schema({packing:y.string().equals("json"),args:y.array().items(y.anything())}))});var Fi=Ne(ra),na=y.object().schema({response_format:y.string().allowed("opfs_location","string_literal"),response_string:y.string()}),ia=y.object().schema({type:y.string().equals("worker-task-ended"),task_id:y.string(),response:Oi(na)});function bt(n,e){return{type:"worker-task-ended",task_id:n,response:e}}var Pw=Ne(ia);function rt(n){return Te(()=>JSON.parse(n))}function Li(n){return Te(()=>JSON.stringify(n))}var Q=class n extends Error{_error;_type;_state;static SerializedType="JSONableError";constructor(e){super(typeof e=="string"?e:void 0),this._error=typeof e=="string"?this:e,this._type=n.SerializedType}toJSON(){return{__serialized_type:this._type,stack:this._error.stack,message:this._error.message,name:this._error.name,state:this._state}}static create(e){if(e instanceof Error)return new n(e);if(typeof e=="string"||typeof e=="boolean"||typeof e=="number"||typeof e=="symbol"||typeof e=="bigint"||typeof e=="function")return new n(e.toString());if(Pi(e))return oa(e);let t=Li(e);return t.success?new n(t.value):new n("Unserializeable data error")}setState(e){this._state=e}},sa=y.object().schema({__serialized_type:y.string().equals(Q.SerializedType),stack:y.optional(y.string()),message:y.string(),name:y.string(),state:y.anything()}),Pi=Ne(sa);function oa(n){let e=new Error;return e.stack=n.stack,e.name=n.name,e.message=n.message,new Q(e)}var Nr=class n extends Q{static SerializedType="UnexpectedResponseError";constructor(e,t={}){super(`Expected [${e}] response was not valid`),this._type=n.SerializedType,this.setState({expectedType:e,errors:t})}},aa=y.object().schema({__serialized_type:y.string().equals(Nr.SerializedType),stack:y.optional(y.string()),message:y.string(),name:y.string(),state:y.object().schema({expectedType:y.string(),errors:y.record(y.string())})}),Jv=Ne(aa);function We(...n){}var Ui=null,la=(x??[]).map(n=>n.split(".")),He=ni;globalThis.console===He&&(globalThis.console=new Proxy(He,{get:()=>We}));function Oe(n){return Bi(n,la)||Ui&&!Bi(n,Ui)?{log:We,warn:We,error:(e,...t)=>He.error(`[${n}] ${e}`,...t),info:We,debug:We}:{log:(e,...t)=>He.log(`[${n}] ${e}`,...t),warn:(e,...t)=>He.warn(`[${n}] ${e}`,...t),error:(e,...t)=>He.error(`[${n}] ${e}`,...t),info:(e,...t)=>He.info(`[${n}] ${e}`,...t),debug:(e,...t)=>He.debug(`[${n}] ${e}`,...t)}}function Bi(n,e){let t=n.split(".");for(let r of e){let i=0,s=!0;for(;i<t.length;){if(r[i]==="*"){if(r.length-1===i){s=!0;break}i+=1;continue}if(r[i]===t[i]){i+=1;continue}s=!1;break}if(s)return!0}return!1}var Wi=Oe("common.opfs"),_r=class extends Q{static SerializedType="OPFSError";constructor(e){let t=e instanceof Error?e.message:e;super(`Error during OPFS operation: ${t}`),this.setState({originalError:e})}},Ie=class n{static isSupported=()=>typeof navigator.storage?.getDirectory=="function";static async asFailable(e){let t=await le(e);return t.success?t:be(new _r(t.error instanceof Error?t.error:JSON.stringify(t)))}static async _getRootDirectory(){return navigator.storage.getDirectory()}static async _getDirectoryHandle(e){if(!e.endsWith("/")&&e!=="")throw new Error("path should end with / or should be blank for root");e==="/"&&(e="");let t=await n._getRootDirectory(),r=e.split("/"),i=t;for(let s=0;s<r.length-1;s++){let o=await le(()=>i.getDirectoryHandle(r[s],{create:!0}));if(o.success)i=o.value;else throw Wi.error(`error getting directory handle for [${r[s]}]`,o.error),new Error(`error getting directory handle for [${r[s]}]`)}return i}static async _getFileHandle(e,t){let r=e.lastIndexOf("/"),i=await n._getDirectoryHandle(e.substring(0,r+1)),s=e.substring(r+1);return await i.getFileHandle(s,t)}static async _getFile(e){return(await this._getFileHandle(e,{create:!1})).getFile()}static async _getFileWriteStream(e,t){return(await this._getFileHandle(e,{create:t?.create??!1})).createWritable({keepExistingData:t?.keepExistingData??!1})}static async _writeFile(e,t,r={keepExistingData:!1}){let i=await n._getFileWriteStream(e,{keepExistingData:r.keepExistingData,create:!0});await i.write(t),await i.close()}static async getFileWriteStream(e,t){return n.asFailable(()=>n._getFileWriteStream(e,t))}static async writeFile(e,t,r){return n.asFailable(()=>n._writeFile(e,t,r))}static async getFileReadStream(e){return n.asFailable(async()=>(await n._getFile(e)).stream())}static async getFile(e){return n.asFailable(()=>n._getFile(e))}static async readFileHeader(e,t){return n.asFailable(async()=>{let r=(await n._getFile(e)).slice(0,t).stream(),i=new Response(r);return new Uint8Array(await i.arrayBuffer())})}static async readAllFileBytes(e){return n.asFailable(async()=>{let t=(await n._getFile(e)).stream(),r=new Response(t);return new Uint8Array(await r.arrayBuffer())})}static async readAllFileText(e){let t=await n.getFileReadStream(e);return t.success?n.asFailable(async()=>{let r=new TextDecoderStream;t.value.pipeTo(r.writable);let i=r.readable.getReader(),s=!1,o="";for(;!s;){let a=await i.read();a.value&&(o+=a.value),s=a.done}return o}):t}static async destroyFileInDir(e,t){return n.asFailable(async()=>await t.removeEntry(e,{recursive:!0}))}static async destroyFile(e){return n.asFailable(async()=>{let t=e.lastIndexOf("/"),r=await n._getDirectoryHandle(e.substring(0,t+1)),i=e.substring(t+1);return await r.removeEntry(i,{recursive:!0})})}static async _listFiles(e){let t=e.values(),r=[];for await(let i of t){let s=i;s.kind==="directory"?r.push(...await this._listFiles(s)):r.push({dirHandle:e,fileName:s.name})}return r}static async listFiles(e){let t=await le(()=>this._getDirectoryHandle(e));return t.success?this._listFiles(t.value):(Wi.error("error getting handle",t.error),[])}};var Dr=class extends Error{_element;constructor(e,t){super(`Elements of type [${t}] cannot be packed across contexts`),this._element=e}get element(){return this._element}};var nt=class n{_binaries;_packedBuffer;_packHeader;constructor(){this._binaries={},this._packedBuffer=new Uint8Array,this._packHeader={packTime:0,rootPackType:{type:"undefined"},binaryLengths:{}}}get packHeader(){return this._packHeader}get packedBuffer(){return this._packedBuffer}get nextBinIndex(){return Object.keys(this._binaries).length}get combinedBinaryLength(){return Object.values(this._binaries).reduce((e,t)=>e+t.byteLength,0)}static sortObjectAsEntries=e=>Object.entries(e).sort(([t],[r])=>Number(t)-Number(r));static safePack=e=>le(()=>n.pack(e));static pack=async e=>{let t=new n,r=await t.packUnknownElement(e,t),i=n.sortObjectAsEntries(t._binaries),s={packTime:new Date().getTime(),rootPackType:r,binaryLengths:i.reduce((c,[f,d])=>(c[f]=d.byteLength,c),{})},o=new TextEncoder().encode(JSON.stringify(s)),a=new Uint8Array(4+o.byteLength+t.combinedBinaryLength),l=new DataView(new ArrayBuffer(4));l.setInt32(0,o.byteLength),a.set(new Uint8Array(l.buffer),0),a.set(o,4);let u=4+o.length;for(let[,c]of i){let f=new Uint8Array(c);a.set(f,u),u+=f.byteLength}return t._packedBuffer=a,t._packHeader=s,t};packImageData=(e,t)=>({type:"image_data",value:{colorSpace:e.colorSpace,width:e.width,height:e.height,data:this.packUintArray(2,e.data,t)}});packUintArray=(e,t,r)=>{let i=r.nextBinIndex;return r._binaries[i]=t.buffer,{type:"binary",binaryType:e,index:i,byteLength:t.byteLength}};packUnknownElement=async(e,t)=>{let r=n.getPackingConstraints(e);if(r)throw new Dr(e,r);if(e===null)return{type:"null"};if(e===void 0)return{type:"undefined"};if(typeof e=="string")return{type:"string",value:e};if(typeof e=="number")return{type:"number",value:e};if(typeof e=="boolean")return{type:"boolean",value:e};if(e instanceof Date)return{type:"date",value:e.getTime()};if(e instanceof BigInt)return{type:"bigint",radix:16,value:e.toString(36)};if(e instanceof Blob){let s=t.nextBinIndex,o=await e.arrayBuffer();return t._binaries[s]=o,{type:"binary",binaryType:0,index:s,byteLength:o.byteLength,mimeType:e.type}}return e instanceof Uint8Array?this.packUintArray(1,e,t):e instanceof Uint8ClampedArray?this.packUintArray(2,e,t):e instanceof Uint16Array?this.packUintArray(3,e,t):e instanceof Uint32Array?this.packUintArray(4,e,t):e instanceof ImageData?this.packImageData(e,t):Array.isArray(e)?{type:"array",values:Object.fromEntries(await Promise.all(e.map(async(s,o)=>[o,await this.packUnknownElement(s,t)])))}:{type:"object",value:await Promise.all(Object.entries(e).map(async([s,o])=>({key:s,value:await this.packUnknownElement(o,t)}),[]))}};static isBinaryType=e=>e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Blob;static getPackingConstraints=e=>{if(!(!e||Array.isArray(e)||n.isBinaryType(e)||e instanceof ImageData)){if(typeof e=="symbol"||typeof e=="function")return typeof e;if(e instanceof Promise)return"promise";if(typeof e=="object"&&e.constructor.name!=="Object")return e.constructor.name}};static safeUnpack=e=>Te(()=>n.unpack(e));static unpack=e=>{if(e.byteLength<4)throw new Error("Invalid buffer in binary pack");let t=e.slice(0,4),r=4,i=new DataView(t.buffer).getInt32(0),s=e.slice(r,r+i),o=new TextDecoder().decode(s),a=rt(o);if(!a.success)throw new Error("Unable to decode binary pack header");r+=i;let l=new n;l._packHeader=a.value,l._packedBuffer=e;let u=n.sortObjectAsEntries(l._packHeader.binaryLengths);for(let[c,f]of u){let d=e.slice(r,r+f);r+=f,l._binaries[c]=d.buffer}return l.unpackUnknownValue(l._packHeader.rootPackType,l)};unpackUnknownValue=(e,t)=>{if(e.type!=="undefined"){if(e.type==="null")return null;if(e.type==="string"||e.type==="boolean"||e.type==="number")return e.value;if(e.type==="date")return new Date(e.value);if(e.type==="bigint")return BigInt(`0x${e.value}`);if(e.type==="binary")return this.unpackBinary(e,t);if(e.type==="array")return n.sortObjectAsEntries(e.values).map(([,i])=>this.unpackUnknownValue(i,t));if(e.type==="image_data"){let r=this.unpackBinary(e.value.data,t);return new ImageData(r,e.value.width,e.value.height,{colorSpace:e.value.colorSpace})}if(e.type==="object")return e.value.reduce((r,{key:i,value:s})=>(r[i]=this.unpackUnknownValue(s,t),r),{});throw new Error(`Unknown packing type [${e.type}]`)}};unpackBinary(e,t){let r=e.index;if(e.binaryType===0)return new Blob([t._binaries[r]],{type:e.mimeType});if(e.binaryType===1)return new Uint8Array(t._binaries[r]);if(e.binaryType===2)return new Uint8ClampedArray(t._binaries[r]);if(e.binaryType===3)return new Uint16Array(t._binaries[r]);if(e.binaryType===4)return new Uint32Array(t._binaries[r]);throw new Error("Unable to unpack unknown binary")}};async function $i(n){return n instanceof Uint8Array?n:new Uint8Array(await n.arrayBuffer())}var wt=class{_resolver=We;_rejecter=We;_promise;_settled=!1;get[Symbol.toStringTag](){return"[object SynchronizingPromise]"}constructor(){this._promise=new Promise((e,t)=>{this._resolver=r=>{this._settled=!0,e(r)},this._rejecter=r=>{this._settled=!0,t(r)}})}get isSettled(){return this._settled}get reject(){return this._rejecter}get resolve(){return this._resolver}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}};var Ar=class extends Q{static SerializedType="TimeSensitiveMessageExpiryError"};async function qt(n,e=1e3){return await Promise.race([le(typeof n=="function"?n:()=>n),le(()=>new Promise((t,r)=>setTimeout(()=>r(new Ar(`Message expired after ${e}ms`)),e)))])}var ua=y.object().schema({result_type:y.string().allowed("string_literal","serialized_error"),result_value:y.string()});var Ht=Ne(ua);var ca=Oe("c.service_document.deprecated_worker_handler");async function fa(n){return le(async()=>n?n instanceof Blob?$i(n):n instanceof Uint8Array?n:typeof n=="string"?Cr(Ie.readAllFileBytes(n)):new Uint8Array(n):null)}async function ji(n,e,t){let r=await fa(e);return r.success?(ca.warn(`Inbound data for [${n}]`,r.value,t),le(async()=>{let i=new Worker(Se.runtime.getURL(`${n}.worker.js`)),s=await qt(async()=>{await new Promise(a=>{let l=u=>{u.data==="ready"&&(i.removeEventListener("message",l),a(void 0))};i.addEventListener("message",l)});let o=new wt;return i.addEventListener("message",a=>{try{let l=JSON.parse(a.data);if(Ht(l))if(l.result_type==="serialized_error"){let u=rt(l.result_value);u.success?o.reject(Q.create(u.value)):o.reject(Q.create("Failed to deserialize error from worker"))}else o.resolve(l.result_value);else o.resolve(l)}catch{o.resolve(a.data)}}),r.value?i.postMessage({bytes:r.value,parameters:t},[r.value.buffer]):i.postMessage({bytes:null,parameters:t}),o},15e3);return i.terminate(),s})):r}var da=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Or={randomUUID:da};var Gt,pa=new Uint8Array(16);function Mr(){if(!Gt&&(Gt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Gt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Gt(pa)}var me=[];for(let n=0;n<256;++n)me.push((n+256).toString(16).slice(1));function Vi(n,e=0){return(me[n[e+0]]+me[n[e+1]]+me[n[e+2]]+me[n[e+3]]+"-"+me[n[e+4]]+me[n[e+5]]+"-"+me[n[e+6]]+me[n[e+7]]+"-"+me[n[e+8]]+me[n[e+9]]+"-"+me[n[e+10]]+me[n[e+11]]+me[n[e+12]]+me[n[e+13]]+me[n[e+14]]+me[n[e+15]]).toLowerCase()}function ha(){if(Or.randomUUID)return Or.randomUUID();let n=Mr();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Vi(n)}var zi=ha;var it=zi;var ma=y.object().schema({keepalive:y.oneof(y.number(),y.boolean().false()),maxConcurrency:y.oneof(y.string().equals("max"),y.number())}),ga=y.object().schema({ready:y.boolean().true(),poolSettings:ma}),qi=Ne(ga),KC=Oe("offscreen.initialize_worker");var st=Oe("offscreen.handlers.worker_execution"),DN=y.object().schema({legacy:y.boolean().true(),allowed_time:y.number(),worker_name:y.string(),parameters:y.anything()}).partial({binary_location:y.oneof(y.string(),y.null()),binary:y.anything()}),AN=y.object().schema({task_id:y.string(),legacy:y.boolean().false(),allowed_time:y.number(),worker_name:y.string()}).partial({binary_location:y.string(),binary:y.anything()}),Ir=new class{_pools=new Map;_callback;set taskEndedCallback(e){this._callback=e}get maxConcurrency(){return navigator.hardwareConcurrency}handleExecutionRequest=async e=>{let t=this._pools.get(e.worker_name);return t?(await this.queueRequest(e,t),xe(void 0)):this.spawnWorkerPool(e)};createDummyWorker=()=>({id:it(),isInitialized:!1,isWorking:!1});spawnWorkerPool=async e=>{let t=this.createDummyWorker(),r={settings:{keepalive:1e3,maxConcurrency:1},workers:[t],queue:[],requests:new Map},i=await this.spawnWorker(e.worker_name);if(!i.success)return i;let s=r.workers.indexOf(t);return r.workers.splice(s,1,i.value.worker),r.settings=i.value.poolSettings,this._pools.set(e.worker_name,r),await this.queueRequest(e,r),xe(void 0)};spawnWorkerInExistingPool=async(e,t)=>{let r=this.createDummyWorker();t.workers.push(r);let i=await this.spawnWorker(e),s=t.workers.indexOf(r);if(i.success)t.workers.splice(s,1,i.value.worker);else return t.workers.splice(s,1),i;return xe(i.value.worker)};spawnWorker=async e=>{let t=new Worker(Se.runtime.getURL(`${e}.worker.js`));t.isWorking=!1,t.isInitialized=!1,t.id=it();let r=await qt(()=>new Promise(i=>{let s=o=>{qi(o.data)?(st.info("Ready received from worker",t),t.removeEventListener("message",s),t.isInitialized=!0,i(o.data.poolSettings)):st.warn("Received unknown init message",o.data)};t.addEventListener("message",s)}),2e3);return r.success?(t.startWorking=()=>{t._timeout&&clearTimeout(t._timeout),t.isWorking=!0},t.destroy=()=>{let i=this._pools.get(e);i&&(i.workers=i.workers.filter(s=>s!==t)),t.terminate()},t.stopWorking=()=>{let i=typeof r.value.keepalive=="boolean"?0:r.value.keepalive;i?t._timeout=self.setTimeout(()=>t.destroy(),i):t.destroy(),t.isWorking=!1},xe({worker:t,poolSettings:r.value})):(t.terminate(),r)};sendRequestToWorker=(e,t)=>{t.startWorking();let r=async o=>{let a=await le(()=>{if(this._callback)return this._callback(e.task_id,o);st.error("Worker completed, but there was no listener",e.task_id,o)});return a.success||st.warn("Failed to send worker response message to offscreen",a.error,o),a},i=o=>{if(t.removeEventListener("error",s),t.removeEventListener("message",i),Ht(o.data))if(o.data.result_type==="serialized_error"){let a=rt(o.data.result_value);a.success?r(be(Q.create(a.value))):r(be(Q.create("Failed to deserialize error from worker")))}else r(xe(o.data.result_value));else o.data instanceof Uint8Array?r(xe(o.data)):r(be(Q.create("Unknown result received from worker")));self.queueMicrotask(()=>this.pickNextFromQueue(t,e.worker_name))},s=o=>{t.removeEventListener("error",s),t.removeEventListener("message",i),t.destroy(),r(be(o.error))};t.addEventListener("error",s),t.addEventListener("message",i);try{e.binary instanceof Uint8Array?t.postMessage({binary:e.binary,task_id:e.task_id},[e.binary.buffer]):t.postMessage({binary_location:e.binary_location,task_id:e.task_id})}catch(o){st.warn("Exception handling message",o)}};pickNextFromQueue=(e,t)=>{let r=this._pools.get(t);if(!r){st.error(`Missing expected pool [${t}] with worker`,e);return}let i=r.queue.shift();if(!i){e.stopWorking();return}this.sendRequestToWorker(i,e)};queueRequest=async(e,t)=>{let r=t.workers.find(s=>s.isInitialized&&!s.isWorking);if(r)return this.sendRequestToWorker(e,r);let i=t.settings.maxConcurrency==="max"?navigator.hardwareConcurrency:t.settings.maxConcurrency;if(t.workers.length<i){let s=await this.spawnWorkerInExistingPool(e.worker_name,t);if(s.success)return this.sendRequestToWorker(e,s.value)}t.queue.push(e)}};async function Fr(n){let e=`__offscreen_transfer_${it()}`,t=await Ie.writeFile(e,n);return t.success?xe(e):t}var Yt=class{registeredServiceModules=new Map;constructor(){Ir.taskEndedCallback=this.handleTaskEnded,Se.runtime.onMessage.addListener((e,t,r)=>{let i=s=>(s().then(o=>r(o)).catch(o=>r(be(new Q(o)))),!0);if(Fi(e))return i(()=>this.runServiceDocumentModule(e));if(Mi(e))return i(()=>this.runWorkerRequest(e));if(Ii(e))return i(()=>ji(e.name,e.binary_location,e.parameters))})}handleTaskEnded=async(e,t)=>{if(!t.success)return Se.runtime.sendMessage(bt(e,{success:!1,error:t.error}));if(typeof t.value=="string")return Se.runtime.sendMessage(bt(e,{success:!0,value:{response_format:"string_literal",response_string:t.value}}));let r=await Fr(t.value);return r.success?Se.runtime.sendMessage(bt(e,{success:!0,value:{response_format:"opfs_location",response_string:r.value}})):Se.runtime.sendMessage(bt(e,r))};runWorkerRequest=async e=>{let t=await Ie.readAllFileBytes(e.binary_location);return t.success?await Ir.handleExecutionRequest({legacy:!1,task_id:e.request_id,worker_name:e.name,allowed_time:15e3,binary:t.value}):t};runServiceDocumentModule=async e=>{let t=this.registeredServiceModules.get(e.name);if(!t)return be(new Q(`Service module [${e.name}] has not been registered.`));let r=await this.readParametersFromMessage(e.args);if(!r.success)return r;let i=await le(()=>t.handler(...r.value));return!i.success||t.responsePacking==="json"?i:await this.createPackedResponse(i.value)};createPackedResponse=async e=>{let t=await nt.safePack(e);return t.success?Fr(t.value.packedBuffer):t};readParametersFromMessage=async e=>{if(e.packing==="json")return xe(e.args);let t=await Ie.readAllFileBytes(e.location);if(!t.success)return t;let r=nt.safeUnpack(t.value);return r.success?Array.isArray(r.value)?xe(r.value):be(new Q("Unpacked parameters are not an array")):r};registerServiceDocumentModule=(e,t)=>{this.registeredServiceModules.set(e,t)}};var de;(function(n){n[n.Document=0]="Document",n[n.DocumentType=1]="DocumentType",n[n.Element=2]="Element",n[n.Text=3]="Text",n[n.CDATA=4]="CDATA",n[n.Comment=5]="Comment"})(de||(de={}));function ya(n){return n.nodeType===n.ELEMENT_NODE}var Ji=function(){function n(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return n.prototype.getId=function(e){var t;if(!e)return-1;var r=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return r??-1},n.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},n.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},n.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},n.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(i){return t.removeNodeFromMap(i)})},n.prototype.has=function(e){return this.idNodeMap.has(e)},n.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},n.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},n.prototype.replace=function(e,t){var r=this.getNode(e);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(t,i)}this.idNodeMap.set(e,t)},n.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},n}();function Ki(){return new Ji}var X_=new RegExp("[^a-z0-9-_:]");var Hi=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function ba(n,e){e===void 0&&(e={});var t=1,r=1;function i($){var b=$.match(/\n/g);b&&(t+=b.length);var J=$.lastIndexOf(`
`);r=J===-1?r+$.length:$.length-J}function s(){var $={line:t,column:r};return function(b){return b.position=new o($),w(),b}}var o=function(){function $(b){this.start=b,this.end={line:t,column:r},this.source=e.source}return $}();o.prototype.content=n;var a=[];function l($){var b=new Error("".concat(e.source||"",":").concat(t,":").concat(r,": ").concat($));if(b.reason=$,b.filename=e.source,b.line=t,b.column=r,b.source=n,e.silent)a.push(b);else throw b}function u(){var $=d();return{type:"stylesheet",stylesheet:{source:e.source,rules:$,parsingErrors:a}}}function c(){return h(/^{\s*/)}function f(){return h(/^}/)}function d(){var $,b=[];for(w(),v(b);n.length&&n.charAt(0)!=="}"&&($=ne()||De());)$!==!1&&(b.push($),v(b));return b}function h($){var b=$.exec(n);if(b){var J=b[0];return i(J),n=n.slice(J.length),b}}function w(){h(/^\s*/)}function v($){$===void 0&&($=[]);for(var b;b=p();)b!==!1&&$.push(b),b=p();return $}function p(){var $=s();if(!(n.charAt(0)!=="/"||n.charAt(1)!=="*")){for(var b=2;n.charAt(b)!==""&&(n.charAt(b)!=="*"||n.charAt(b+1)!=="/");)++b;if(b+=2,n.charAt(b-1)==="")return l("End of comment missing");var J=n.slice(2,b-2);return r+=2,i(J),n=n.slice(b),r+=2,$({type:"comment",comment:J})}}function m(){var $=h(/^([^{]+)/);if($)return $e($[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(b){return b.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(b){return b.replace(/\u200C/g,",")})}function W(){var $=s(),b=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(b){var J=$e(b[0]);if(!h(/^:\s*/))return l("property missing ':'");var ce=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),Ae=$({type:"declaration",property:J.replace(Hi,""),value:ce?$e(ce[0]).replace(Hi,""):""});return h(/^[;\s]*/),Ae}}function g(){var $=[];if(!c())return l("missing '{'");v($);for(var b;b=W();)b!==!1&&($.push(b),v($)),b=W();return f()?$:l("missing '}'")}function B(){for(var $,b=[],J=s();$=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)b.push($[1]),h(/^,\s*/);if(b.length)return J({type:"keyframe",values:b,declarations:g()})}function V(){var $=s(),b=h(/^@([-\w]+)?keyframes\s*/);if(b){var J=b[1];if(b=h(/^([-\w]+)\s*/),!b)return l("@keyframes missing name");var ce=b[1];if(!c())return l("@keyframes missing '{'");for(var Ae,It=v();Ae=B();)It.push(Ae),It=It.concat(v());return f()?$({type:"keyframes",name:ce,vendor:J,keyframes:It}):l("@keyframes missing '}'")}}function G(){var $=s(),b=h(/^@supports *([^{]+)/);if(b){var J=$e(b[1]);if(!c())return l("@supports missing '{'");var ce=v().concat(d());return f()?$({type:"supports",supports:J,rules:ce}):l("@supports missing '}'")}}function we(){var $=s(),b=h(/^@host\s*/);if(b){if(!c())return l("@host missing '{'");var J=v().concat(d());return f()?$({type:"host",rules:J}):l("@host missing '}'")}}function fe(){var $=s(),b=h(/^@media *([^{]+)/);if(b){var J=$e(b[1]);if(!c())return l("@media missing '{'");var ce=v().concat(d());return f()?$({type:"media",media:J,rules:ce}):l("@media missing '}'")}}function ke(){var $=s(),b=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(b)return $({type:"custom-media",name:$e(b[1]),media:$e(b[2])})}function Re(){var $=s(),b=h(/^@page */);if(b){var J=m()||[];if(!c())return l("@page missing '{'");for(var ce=v(),Ae;Ae=W();)ce.push(Ae),ce=ce.concat(v());return f()?$({type:"page",selectors:J,declarations:ce}):l("@page missing '}'")}}function Be(){var $=s(),b=h(/^@([-\w]+)?document *([^{]+)/);if(b){var J=$e(b[1]),ce=$e(b[2]);if(!c())return l("@document missing '{'");var Ae=v().concat(d());return f()?$({type:"document",document:ce,vendor:J,rules:Ae}):l("@document missing '}'")}}function Y(){var $=s(),b=h(/^@font-face\s*/);if(b){if(!c())return l("@font-face missing '{'");for(var J=v(),ce;ce=W();)J.push(ce),J=J.concat(v());return f()?$({type:"font-face",declarations:J}):l("@font-face missing '}'")}}var Ve=Ce("import"),Je=Ce("charset"),he=Ce("namespace");function Ce($){var b=new RegExp("^@"+$+"\\s*([^;]+);");return function(){var J=s(),ce=h(b);if(ce){var Ae={type:$};return Ae[$]=ce[1].trim(),J(Ae)}}}function ne(){if(n[0]==="@")return V()||fe()||ke()||G()||Ve()||Je()||he()||Be()||Re()||we()||Y()}function De(){var $=s(),b=m();return b?(v(),$({type:"rule",selectors:b,declarations:g()})):l("selector missing")}return Lr(u())}function $e(n){return n?n.replace(/^\s+|\s+$/g,""):""}function Lr(n,e){for(var t=n&&typeof n.type=="string",r=t?n:e,i=0,s=Object.keys(n);i<s.length;i++){var o=s[i],a=n[o];Array.isArray(a)?a.forEach(function(l){Lr(l,r)}):a&&typeof a=="object"&&Lr(a,r)}return t&&Object.defineProperty(n,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),n}var Gi={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function wa(n){var e=Gi[n.tagName]?Gi[n.tagName]:n.tagName;return e==="link"&&n.attributes._cssText&&(e="style"),e}function va(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Xi=/([^\\]):hover/,xa=new RegExp(Xi.source,"g");function Yi(n,e){var t=e?.stylesWithHoverClass.get(n);if(t)return t;var r=ba(n,{silent:!0});if(!r.stylesheet)return n;var i=[];if(r.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(l){Xi.test(l)&&i.push(l)})}),i.length===0)return n;var s=new RegExp(i.filter(function(a,l){return i.indexOf(a)===l}).sort(function(a,l){return l.length-a.length}).map(function(a){return va(a)}).join("|"),"g"),o=n.replace(s,function(a){var l=a.replace(xa,"$1.\\:hover");return"".concat(a,", ").concat(l)});return e?.stylesWithHoverClass.set(n,o),o}function Pr(){var n=new Map;return{stylesWithHoverClass:n}}function Sa(n,e){var t=e.doc,r=e.hackCss,i=e.cache;switch(n.type){case de.Document:return t.implementation.createDocument(null,"",null);case de.DocumentType:return t.implementation.createDocumentType(n.name||"html",n.publicId,n.systemId);case de.Element:{var s=wa(n),o;n.isSVG?o=t.createElementNS("http://www.w3.org/2000/svg",s):o=t.createElement(s);var a={};for(var l in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,l)){var u=n.attributes[l];if(!(s==="option"&&l==="selected"&&u===!1)){if(u===!0&&(u=""),l.startsWith("rr_")){a[l]=u;continue}var c=s==="textarea"&&l==="value",f=s==="style"&&l==="_cssText";if(f&&r&&typeof u=="string"&&(u=Yi(u,i)),(c||f)&&typeof u=="string"){for(var d=t.createTextNode(u),h=0,w=Array.from(o.childNodes);h<w.length;h++){var v=w[h];v.nodeType===o.TEXT_NODE&&o.removeChild(v)}o.appendChild(d);continue}try{if(n.isSVG&&l==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",l,u.toString());else if(l==="onload"||l==="onclick"||l.substring(0,7)==="onmouse")o.setAttribute("_"+l,u.toString());else if(s==="meta"&&n.attributes["http-equiv"]==="Content-Security-Policy"&&l==="content"){o.setAttribute("csp-content",u.toString());continue}else s==="link"&&n.attributes.rel==="preload"&&n.attributes.as==="script"||s==="link"&&n.attributes.rel==="prefetch"&&typeof n.attributes.href=="string"&&n.attributes.href.endsWith(".js")||(s==="img"&&n.attributes.srcset&&n.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",n.attributes.srcset):o.setAttribute(l,u.toString()))}catch{}}}var p=function(W){var g=a[W];if(s==="canvas"&&W==="rr_dataURL"){var B=document.createElement("img");B.onload=function(){var G=o.getContext("2d");G&&G.drawImage(B,0,0,B.width,B.height)},B.src=g.toString(),o.RRNodeType&&(o.rr_dataURL=g.toString())}else if(s==="img"&&W==="rr_dataURL"){var V=o;V.currentSrc.startsWith("data:")||(V.setAttribute("rrweb-original-src",n.attributes.src),V.src=g.toString())}if(W==="rr_width")o.style.width=g.toString();else if(W==="rr_height")o.style.height=g.toString();else if(W==="rr_mediaCurrentTime"&&typeof g=="number")o.currentTime=g;else if(W==="rr_mediaState")switch(g){case"played":o.play().catch(function(G){return console.warn("media playback error",G)});break;case"paused":o.pause();break}};for(var m in a)p(m);if(n.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case de.Text:return t.createTextNode(n.isStyle&&r?Yi(n.textContent,i):n.textContent);case de.CDATA:return t.createCDATASection(n.textContent);case de.Comment:return t.createComment(n.textContent);default:return null}}function ot(n,e){var t=e.doc,r=e.mirror,i=e.skipChild,s=i===void 0?!1:i,o=e.hackCss,a=o===void 0?!0:o,l=e.afterAppend,u=e.cache,c=Sa(n,{doc:t,hackCss:a,cache:u});if(!c)return null;if(n.rootId&&r.getNode(n.rootId)!==t&&r.replace(n.rootId,t),n.type===de.Document&&(t.close(),t.open(),n.compatMode==="BackCompat"&&n.childNodes&&n.childNodes[0].type!==de.DocumentType&&(n.childNodes[0].type===de.Element&&"xmlns"in n.childNodes[0].attributes&&n.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?t.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):t.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),c=t),r.add(c,n),(n.type===de.Document||n.type===de.Element)&&!s)for(var f=0,d=n.childNodes;f<d.length;f++){var h=d[f],w=ot(h,{doc:t,mirror:r,skipChild:!1,hackCss:a,afterAppend:l,cache:u});if(!w){console.warn("Failed to rebuild",h);continue}h.isShadow&&ya(c)&&c.shadowRoot?c.shadowRoot.appendChild(w):c.appendChild(w),l&&l(w,h.id)}return c}function Ea(n,e){function t(o){e(o)}for(var r=0,i=n.getIds();r<i.length;r++){var s=i[r];n.has(s)&&t(n.getNode(s))}}function Ta(n,e){var t=e.getMeta(n);if(t?.type===de.Element){var r=n;for(var i in t.attributes)if(Object.prototype.hasOwnProperty.call(t.attributes,i)&&i.startsWith("rr_")){var s=t.attributes[i];i==="rr_scrollLeft"&&(r.scrollLeft=s),i==="rr_scrollTop"&&(r.scrollTop=s)}}}function Qi(n,e){var t=e.doc,r=e.onVisit,i=e.hackCss,s=i===void 0?!0:i,o=e.afterAppend,a=e.cache,l=e.mirror,u=l===void 0?new Ji:l,c=ot(n,{doc:t,mirror:u,skipChild:!1,hackCss:s,afterAppend:o,cache:a});return Ea(u,function(f){r&&r(f),Ta(f,u)}),c}var at=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,Zi={map:{},getId(){return console.error(at),-1},getNode(){return console.error(at),null},removeNodeFromMap(){console.error(at)},has(){return console.error(at),!1},reset(){console.error(at)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Zi=new Proxy(Zi,{get(n,e,t){return e==="map"&&console.error(at),Reflect.get(n,e,t)}}));function es(n=window){"NodeList"in n&&!n.NodeList.prototype.forEach&&(n.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in n&&!n.DOMTokenList.prototype.forEach&&(n.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===t)return!0;while(t=t&&t.parentNode);return!1})}function ts(n){let e={},t=(i,s)=>{let o={value:i,parent:s,children:[]};return e[i.node.id]=o,o},r=[];for(let i of n){let{nextId:s,parentId:o}=i;if(s&&s in e){let a=e[s];if(a.parent){let l=a.parent.children.indexOf(a);a.parent.children.splice(l,0,t(i,a.parent))}else{let l=r.indexOf(a);r.splice(l,0,t(i,null))}continue}if(o in e){let a=e[o];a.children.push(t(i,a));continue}r.push(t(i,null))}return r}function Ur(n,e){e(n.value);for(let t=n.children.length-1;t>=0;t--)Ur(n.children[t],e)}function Kt(n,e){return!!(n.nodeName==="IFRAME"&&e.getMeta(n))}function Br(n,e){var t,r;let i=(r=(t=n.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.frameElement;if(!i||i===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};let s=i.getBoundingClientRect(),o=Br(i,e),a=s.height/i.clientHeight;return{x:s.x*o.relativeScale+o.x,y:s.y*o.relativeScale+o.y,relativeScale:a,absoluteScale:o.absoluteScale*a}}function vt(n){return!!n?.shadowRoot}function lt(n,e){let t=n[e[0]];return e.length===1?t:lt(t.cssRules[e[1]].cssRules,e.slice(2))}function Wr(n){let e=[...n],t=e.pop();return{positions:e,index:t}}function rs(n){let e=new Set,t=[];for(let r=n.length;r--;){let i=n[r];e.has(i.id)||(t.push(i),e.add(i.id))}return t}var Jt=class{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return(t=this.styleIDMap.get(e))!==null&&t!==void 0?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return t===void 0?r=this.id++:r=t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};var K=(n=>(n[n.DomContentLoaded=0]="DomContentLoaded",n[n.Load=1]="Load",n[n.FullSnapshot=2]="FullSnapshot",n[n.IncrementalSnapshot=3]="IncrementalSnapshot",n[n.Meta=4]="Meta",n[n.Custom=5]="Custom",n[n.Plugin=6]="Plugin",n))(K||{}),q=(n=>(n[n.Mutation=0]="Mutation",n[n.MouseMove=1]="MouseMove",n[n.MouseInteraction=2]="MouseInteraction",n[n.Scroll=3]="Scroll",n[n.ViewportResize=4]="ViewportResize",n[n.Input=5]="Input",n[n.TouchMove=6]="TouchMove",n[n.MediaInteraction=7]="MediaInteraction",n[n.StyleSheetRule=8]="StyleSheetRule",n[n.CanvasMutation=9]="CanvasMutation",n[n.Font=10]="Font",n[n.Log=11]="Log",n[n.Drag=12]="Drag",n[n.StyleDeclaration=13]="StyleDeclaration",n[n.Selection=14]="Selection",n[n.AdoptedStyleSheet=15]="AdoptedStyleSheet",n))(q||{}),ge=(n=>(n[n.MouseUp=0]="MouseUp",n[n.MouseDown=1]="MouseDown",n[n.Click=2]="Click",n[n.ContextMenu=3]="ContextMenu",n[n.DblClick=4]="DblClick",n[n.Focus=5]="Focus",n[n.Blur=6]="Blur",n[n.TouchStart=7]="TouchStart",n[n.TouchMove_Departed=8]="TouchMove_Departed",n[n.TouchEnd=9]="TouchEnd",n[n.TouchCancel=10]="TouchCancel",n))(ge||{}),ut=(n=>(n[n["2D"]=0]="2D",n[n.WebGL=1]="WebGL",n[n.WebGL2=2]="WebGL2",n))(ut||{}),H=(n=>(n.Start="start",n.Pause="pause",n.Resume="resume",n.Resize="resize",n.Finish="finish",n.FullsnapshotRebuilded="fullsnapshot-rebuilded",n.LoadStylesheetStart="load-stylesheet-start",n.LoadStylesheetEnd="load-stylesheet-end",n.SkipStart="skip-start",n.SkipEnd="skip-end",n.MouseInteraction="mouse-interaction",n.EventCast="event-cast",n.CustomEvent="custom-event",n.Flush="flush",n.StateChange="state-change",n.PlayBack="play-back",n.Destroy="destroy",n))(H||{});function Me(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(f){o(f)}}function l(c){try{u(r.throw(c))}catch(f){o(f)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}var ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",St=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(xt=0;xt<ns.length;xt++)St[ns.charCodeAt(xt)]=xt;var xt;var is=function(n){var e=n.length*.75,t=n.length,r,i=0,s,o,a,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var u=new ArrayBuffer(e),c=new Uint8Array(u);for(r=0;r<t;r+=4)s=St[n.charCodeAt(r)],o=St[n.charCodeAt(r+1)],a=St[n.charCodeAt(r+2)],l=St[n.charCodeAt(r+3)],c[i++]=s<<2|o>>4,c[i++]=(o&15)<<4|a>>2,c[i++]=(a&3)<<6|l&63;return u};var z;(function(n){n[n.Document=0]="Document",n[n.DocumentType=1]="DocumentType",n[n.Element=2]="Element",n[n.Text=3]="Text",n[n.CDATA=4]="CDATA",n[n.Comment=5]="Comment"})(z||(z={}));var ka=function(){function n(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return n.prototype.getId=function(e){var t;if(!e)return-1;var r=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return r??-1},n.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},n.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},n.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},n.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(i){return t.removeNodeFromMap(i)})},n.prototype.has=function(e){return this.idNodeMap.has(e)},n.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},n.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},n.prototype.replace=function(e,t){var r=this.getNode(e);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(t,i)}this.idNodeMap.set(e,t)},n.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},n}();function Ra(){return new ka}function Ca(n){let e={},t=/;(?![^(]*\))/g,r=/:(.+)/,i=/\/\*.*?\*\//g;return n.replace(i,"").split(t).forEach(function(s){if(s){let o=s.split(r);o.length>1&&(e[$r(o[0].trim())]=o[1].trim())}}),e}function ss(n){let e=[];for(let t in n){let r=n[t];if(typeof r!="string")continue;let i=Aa(t);e.push(`${i}: ${r};`)}return e.join(" ")}var Na=/-([a-z])/g,_a=/^--[a-zA-Z0-9-]+$/,$r=n=>_a.test(n)?n:n.replace(Na,(e,t)=>t?t.toUpperCase():""),Da=/\B([A-Z])/g,Aa=n=>n.replace(Da,"-$1").toLowerCase(),_e=class{constructor(...e){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=ue.ELEMENT_NODE,this.TEXT_NODE=ue.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){let e=this.parentNode;if(!e)return null;let t=e.childNodes,r=t.indexOf(this);return t[r+1]||null}contains(e){if(e===this)return!0;for(let t of this.childNodes)if(t.contains(e))return!0;return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};function Oa(n){return class as extends n{constructor(){super(...arguments),this.nodeType=ue.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=z.Document,this.textContent=null}get documentElement(){return this.childNodes.find(t=>t.RRNodeType===z.Element&&t.tagName==="HTML")||null}get body(){var t;return((t=this.documentElement)===null||t===void 0?void 0:t.childNodes.find(r=>r.RRNodeType===z.Element&&r.tagName==="BODY"))||null}get head(){var t;return((t=this.documentElement)===null||t===void 0?void 0:t.childNodes.find(r=>r.RRNodeType===z.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(t){let r=t.RRNodeType;if((r===z.Element||r===z.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===z.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return t.parentElement=null,t.parentNode=this,this.childNodes.push(t),t}insertBefore(t,r){let i=t.RRNodeType;if((i===z.Element||i===z.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===z.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(r===null)return this.appendChild(t);let s=this.childNodes.indexOf(r);if(s==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(s,0,t),t.parentElement=null,t.parentNode=this,t}removeChild(t){let r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(r,1),t.parentElement=null,t.parentNode=null,t}open(){this.childNodes=[]}close(){}write(t){let r;if(t==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":t==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){let i=this.createDocumentType("html",r,"");this.open(),this.appendChild(i)}}createDocument(t,r,i){return new as}createDocumentType(t,r,i){let s=new(ls(_e))(t,r,i);return s.ownerDocument=this,s}createElement(t){let r=new(us(_e))(t);return r.ownerDocument=this,r}createElementNS(t,r){return this.createElement(r)}createTextNode(t){let r=new(cs(_e))(t);return r.ownerDocument=this,r}createComment(t){let r=new(fs(_e))(t);return r.ownerDocument=this,r}createCDATASection(t){let r=new(ds(_e))(t);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function ls(n){return class extends n{constructor(t,r,i){super(),this.nodeType=ue.DOCUMENT_TYPE_NODE,this.RRNodeType=z.DocumentType,this.textContent=null,this.name=t,this.publicId=r,this.systemId=i,this.nodeName=t}toString(){return"RRDocumentType"}}}function us(n){return class extends n{constructor(t){super(),this.nodeType=ue.ELEMENT_NODE,this.RRNodeType=z.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(r=>t+=r.textContent),t}set textContent(t){this.childNodes=[this.ownerDocument.createTextNode(t)]}get classList(){return new jr(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let t=this.attributes.style?Ca(this.attributes.style):{},r=/\B([A-Z])/g;return t.setProperty=(i,s,o)=>{if(r.test(i))return;let a=$r(i);s?t[a]=s:delete t[a],o==="important"&&(t[a]+=" !important"),this.attributes.style=ss(t)},t.removeProperty=i=>{if(r.test(i))return"";let s=$r(i),o=t[s]||"";return delete t[s],this.attributes.style=ss(t),o},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,r){this.attributes[t]=r}setAttributeNS(t,r,i){this.setAttribute(r,i)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return this.childNodes.push(t),t.parentNode=this,t.parentElement=this,t}insertBefore(t,r){if(r===null)return this.appendChild(t);let i=this.childNodes.indexOf(r);if(i==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(i,0,t),t.parentElement=this,t.parentNode=this,t}removeChild(t){let r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(r,1),t.parentElement=null,t.parentNode=null,t}attachShadow(t){let r=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=r,r}dispatchEvent(t){return!0}toString(){let t="";for(let r in this.attributes)t+=`${r}="${this.attributes[r]}" `;return`${this.tagName} ${t}`}}}function Ma(n){return class extends n{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function cs(n){return class extends n{constructor(t){super(),this.nodeType=ue.TEXT_NODE,this.nodeName="#text",this.RRNodeType=z.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function fs(n){return class extends n{constructor(t){super(),this.nodeType=ue.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=z.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function ds(n){return class extends n{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=ue.CDATA_SECTION_NODE,this.RRNodeType=z.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}var jr=class{constructor(e,t){if(this.classes=[],this.add=(...r)=>{for(let i of r){let s=String(i);this.classes.indexOf(s)>=0||this.classes.push(s)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(i=>r.indexOf(i)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){let r=e.trim().split(/\s+/);this.classes.push(...r)}this.onChange=t}},ue;(function(n){n[n.PLACEHOLDER=0]="PLACEHOLDER",n[n.ELEMENT_NODE=1]="ELEMENT_NODE",n[n.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",n[n.TEXT_NODE=3]="TEXT_NODE",n[n.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",n[n.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",n[n.ENTITY_NODE=6]="ENTITY_NODE",n[n.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",n[n.COMMENT_NODE=8]="COMMENT_NODE",n[n.DOCUMENT_NODE=9]="DOCUMENT_NODE",n[n.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",n[n.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(ue||(ue={}));var Vr={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},Ia={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Fe(n,e,t,r){let i=n.childNodes,s=e.childNodes;r=r||e.mirror||e.ownerDocument.mirror,(i.length>0||s.length>0)&&os(Array.from(i),s,n,t,r);let o=null,a=null;switch(e.RRNodeType){case z.Document:{a=e.scrollData;break}case z.Element:{let l=n,u=e;switch(Fa(l,u,r),a=u.scrollData,o=u.inputData,u.tagName){case"AUDIO":case"VIDEO":{let c=n,f=u;f.paused!==void 0&&(f.paused?c.pause():c.play()),f.muted!==void 0&&(c.muted=f.muted),f.volume!==void 0&&(c.volume=f.volume),f.currentTime!==void 0&&(c.currentTime=f.currentTime),f.playbackRate!==void 0&&(c.playbackRate=f.playbackRate);break}case"CANVAS":{let c=e;if(c.rr_dataURL!==null){let f=document.createElement("img");f.onload=()=>{let d=l.getContext("2d");d&&d.drawImage(f,0,0,f.width,f.height)},f.src=c.rr_dataURL}c.canvasMutations.forEach(f=>t.applyCanvas(f.event,f.mutation,n))}break;case"STYLE":{let c=l.sheet;c&&e.rules.forEach(f=>t.applyStyleSheetMutation(f,c))}break}if(u.shadowRoot){l.shadowRoot||l.attachShadow({mode:"open"});let c=l.shadowRoot.childNodes,f=u.shadowRoot.childNodes;(c.length>0||f.length>0)&&os(Array.from(c),f,l.shadowRoot,t,r)}break}case z.Text:case z.Comment:case z.CDATA:n.textContent!==e.data&&(n.textContent=e.data);break}if(a&&t.applyScroll(a,!0),o&&t.applyInput(o),e.nodeName==="IFRAME"){let l=n.contentDocument,u=e;if(l){let c=r.getMeta(u.contentDocument);c&&t.mirror.add(l,Object.assign({},c)),Fe(l,u.contentDocument,t,r)}}}function Fa(n,e,t){let r=n.attributes,i=e.attributes;for(let s in i){let o=i[s],a=t.getMeta(e);if(a&&"isSVG"in a&&a.isSVG&&Vr[s])n.setAttributeNS(Vr[s],s,o);else if(e.tagName==="CANVAS"&&s==="rr_dataURL"){let l=document.createElement("img");l.src=o,l.onload=()=>{let u=n.getContext("2d");u&&u.drawImage(l,0,0,l.width,l.height)}}else n.setAttribute(s,o)}for(let{name:s}of Array.from(r))s in i||n.removeAttribute(s);e.scrollLeft&&(n.scrollLeft=e.scrollLeft),e.scrollTop&&(n.scrollTop=e.scrollTop)}function os(n,e,t,r,i){var s;let o=0,a=n.length-1,l=0,u=e.length-1,c=n[o],f=n[a],d=e[l],h=e[u],w,v;for(;o<=a&&l<=u;){let p=r.mirror.getId(c),m=r.mirror.getId(f),W=i.getId(d),g=i.getId(h);if(c===void 0)c=n[++o];else if(f===void 0)f=n[--a];else if(p!==-1&&p===W)Fe(c,d,r,i),c=n[++o],d=e[++l];else if(m!==-1&&m===g)Fe(f,h,r,i),f=n[--a],h=e[--u];else if(p!==-1&&p===g)t.insertBefore(c,f.nextSibling),Fe(c,h,r,i),c=n[++o],h=e[--u];else if(m!==-1&&m===W)t.insertBefore(f,c),Fe(f,d,r,i),f=n[--a],d=e[++l];else{if(!w){w={};for(let B=o;B<=a;B++){let V=n[B];V&&r.mirror.hasNode(V)&&(w[r.mirror.getId(V)]=B)}}if(v=w[i.getId(d)],v){let B=n[v];t.insertBefore(B,c),Fe(B,d,r,i),n[v]=void 0}else{let B=Xt(d,r.mirror,i);t.nodeName==="#document"&&((s=r.mirror.getMeta(B))===null||s===void 0?void 0:s.type)===z.Element&&t.documentElement&&(t.removeChild(t.documentElement),n[o]=void 0,c=void 0),t.insertBefore(B,c||null),Fe(B,d,r,i)}d=e[++l]}}if(o>a){let p=e[u+1],m=null;for(p&&t.childNodes.forEach(W=>{r.mirror.getId(W)===i.getId(p)&&(m=W)});l<=u;++l){let W=Xt(e[l],r.mirror,i);t.insertBefore(W,m),Fe(W,e[l],r,i)}}else if(l>u)for(;o<=a;o++){let p=n[o];p&&(t.removeChild(p),r.mirror.removeNodeFromMap(p))}}function Xt(n,e,t){let r=t.getId(n),i=t.getMeta(n),s=null;if(r>-1&&(s=e.getNode(r)),s!==null)return s;switch(n.RRNodeType){case z.Document:s=new Document;break;case z.DocumentType:s=document.implementation.createDocumentType(n.name,n.publicId,n.systemId);break;case z.Element:{let o=n.tagName.toLowerCase();o=Ia[o]||o,i&&"isSVG"in i&&i?.isSVG?s=document.createElementNS(Vr.svg,o):s=document.createElement(n.tagName);break}case z.Text:s=document.createTextNode(n.data);break;case z.Comment:s=document.createComment(n.data);break;case z.CDATA:s=document.createCDATASection(n.data);break}return i&&e.add(s,Object.assign({},i)),s}var Ke=class n extends Oa(_e){constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=$a(),this.scrollData=null,e&&(this.mirror=e)}get unserializedId(){return this._unserializedId--}createDocument(e,t,r){return new n}createDocumentType(e,t,r){let i=new La(e,t,r);return i.ownerDocument=this,i}createElement(e){let t=e.toUpperCase(),r;switch(t){case"AUDIO":case"VIDEO":r=new zr(t);break;case"IFRAME":r=new Gr(t,this.mirror);break;case"CANVAS":r=new qr(t);break;case"STYLE":r=new Hr(t);break;default:r=new Xe(t);break}return r.ownerDocument=this,r}createComment(e){let t=new Ua(e);return t.ownerDocument=this,t}createCDATASection(e){let t=new Ba(e);return t.ownerDocument=this,t}createTextNode(e){let t=new Pa(e);return t.ownerDocument=this,t}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}},La=ls(_e),Xe=class extends us(_e){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}},zr=class extends Ma(Xe){},qr=class extends Xe{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}},Hr=class extends Xe{constructor(){super(...arguments),this.rules=[]}},Gr=class extends Xe{constructor(e,t){super(e),this.contentDocument=new Ke,this.contentDocument.mirror=t}},Pa=cs(_e),Ua=fs(_e),Ba=ds(_e);function Wa(n){return n instanceof HTMLFormElement?"FORM":n.tagName.toUpperCase()}function Jr(n,e,t,r){let i;switch(n.nodeType){case ue.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?i=r.contentDocument:(i=e,i.compatMode=n.compatMode);break;case ue.DOCUMENT_TYPE_NODE:{let o=n;i=e.createDocumentType(o.name,o.publicId,o.systemId);break}case ue.ELEMENT_NODE:{let o=n,a=Wa(o);i=e.createElement(a);let l=i;for(let{name:u,value:c}of Array.from(o.attributes))l.attributes[u]=c;o.scrollLeft&&(l.scrollLeft=o.scrollLeft),o.scrollTop&&(l.scrollTop=o.scrollTop);break}case ue.TEXT_NODE:i=e.createTextNode(n.textContent||"");break;case ue.CDATA_SECTION_NODE:i=e.createCDATASection(n.data);break;case ue.COMMENT_NODE:i=e.createComment(n.textContent||"");break;case ue.DOCUMENT_FRAGMENT_NODE:i=r.attachShadow({mode:"open"});break;default:return null}let s=t.getMeta(n);return e instanceof Ke&&(s||(s=Kr(i,e.unserializedId),t.add(n,s)),e.mirror.add(i,Object.assign({},s))),i}function ps(n,e=Ra(),t=new Ke){function r(i,s){let o=Jr(i,t,e,s);if(o!==null)if(s?.nodeName!=="IFRAME"&&i.nodeType!==ue.DOCUMENT_FRAGMENT_NODE&&(s?.appendChild(o),o.parentNode=s,o.parentElement=s),i.nodeName==="IFRAME"){let a=i.contentDocument;a&&r(a,o)}else(i.nodeType===ue.DOCUMENT_NODE||i.nodeType===ue.ELEMENT_NODE||i.nodeType===ue.DOCUMENT_FRAGMENT_NODE)&&(i.nodeType===ue.ELEMENT_NODE&&i.shadowRoot&&r(i.shadowRoot,o),i.childNodes.forEach(a=>r(a,o)))}return r(n,null),t}function $a(){return new Yr}var Yr=class{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;let r=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){let r=this.getNode(e);if(r){let i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(t,i)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function Kr(n,e){switch(n.RRNodeType){case z.Document:return{id:e,type:n.RRNodeType,childNodes:[]};case z.DocumentType:{let t=n;return{id:e,type:n.RRNodeType,name:t.name,publicId:t.publicId,systemId:t.systemId}}case z.Element:return{id:e,type:n.RRNodeType,tagName:n.tagName.toLowerCase(),attributes:{},childNodes:[]};case z.Text:return{id:e,type:n.RRNodeType,textContent:n.textContent||""};case z.Comment:return{id:e,type:n.RRNodeType,textContent:n.textContent||""};case z.CDATA:return{id:e,type:n.RRNodeType,textContent:""}}}var Qr={};Ho(Qr,{default:()=>Xr});function Xr(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}function hs(n=window,e=document){if("scrollBehavior"in e.documentElement.style&&n.__forceSmoothScrollPolyfill__!==!0)return;let t=n.HTMLElement||n.Element,r=468,i={scroll:n.scroll||n.scrollTo,scrollBy:n.scrollBy,elementScroll:t.prototype.scroll||l,scrollIntoView:t.prototype.scrollIntoView},s=n.performance&&n.performance.now?n.performance.now.bind(n.performance):Date.now;function o(m){let W=["MSIE ","Trident/","Edge/"];return new RegExp(W.join("|")).test(m)}let a=o(n.navigator.userAgent)?1:0;function l(m,W){this.scrollLeft=m,this.scrollTop=W}function u(m){return .5*(1-Math.cos(Math.PI*m))}function c(m){if(m===null||typeof m!="object"||m.behavior===void 0||m.behavior==="auto"||m.behavior==="instant")return!0;if(typeof m=="object"&&m.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+m.behavior+" is not a valid value for enumeration ScrollBehavior.")}function f(m,W){if(W==="Y")return m.clientHeight+a<m.scrollHeight;if(W==="X")return m.clientWidth+a<m.scrollWidth}function d(m,W){let g=n.getComputedStyle(m,null)["overflow"+W];return g==="auto"||g==="scroll"}function h(m){let W=f(m,"Y")&&d(m,"Y"),g=f(m,"X")&&d(m,"X");return W||g}function w(m){for(;m!==e.body&&h(m)===!1;)m=m.parentNode||m.host;return m}function v(m){let W=s(),g,B,V,G=(W-m.startTime)/r;G=G>1?1:G,g=u(G),B=m.startX+(m.x-m.startX)*g,V=m.startY+(m.y-m.startY)*g,m.method.call(m.scrollable,B,V),(B!==m.x||V!==m.y)&&n.requestAnimationFrame(v.bind(n,m))}function p(m,W,g){let B,V,G,we,fe=s();m===e.body?(B=n,V=n.scrollX||n.pageXOffset,G=n.scrollY||n.pageYOffset,we=i.scroll):(B=m,V=m.scrollLeft,G=m.scrollTop,we=l),v({scrollable:B,method:we,startTime:fe,startX:V,startY:G,x:W,y:g})}n.scroll=n.scrollTo=function(){if(arguments[0]!==void 0){if(c(arguments[0])===!0){i.scroll.call(n,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:n.scrollX||n.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:n.scrollY||n.pageYOffset);return}p.call(n,e.body,arguments[0].left!==void 0?~~arguments[0].left:n.scrollX||n.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:n.scrollY||n.pageYOffset)}},n.scrollBy=function(){if(arguments[0]!==void 0){if(c(arguments[0])){i.scrollBy.call(n,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}p.call(n,e.body,~~arguments[0].left+(n.scrollX||n.pageXOffset),~~arguments[0].top+(n.scrollY||n.pageYOffset))}},t.prototype.scroll=t.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(c(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}let m=arguments[0].left,W=arguments[0].top;p.call(this,this,typeof m>"u"?this.scrollLeft:~~m,typeof W>"u"?this.scrollTop:~~W)},t.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(c(arguments[0])===!0){i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},t.prototype.scrollIntoView=function(){if(c(arguments[0])===!0){i.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}let m=w(this),W=m.getBoundingClientRect(),g=this.getBoundingClientRect();m!==e.body?(p.call(this,m,m.scrollLeft+g.left-W.left,m.scrollTop+g.top-W.top),n.getComputedStyle(m).position!=="fixed"&&n.scrollBy({left:W.left,top:W.top,behavior:"smooth"})):n.scrollBy({left:g.left,top:g.top,behavior:"smooth"})}}var Qt=class{constructor(e=[],t){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t.speed,this.liveMode=t.liveMode}addAction(e){if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay){this.actions.push(e);return}let t=this.findActionIndex(e);this.actions.splice(t,0,e)}start(){this.timeOffset=0;let e=performance.now(),t=()=>{let r=performance.now();for(this.timeOffset+=(r-e)*this.speed,e=r;this.actions.length;){let i=this.actions[0];if(this.timeOffset>=i.delay)this.actions.shift(),i.doAction();else break}(this.actions.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(t))};this.raf=requestAnimationFrame(t)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}toggleLiveMode(e){this.liveMode=e}isActive(){return this.raf!==null}findActionIndex(e){let t=0,r=this.actions.length-1;for(;t<=r;){let i=Math.floor((t+r)/2);if(this.actions[i].delay<e.delay)t=i+1;else if(this.actions[i].delay>e.delay)r=i-1;else return i+1}return t}};function Zr(n,e){if(n.type===K.IncrementalSnapshot&&n.data.source===q.MouseMove&&n.data.positions&&n.data.positions.length){let t=n.data.positions[0].timeOffset,r=n.timestamp+t;return n.delay=r-e,r-e}return n.delay=n.timestamp-e,n.delay}function ms(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r,i,s=t.call(n),o=[];try{for(;(e===void 0||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(t=s.return)&&t.call(s)}finally{if(i)throw i.error}}return o}var ct;(function(n){n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped"})(ct||(ct={}));var vs={type:"xstate.init"};function en(n){return n===void 0?[]:[].concat(n)}function Qe(n){return{type:"xstate.assign",assignment:n}}function gs(n,e){return typeof(n=typeof n=="string"&&e&&e[n]?e[n]:n)=="string"?{type:n}:typeof n=="function"?{type:n.name,exec:n}:n}function Zt(n){return function(e){return n===e}}function xs(n){return typeof n=="string"?{type:n}:n}function ys(n,e){return{value:n,context:e,actions:[],changed:!1,matches:Zt(n)}}function bs(n,e,t){var r=e,i=!1;return[n.filter(function(s){if(s.type==="xstate.assign"){i=!0;var o=Object.assign({},r);return typeof s.assignment=="function"?o=s.assignment(r,t):Object.keys(s.assignment).forEach(function(a){o[a]=typeof s.assignment[a]=="function"?s.assignment[a](r,t):s.assignment[a]}),r=o,!1}return!0}),r,i]}function tn(n,e){e===void 0&&(e={});var t=ms(bs(en(n.states[n.initial].entry).map(function(o){return gs(o,e.actions)}),n.context,vs),2),r=t[0],i=t[1],s={config:n,_options:e,initialState:{value:n.initial,actions:r,context:i,matches:Zt(n.initial)},transition:function(o,a){var l,u,c=typeof o=="string"?{value:o,context:n.context}:o,f=c.value,d=c.context,h=xs(a),w=n.states[f];if(w.on){var v=en(w.on[h.type]);try{for(var p=function(ne){var De=typeof Symbol=="function"&&Symbol.iterator,$=De&&ne[De],b=0;if($)return $.call(ne);if(ne&&typeof ne.length=="number")return{next:function(){return ne&&b>=ne.length&&(ne=void 0),{value:ne&&ne[b++],done:!ne}}};throw new TypeError(De?"Object is not iterable.":"Symbol.iterator is not defined.")}(v),m=p.next();!m.done;m=p.next()){var W=m.value;if(W===void 0)return ys(f,d);var g=typeof W=="string"?{target:W}:W,B=g.target,V=g.actions,G=V===void 0?[]:V,we=g.cond,fe=we===void 0?function(){return!0}:we,ke=B===void 0,Re=B??f,Be=n.states[Re];if(fe(d,h)){var Y=ms(bs((ke?en(G):[].concat(w.exit,G,Be.entry).filter(function(ne){return ne})).map(function(ne){return gs(ne,s._options.actions)}),d,h),3),Ve=Y[0],Je=Y[1],he=Y[2],Ce=B??f;return{value:Ce,context:Je,actions:Ve,changed:B!==f||Ve.length>0||he,matches:Zt(Ce)}}}}catch(ne){l={error:ne}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}}return ys(f,d)}};return s}var ws=function(n,e){return n.actions.forEach(function(t){var r=t.exec;return r&&r(n.context,e)})};function rn(n){var e=n.initialState,t=ct.NotStarted,r=new Set,i={_machine:n,send:function(s){t===ct.Running&&(e=n.transition(e,s),ws(e,xs(s)),r.forEach(function(o){return o(e)}))},subscribe:function(s){return r.add(s),s(e),{unsubscribe:function(){return r.delete(s)}}},start:function(s){if(s){var o=typeof s=="object"?s:{context:n.config.context,value:s};e={value:o.value,actions:[],context:o.context,matches:Zt(o.value)}}return t=ct.Running,ws(e,vs),i},stop:function(){return t=ct.Stopped,r.clear(),i},get state(){return e},get status(){return t}};return i}function ja(n,e){for(let t=n.length-1;t>=0;t--){let r=n[t];if(r.type===K.Meta&&r.timestamp<=e)return n.slice(t)}return n}function Ss(n,{getCastFn:e,applyEventsSynchronously:t,emitter:r}){let i=tn({id:"player",context:n,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Qe({lastPlayedEvent:(s,o)=>o.type==="CAST_EVENT"?o.payload.event:s.lastPlayedEvent}),recordTimeOffset:Qe((s,o)=>{let a=s.timeOffset;return"payload"in o&&"timeOffset"in o.payload&&(a=o.payload.timeOffset),Object.assign(Object.assign({},s),{timeOffset:a,baselineTime:s.events[0].timestamp+a})}),play(s){var o;let{timer:a,events:l,baselineTime:u,lastPlayedEvent:c}=s;a.clear();for(let w of l)Zr(w,u);let f=ja(l,u),d=c?.timestamp;c?.type===K.IncrementalSnapshot&&c.data.source===q.MouseMove&&(d=c.timestamp+((o=c.data.positions[0])===null||o===void 0?void 0:o.timeOffset)),u<(d||0)&&r.emit(H.PlayBack);let h=new Array;for(let w of f)if(!(d&&d<u&&(w.timestamp<=d||w===c)))if(w.timestamp<u)h.push(w);else{let v=e(w,!1);a.addAction({doAction:()=>{v()},delay:w.delay})}t(h),r.emit(H.Flush),a.start()},pause(s){s.timer.clear()},resetLastPlayedEvent:Qe(s=>Object.assign(Object.assign({},s),{lastPlayedEvent:null})),startLive:Qe({baselineTime:(s,o)=>(s.timer.toggleLiveMode(!0),s.timer.start(),o.type==="TO_LIVE"&&o.payload.baselineTime?o.payload.baselineTime:Date.now())}),addEvent:Qe((s,o)=>{let{baselineTime:a,timer:l,events:u}=s;if(o.type==="ADD_EVENT"){let{event:c}=o.payload;Zr(c,a);let f=u.length-1;if(!u[f]||u[f].timestamp<=c.timestamp)u.push(c);else{let w=-1,v=0;for(;v<=f;){let p=Math.floor((v+f)/2);u[p].timestamp<=c.timestamp?v=p+1:f=p-1}w===-1&&(w=v),u.splice(w,0,c)}let d=c.timestamp<a,h=e(c,d);d?h():l.isActive()&&l.addAction({doAction:()=>{h()},delay:c.delay})}return Object.assign(Object.assign({},s),{events:u})})}});return rn(i)}function Es(n){let e=tn({id:"speed",context:n,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(t,r)=>{"payload"in r&&t.timer.setSpeed(r.payload.speed)},recordSpeed:Qe({normalSpeed:t=>t.timer.speed}),restoreSpeed:t=>{t.timer.setSpeed(t.normalSpeed)}}});return rn(e)}var Ts=n=>[`.${n} { background: currentColor }`,"noscript { display: none !important; }"];var ks=new Map;function nn(n,e){let t=ks.get(n);return t||(t=new Map,ks.set(n,t)),t.has(e)||t.set(e,[]),t.get(e)}function Le(n,e,t){return r=>Me(this,void 0,void 0,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(t&&(t.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){let i=yield Le(n,e,t)(r.args);return yield createImageBitmap.apply(null,i)}else if("index"in r){if(t||e===null)return r;let{rr_type:i,index:s}=r;return nn(e,i)[s]}else if("args"in r){let{rr_type:i,args:s}=r,o=window[i];return new o(...yield Promise.all(s.map(Le(n,e,t))))}else{if("base64"in r)return is(r.base64);if("src"in r){let i=n.get(r.src);if(i)return i;{let s=new Image;return s.src=r.src,n.set(r.src,s),s}}else if("data"in r&&r.rr_type==="Blob"){let i=yield Promise.all(r.data.map(Le(n,e,t)));return new Blob(i,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(Le(n,e,t)));return r})}function Va(n,e){try{return e===ut.WebGL?n.getContext("webgl")||n.getContext("experimental-webgl"):n.getContext("webgl2")}catch{return null}}var za=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function qa(n,e){if(!e?.constructor)return;let{name:t}=e.constructor;if(!za.includes(t))return;let r=nn(n,t);r.includes(e)||r.push(e)}function Rs({mutation:n,target:e,type:t,imageMap:r,errorHandler:i}){return Me(this,void 0,void 0,function*(){try{let s=Va(e,t);if(!s)return;if(n.setter){s[n.property]=n.args[0];return}let o=s[n.property],a=yield Promise.all(n.args.map(Le(r,s))),l=o.apply(s,a);qa(s,l);let u=!1}catch(s){i(n,s)}})}function Cs({event:n,mutation:e,target:t,imageMap:r,errorHandler:i}){return Me(this,void 0,void 0,function*(){try{let s=t.getContext("2d");if(e.setter){s[e.property]=e.args[0];return}let o=s[e.property];if(e.property==="drawImage"&&typeof e.args[0]=="string")r.get(n),o.apply(s,e.args);else{let a=yield Promise.all(e.args.map(Le(r,s)));o.apply(s,a)}}catch(s){i(e,s)}})}function sn({event:n,mutation:e,target:t,imageMap:r,canvasEventMap:i,errorHandler:s}){return Me(this,void 0,void 0,function*(){try{let o=i.get(n)||e,a="commands"in o?o.commands:[o];if([ut.WebGL,ut.WebGL2].includes(e.type)){for(let l=0;l<a.length;l++){let u=a[l];yield Rs({mutation:u,type:e.type,target:t,imageMap:r,errorHandler:s})}return}for(let l=0;l<a.length;l++){let u=a[l];yield Cs({event:n,mutation:u,target:t,imageMap:r,errorHandler:s})}}catch(o){s(e,o)}})}var Ha=10*1e3,Ga=5*1e3,Ya=Xr||Qr,on="[replayer]",an={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Ns(n){return n.type==K.IncrementalSnapshot&&(n.data.source==q.TouchMove||n.data.source==q.MouseInteraction&&n.data.type==ge.TouchStart)}var Et=class{constructor(e,t){if(this.usingVirtualDom=!1,this.virtualDom=new Ke,this.mouseTail=null,this.tailPositions=[],this.emitter=Ya(),this.legacy_missingNodeRetryMap={},this.cache=Pr(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Ki(),this.styleMirror=new Jt,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(let l of[this.mouseTail,this.iframe])l&&(l.setAttribute("width",String(a.width)),l.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(let l of a){switch(l.type){case K.DomContentLoaded:case K.Load:case K.Custom:continue;case K.FullSnapshot:case K.Meta:case K.Plugin:case K.IncrementalSnapshot:break}this.getCastFn(l,!0)()}this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(a,l=!1)=>{let u;switch(a.type){case K.DomContentLoaded:case K.Load:break;case K.Custom:u=()=>{this.emitter.emit(H.CustomEvent,a)};break;case K.Meta:u=()=>this.emitter.emit(H.Resize,{width:a.data.width,height:a.data.height});break;case K.FullSnapshot:u=()=>{var f;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,l),(f=this.iframe.contentWindow)===null||f===void 0||f.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case K.IncrementalSnapshot:u=()=>{if(this.applyIncremental(a,l),!l&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let f of this.service.state.context.events)if(!(f.timestamp<=a.timestamp)&&this.isUserInteraction(f)){f.delay-a.delay>Ha*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=f);break}if(this.nextUserInteractionEvent){let f=this.nextUserInteractionEvent.delay-a.delay,d={speed:Math.min(Math.round(f/Ga),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(H.SkipStart,d)}}};break}return()=>{u&&u();for(let d of this.config.plugins||[])d.handler&&d.handler(a,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});let f=this.service.state.context.events.length-1;if(a===this.service.state.context.events[f]){let d=()=>{f<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(H.Finish))};a.type===K.IncrementalSnapshot&&a.data.source===q.MouseMove&&a.data.positions.length?setTimeout(()=>{d()},Math.max(0,-a.data.positions[0].timeOffset+50)):d()}this.emitter.emit(H.EventCast,a)}},!t?.liveMode&&e.length<2)throw new Error("Replayer need at least 2 events.");let r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:an,useVirtualDom:!0};this.config=Object.assign({},r,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(H.Resize,this.handleResize),this.setupDom();for(let a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(H.Flush,()=>{if(this.usingVirtualDom){let a={mirror:this.mirror,applyCanvas:(l,u,c)=>{sn({event:l,mutation:u,target:c,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,u)=>{l.source===q.StyleSheetRule?this.applyStyleSheetRule(l,u):l.source===q.StyleDeclaration&&this.applyStyleDeclaration(l,u)}};if(this.iframe.contentDocument&&Fe(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let l in this.legacy_missingNodeRetryMap)try{let u=this.legacy_missingNodeRetryMap[l],c=Xt(u.node,this.mirror,this.virtualDom.mirror);Fe(c,u.node,a,this.virtualDom.mirror),u.node=c}catch(u){this.config.showWarning&&console.warn(u)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(H.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});let i=new Qt([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=Ss({events:e.map(a=>t&&t.unpackFn?t.unpackFn(a):a).sort((a,l)=>a.timestamp-l.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(H.StateChange,{player:a})}),this.speedService=Es({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(H.StateChange,{speed:a})});let s=this.service.state.context.events.find(a=>a.type===K.Meta),o=this.service.state.context.events.find(a=>a.type===K.FullSnapshot);if(s){let{width:a,height:l}=s.data;setTimeout(()=>{this.emitter.emit(H.Resize,{width:a,height:l})},0)}o&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),(a=this.iframe.contentWindow)===null||a===void 0||a.scrollTo(o.data.initialOffset))},1),this.service.state.context.events.find(Ns)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}setConfig(e){Object.keys(e).forEach(t=>{e[t],this.config[t]=e[t]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){let e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:t}=this.service.state.context;return e-t[0].timestamp}getMirror(){return this.mirror}play(e=0){var t,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(r=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.getElementsByTagName("html")[0])===null||r===void 0||r.classList.remove("rrweb-paused"),this.emitter.emit(H.Start)}pause(e){var t,r;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(r=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.getElementsByTagName("html")[0])===null||r===void 0||r.classList.add("rrweb-paused"),this.emitter.emit(H.Pause)}resume(e=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(H.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(H.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let t=this.config.unpackFn?this.config.unpackFn(e):e;Ns(t)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:t}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Pr()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(hs(this.iframe.contentWindow,this.iframe.contentDocument),es(this.iframe.contentWindow))}rebuildFullSnapshot(e,t=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let r=[],i=(a,l)=>{this.collectIframeAndAttachDocument(r,a);for(let u of this.config.plugins||[])u.onBuild&&u.onBuild(a,{id:l,replayer:this})};Qi(e.data.node,{doc:this.iframe.contentDocument,afterAppend:i,cache:this.cache,mirror:this.mirror}),i(this.iframe.contentDocument,e.data.node.id);for(let{mutationInQueue:a,builtNode:l}of r)this.attachDocumentToIframe(a,l),this.newDocumentQueue=this.newDocumentQueue.filter(u=>u!==a);let{documentElement:s,head:o}=this.iframe.contentDocument;this.insertStyleRules(s,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(H.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,t){var r;let i=Ts(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&i.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,Kr(s,this.virtualDom.unserializedId)),e.insertBefore(s,t),s.rules.push({source:q.StyleSheetRule,adds:i.map((o,a)=>({rule:o,index:a}))})}else{let s=document.createElement("style");e.insertBefore(s,t);for(let o=0;o<i.length;o++)(r=s.sheet)===null||r===void 0||r.insertRule(i[o],o)}}attachDocumentToIframe(e,t){let r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,i=[],s=(o,a)=>{this.collectIframeAndAttachDocument(i,o);let l=r.getMeta(o);if(l?.type===de.Element&&l?.tagName.toUpperCase()==="HTML"){let{documentElement:u,head:c}=t.contentDocument;this.insertStyleRules(u,c)}for(let u of this.config.plugins||[])u.onBuild&&u.onBuild(o,{id:a,replayer:this})};ot(e.node,{doc:t.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:s,cache:this.cache}),s(t.contentDocument,e.node.id);for(let{mutationInQueue:o,builtNode:a}of i)this.attachDocumentToIframe(o,a),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==o)}collectIframeAndAttachDocument(e,t){if(Kt(t,this.mirror)){let r=this.newDocumentQueue.find(i=>i.parentId===this.mirror.getId(t));r&&e.push({mutationInQueue:r,builtNode:t})}}waitForStylesheetLoad(){var e;let t=(e=this.iframe.contentDocument)===null||e===void 0?void 0:e.head;if(t){let r=new Set,i,s=this.service.state,o=()=>{s=this.service.state};this.emitter.on(H.Start,o),this.emitter.on(H.Pause,o);let a=()=>{this.emitter.off(H.Start,o),this.emitter.off(H.Pause,o)};t.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(r.add(l),l.addEventListener("load",()=>{r.delete(l),r.size===0&&i!==-1&&(s.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(H.LoadStylesheetEnd),i&&clearTimeout(i),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(H.LoadStylesheetStart),i=setTimeout(()=>{s.matches("playing")&&this.play(this.getCurrentTime()),i=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return Me(this,void 0,void 0,function*(){this.service.state;let e=()=>{this.service.state};this.emitter.on(H.Start,e),this.emitter.on(H.Pause,e);let t=[];for(let r of this.service.state.context.events)r.type===K.IncrementalSnapshot&&r.data.source===q.CanvasMutation&&(t.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(s=>{this.preloadImages(s,r)}));return Promise.all(t)})}preloadImages(e,t){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(t)){let r=document.createElement("canvas"),i=r.getContext("2d"),s=i?.createImageData(r.width,r.height);s?.data,JSON.parse(e.args[0]),i?.putImageData(s,0,0)}}deserializeAndPreloadCanvasEvents(e,t){return Me(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(t)){let r={isUnchanged:!0};if("commands"in e){let i=yield Promise.all(e.commands.map(s=>Me(this,void 0,void 0,function*(){let o=yield Promise.all(s.args.map(Le(this.imageMap,null,r)));return Object.assign(Object.assign({},s),{args:o})})));r.isUnchanged===!1&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{commands:i}))}else{let i=yield Promise.all(e.args.map(Le(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{args:i}))}}})}applyIncremental(e,t){var r,i,s;let{data:o}=e;switch(o.source){case q.Mutation:{try{this.applyMutation(o,t)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,o)}break}case q.Drag:case q.TouchMove:case q.MouseMove:if(t){let a=o.positions[o.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:o}}else o.positions.forEach(a=>{let l={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,t,o)},delay:a.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:e.delay-((r=o.positions[0])===null||r===void 0?void 0:r.timeOffset)});break;case q.MouseInteraction:{if(o.id===-1||t)break;let a=new Event(ge[o.type].toLowerCase()),l=this.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);this.emitter.emit(H.MouseInteraction,{type:o.type,target:l});let{triggerFocus:u}=this.config;switch(o.type){case ge.Blur:"blur"in l&&l.blur();break;case ge.Focus:u&&l.focus&&l.focus({preventScroll:!0});break;case ge.Click:case ge.TouchStart:case ge.TouchEnd:t?(o.type===ge.TouchStart?this.touchActive=!0:o.type===ge.TouchEnd&&(this.touchActive=!1),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===ge.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,t,o),o.type===ge.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===ge.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===ge.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case ge.TouchCancel:t?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(a)}break}case q.Scroll:{if(o.id===-1)break;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.scrollData=o;break}this.applyScroll(o,t);break}case q.ViewportResize:this.emitter.emit(H.Resize,{width:o.width,height:o.height});break;case q.Input:{if(o.id===-1)break;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.inputData=o;break}this.applyInput(o);break}case q.MediaInteraction:{let a=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);let l=a;try{o.currentTime&&(l.currentTime=o.currentTime),o.volume&&(l.volume=o.volume),o.muted&&(l.muted=o.muted),o.type===1&&l.pause(),o.type===0&&l.play(),o.type===4&&(l.playbackRate=o.playbackRate)}catch(u){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${u.message||u}`)}break}case q.StyleSheetRule:case q.StyleDeclaration:{this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&((i=this.virtualDom.mirror.getNode(o.id))===null||i===void 0||i.rules.push(o)):this.applyStyleSheetMutation(o);break}case q.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.canvasMutations.push({event:e,mutation:o})}else{let a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);sn({event:e,mutation:o,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case q.Font:{try{let a=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);(s=this.iframe.contentDocument)===null||s===void 0||s.fonts.add(a)}catch(a){this.config.showWarning&&console.warn(a)}break}case q.Selection:{if(t){this.lastSelectionData=o;break}this.applySelection(o);break}case q.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o);break}}}applyMutation(e,t){if(this.config.useVirtualDom&&!this.usingVirtualDom&&t&&(this.usingVirtualDom=!0,ps(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let u in this.legacy_missingNodeRetryMap)try{let c=this.legacy_missingNodeRetryMap[u],f=Jr(c.node,this.virtualDom,this.mirror);f&&(c.node=f)}catch(c){this.config.showWarning&&console.warn(c)}let r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes.forEach(u=>{var c;let f=r.getNode(u.id);if(!f)return e.removes.find(h=>h.id===u.parentId)?void 0:this.warnNodeNotFound(e,u.id);let d=r.getNode(u.parentId);if(!d)return this.warnNodeNotFound(e,u.parentId);if(u.isShadow&&vt(d)&&(d=d.shadowRoot),r.removeNodeFromMap(f),d)try{d.removeChild(f),this.usingVirtualDom&&f.nodeName==="#text"&&d.nodeName==="STYLE"&&((c=d.rules)===null||c===void 0?void 0:c.length)>0&&(d.rules=[])}catch(h){if(h instanceof DOMException)this.warn("parent could not remove child in mutation",d,f,e);else throw h}});let i=Object.assign({},this.legacy_missingNodeRetryMap),s=[],o=u=>{let c=null;return u.nextId&&(c=r.getNode(u.nextId)),u.nextId!==null&&u.nextId!==void 0&&u.nextId!==-1&&!c},a=u=>{var c;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let f=r.getNode(u.parentId);if(!f)return u.node.type===de.Document?this.newDocumentQueue.push(u):s.push(u);u.node.isShadow&&(vt(f)||f.attachShadow({mode:"open"}),f=f.shadowRoot);let d=null,h=null;if(u.previousId&&(d=r.getNode(u.previousId)),u.nextId&&(h=r.getNode(u.nextId)),o(u))return s.push(u);if(u.node.rootId&&!r.getNode(u.node.rootId))return;let w=u.node.rootId?r.getNode(u.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Kt(f,r)){this.attachDocumentToIframe(u,f);return}let v=(W,g)=>{for(let B of this.config.plugins||[])B.onBuild&&B.onBuild(W,{id:g,replayer:this})},p=ot(u.node,{doc:w,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:v});if(u.previousId===-1||u.nextId===-1){i[u.node.id]={node:p,mutation:u};return}let m=r.getMeta(f);if(m&&m.type===de.Element&&m.tagName==="textarea"&&u.node.type===de.Text){let W=Array.isArray(f.childNodes)?f.childNodes:Array.from(f.childNodes);for(let g of W)g.nodeType===f.TEXT_NODE&&f.removeChild(g)}if(d&&d.nextSibling&&d.nextSibling.parentNode)f.insertBefore(p,d.nextSibling);else if(h&&h.parentNode)f.contains(h)?f.insertBefore(p,h):f.insertBefore(p,null);else{if(f===w)for(;w.firstChild;)w.removeChild(w.firstChild);f.appendChild(p)}if(v(p,u.node.id),this.usingVirtualDom&&p.nodeName==="#text"&&f.nodeName==="STYLE"&&((c=f.rules)===null||c===void 0?void 0:c.length)>0&&(f.rules=[]),Kt(p,this.mirror)){let W=this.mirror.getId(p),g=this.newDocumentQueue.find(B=>B.parentId===W);g&&(this.attachDocumentToIframe(g,p),this.newDocumentQueue=this.newDocumentQueue.filter(B=>B!==g))}(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(i,f,p,u)};e.adds.forEach(u=>{a(u)});let l=Date.now();for(;s.length;){let u=ts(s);if(s.length=0,Date.now()-l>500){this.warn("Timeout in the loop, please check the resolve tree data:",u);break}for(let c of u)r.getNode(c.value.parentId)?Ur(c,d=>{a(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",c)}Object.keys(i).length&&Object.assign(this.legacy_missingNodeRetryMap,i),rs(e.texts).forEach(u=>{var c;let f=r.getNode(u.id);if(!f)return e.removes.find(d=>d.id===u.id)?void 0:this.warnNodeNotFound(e,u.id);if(f.textContent=u.value,this.usingVirtualDom){let d=f.parentNode;((c=d?.rules)===null||c===void 0?void 0:c.length)>0&&(d.rules=[])}}),e.attributes.forEach(u=>{let c=r.getNode(u.id);if(!c)return e.removes.find(f=>f.id===u.id)?void 0:this.warnNodeNotFound(e,u.id);for(let f in u.attributes)if(typeof f=="string"){let d=u.attributes[f];if(d===null)c.removeAttribute(f);else if(typeof d=="string")try{if(f==="_cssText"&&(c.nodeName==="LINK"||c.nodeName==="STYLE"))try{let h=r.getMeta(c);Object.assign(h.attributes,u.attributes);let w=ot(h,{doc:c.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),v=c.nextSibling,p=c.parentNode;if(w&&p){p.removeChild(c),p.insertBefore(w,v),r.replace(u.id,w);break}}catch{}c.setAttribute(f,d)}catch(h){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",h)}else if(f==="style"){let h=d,w=c;for(let v in h)if(h[v]===!1)w.style.removeProperty(v);else if(h[v]instanceof Array){let p=h[v];w.style.setProperty(v,p[0],p[1])}else{let p=h[v];w.style.setProperty(v,p)}}}})}applyScroll(e,t){var r,i;let s=this.mirror.getNode(e.id);if(!s)return this.debugNodeNotFound(e,e.id);let o=this.mirror.getMeta(s);if(s===this.iframe.contentDocument)(r=this.iframe.contentWindow)===null||r===void 0||r.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else if(o?.type===de.Document)(i=s.defaultView)===null||i===void 0||i.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else try{s.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"})}catch{}}applyInput(e){let t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch{}}applySelection(e){try{let t=new Set,r=e.ranges.map(({start:i,startOffset:s,end:o,endOffset:a})=>{let l=this.mirror.getNode(i),u=this.mirror.getNode(o);if(!l||!u)return;let c=new Range;c.setStart(l,s),c.setEnd(u,a);let f=l.ownerDocument,d=f?.getSelection();return d&&t.add(d),{range:c,selection:d}});t.forEach(i=>i.removeAllRanges()),r.forEach(i=>{var s;return i&&((s=i.selection)===null||s===void 0?void 0:s.addRange(i.range))})}catch{}}applyStyleSheetMutation(e){var t;let r=null;e.styleId?r=this.styleMirror.getStyle(e.styleId):e.id&&(r=((t=this.mirror.getNode(e.id))===null||t===void 0?void 0:t.sheet)||null),r&&(e.source===q.StyleSheetRule?this.applyStyleSheetRule(e,r):e.source===q.StyleDeclaration&&this.applyStyleDeclaration(e,r))}applyStyleSheetRule(e,t){var r,i,s,o;if((r=e.adds)===null||r===void 0||r.forEach(({rule:a,index:l})=>{try{if(Array.isArray(l)){let{positions:u,index:c}=Wr(l);lt(t.cssRules,u).insertRule(a,c)}else{let u=l===void 0?void 0:Math.min(l,t.cssRules.length);t?.insertRule(a,u)}}catch{}}),(i=e.removes)===null||i===void 0||i.forEach(({index:a})=>{try{if(Array.isArray(a)){let{positions:l,index:u}=Wr(a);lt(t.cssRules,l).deleteRule(u||0)}else t?.deleteRule(a)}catch{}}),e.replace)try{(s=t.replace)===null||s===void 0||s.call(t,e.replace)}catch{}if(e.replaceSync)try{(o=t.replaceSync)===null||o===void 0||o.call(t,e.replaceSync)}catch{}}applyStyleDeclaration(e,t){e.set&&lt(t.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&lt(t.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var t;let r=this.mirror.getNode(e.id);if(!r)return;(t=e.styles)===null||t===void 0||t.forEach(a=>{var l;let u=null,c=null;if(vt(r)?c=((l=r.ownerDocument)===null||l===void 0?void 0:l.defaultView)||null:r.nodeName==="#document"&&(c=r.defaultView),!!c)try{u=new c.CSSStyleSheet,this.styleMirror.add(u,a.styleId),this.applyStyleSheetRule({source:q.StyleSheetRule,adds:a.rules},u)}catch{}});let i=10,s=0,o=(a,l)=>{let u=l.map(c=>this.styleMirror.getStyle(c)).filter(c=>c!==null);vt(a)?a.shadowRoot.adoptedStyleSheets=u:a.nodeName==="#document"&&(a.adoptedStyleSheets=u),u.length!==l.length&&s<i&&(setTimeout(()=>o(a,l),0+100*s),s++)};o(r,e.styleIds)}legacy_resolveMissingNode(e,t,r,i){let{previousId:s,nextId:o}=i,a=s&&e[s],l=o&&e[o];if(a){let{node:u,mutation:c}=a;t.insertBefore(u,r),delete e[c.node.id],delete this.legacy_missingNodeRetryMap[c.node.id],(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(e,t,u,c)}if(l){let{node:u,mutation:c}=l;t.insertBefore(u,r.nextSibling),delete e[c.node.id],delete this.legacy_missingNodeRetryMap[c.node.id],(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(e,t,u,c)}}moveAndHover(e,t,r,i,s){let o=this.mirror.getNode(r);if(!o)return this.debugNodeNotFound(s,r);let a=Br(o,this.iframe),l=e*a.absoluteScale+a.x,u=t*a.absoluteScale+a.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${u}px`,i||this.drawMouseTail({x:l,y:u}),this.hoverElements(o)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:t,lineWidth:r,strokeStyle:i,duration:s}=this.config.mouseTail===!0?an:Object.assign({},an,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;let a=this.mouseTail.getContext("2d");!a||!this.tailPositions.length||(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=r,a.lineCap=t,a.strokeStyle=i,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>a.lineTo(l.x,l.y)),a.stroke())};this.tailPositions.push(e),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==e),o()},s/this.speedService.state.context.timer.speed)}hoverElements(e){var t;(t=this.iframe.contentDocument)===null||t===void 0||t.querySelectorAll(".\\:hover").forEach(i=>{i.classList.remove(":hover")});let r=e;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(e){return e.type!==K.IncrementalSnapshot?!1:e.data.source>q.Mutation&&e.data.source<=q.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(H.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,t){this.warn(`Node with id '${t}' not found. `,e)}warnCanvasMutationFailed(e,t){this.warn("Has error on canvas update",t,"canvas mutation:",e)}debugNodeNotFound(e,t){this.debug(on,`Node with id '${t}' not found. `,e)}warn(...e){this.config.showWarning&&console.warn(on,...e)}debug(...e){this.config.showDebug&&console.log(on,...e)}};var Ja=Object.defineProperty,Ka=(n,e,t)=>e in n?Ja(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_s=(n,e,t)=>Ka(n,typeof e!="symbol"?e+"":e,t),pe=(n=>(n[n.Document=0]="Document",n[n.DocumentType=1]="DocumentType",n[n.Element=2]="Element",n[n.Text=3]="Text",n[n.CDATA=4]="CDATA",n[n.Comment=5]="Comment",n))(pe||{}),Ds={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},As={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},er={};function On(n){if(er[n])return er[n];let e=globalThis[n],t=e.prototype,r=n in Ds?Ds[n]:void 0,i=!!(r&&r.every(a=>{var l,u;return!!((u=(l=Object.getOwnPropertyDescriptor(t,a))==null?void 0:l.get)!=null&&u.toString().includes("[native code]"))})),s=n in As?As[n]:void 0,o=!!(s&&s.every(a=>{var l;return typeof t[a]=="function"&&((l=t[a])==null?void 0:l.toString().includes("[native code]"))}));if(i&&o)return er[n]=e.prototype,e.prototype;try{let a=document.createElement("iframe");document.body.appendChild(a);let l=a.contentWindow;if(!l)return e.prototype;let u=l[n].prototype;return document.body.removeChild(a),u?er[n]=u:t}catch{return t}}var ln={};function Ge(n,e,t){var r;let i=`${n}.${String(t)}`;if(ln[i])return ln[i].call(e);let s=On(n),o=(r=Object.getOwnPropertyDescriptor(s,t))==null?void 0:r.get;return o?(ln[i]=o,o.call(e)):e[t]}var un={};function Qs(n,e,t){let r=`${n}.${String(t)}`;if(un[r])return un[r].bind(e);let s=On(n)[t];return typeof s!="function"?e[t]:(un[r]=s,s.bind(e))}function Xa(n){return Ge("Node",n,"childNodes")}function Qa(n){return Ge("Node",n,"parentNode")}function Za(n){return Ge("Node",n,"parentElement")}function el(n){return Ge("Node",n,"textContent")}function tl(n,e){return Qs("Node",n,"contains")(e)}function rl(n){return Qs("Node",n,"getRootNode")()}function nl(n){return!n||!("host"in n)?null:Ge("ShadowRoot",n,"host")}function il(n){return n.styleSheets}function sl(n){return!n||!("shadowRoot"in n)?null:Ge("Element",n,"shadowRoot")}function ol(n,e){return Ge("Element",n,"querySelector")(e)}function al(n,e){return Ge("Element",n,"querySelectorAll")(e)}function ll(){return On("MutationObserver").constructor}var ye={childNodes:Xa,parentNode:Qa,parentElement:Za,textContent:el,contains:tl,getRootNode:rl,host:nl,styleSheets:il,shadowRoot:sl,querySelector:ol,querySelectorAll:al,mutationObserver:ll};function Zs(n){return n.nodeType===n.ELEMENT_NODE}function ul(n){let e=n&&"host"in n&&"mode"in n&&ye.host(n)||null;return!!(e&&"shadowRoot"in e&&ye.shadowRoot(e)===n)}function cn(n){return Object.prototype.toString.call(n)==="[object ShadowRoot]"}function cl(n){return n.includes(" background-clip: text;")&&!n.includes(" -webkit-background-clip: text;")&&(n=n.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),n}function fl(n){let{cssText:e}=n;if(e.split('"').length<3)return e;let t=["@import",`url(${JSON.stringify(n.href)})`];return n.layerName===""?t.push("layer"):n.layerName&&t.push(`layer(${n.layerName})`),n.supportsText&&t.push(`supports(${n.supportsText})`),n.media.length&&t.push(n.media.mediaText),t.join(" ")+";"}function dr(n){try{let e=n.rules||n.cssRules;if(!e)return null;let t=Array.from(e,r=>dl(r,n.href)).join("");return cl(t)}catch{return null}}function dl(n,e){if(hl(n)){let t;try{t=dr(n.styleSheet)||fl(n)}catch{t=n.cssText}return n.styleSheet.href?pr(t,n.styleSheet.href):t}else{let t=n.cssText;return ml(n)&&n.selectorText.includes(":")&&(t=pl(t)),e?pr(t,e):t}}function pl(n){let e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return n.replace(e,"$1\\$2")}function hl(n){return"styleSheet"in n}function ml(n){return"selectorText"in n}var mn=class{constructor(){_s(this,"idNodeMap",new Map),_s(this,"nodeMetaMap",new WeakMap)}getId(e){var t;return e?((t=this.getMeta(e))==null?void 0:t.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){let r=this.getNode(e);if(r){let i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(t,i)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function gl({element:n,maskInputOptions:e,tagName:t,type:r,value:i,maskInputFn:s}){let o=i||"",a=r&&br(r);return(e[t.toLowerCase()]||a&&e[a])&&(s?o=s(o,n):o="*".repeat(o.length)),o}function br(n){return n.toLowerCase()}var Os="__rrweb_original__";function yl(n){let e=n.getContext("2d");if(!e)return!0;let t=50;for(let r=0;r<n.width;r+=t)for(let i=0;i<n.height;i+=t){let s=e.getImageData,o=Os in s?s[Os]:s;if(new Uint32Array(o.call(e,r,i,Math.min(t,n.width-r),Math.min(t,n.height-i)).data.buffer).some(l=>l!==0))return!1}return!0}function bl(n){let e=n.type;return n.hasAttribute("data-rr-is-password")?"password":e?br(e):null}function eo(n,e){let t;try{t=new URL(n,e??window.location.href)}catch{return null}let r=/\.([0-9a-z]+)(?:$)/i,i=t.pathname.match(r);return i?.[1]??null}function wl(n){let e="";return n.indexOf("//")>-1?e=n.split("/").slice(0,3).join("/"):e=n.split("/")[0],e=e.split("?")[0],e}var vl=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,xl=/^(?:[a-z+]+:)?\/\//i,Sl=/^www\..*/i,El=/^(data:)([^,]*),(.*)/i;function pr(n,e){return(n||"").replace(vl,(t,r,i,s,o,a)=>{let l=i||o||a,u=r||s||"";if(!l)return t;if(xl.test(l)||Sl.test(l))return`url(${u}${l}${u})`;if(El.test(l))return`url(${u}${l}${u})`;if(l[0]==="/")return`url(${u}${wl(e)+l}${u})`;let c=e.split("/"),f=l.split("/");c.pop();for(let d of f)d!=="."&&(d===".."?c.pop():c.push(d));return`url(${u}${c.join("/")}${u})`})}var Tl=1,kl=new RegExp("[^a-z0-9-_:]"),Ms=-2;function Rl(){return Tl++}function Cl(n){if(n instanceof HTMLFormElement)return"form";let e=br(n.tagName);return kl.test(e)?"div":e}var ft,Is,Nl=/^[^ \t\n\r\u000c]+/,_l=/^[, \t\n\r\u000c]+/;function Dl(n,e){if(e.trim()==="")return e;let t=0;function r(s){let o,a=s.exec(e.substring(t));return a?(o=a[0],t+=o.length,o):""}let i=[];for(;r(_l),!(t>=e.length);){let s=r(Nl);if(s.slice(-1)===",")s=dt(n,s.substring(0,s.length-1)),i.push(s);else{let o="";s=dt(n,s);let a=!1;for(;;){let l=e.charAt(t);if(l===""){i.push((s+o).trim());break}else if(a)l===")"&&(a=!1);else if(l===","){t+=1,i.push((s+o).trim());break}else l==="("&&(a=!0);o+=l,t+=1}}}return i.join(", ")}var Fs=new WeakMap;function dt(n,e){return!e||e.trim()===""?e:Mn(n,e)}function Al(n){return!!(n.tagName==="svg"||n.ownerSVGElement)}function Mn(n,e){let t=Fs.get(n);if(t||(t=n.createElement("a"),Fs.set(n,t)),!e)e="";else if(e.startsWith("blob:")||e.startsWith("data:"))return e;return t.setAttribute("href",e),t.href}function Ol(n,e,t,r){return r&&(t==="src"||t==="href"&&!(e==="use"&&r[0]==="#")||t==="xlink:href"&&r[0]!=="#"||t==="background"&&(e==="table"||e==="td"||e==="th")?dt(n,r):t==="srcset"?Dl(n,r):t==="style"?pr(r,Mn(n)):e==="object"&&t==="data"?dt(n,r):r)}function Ml(n,e,t){return(n==="video"||n==="audio")&&e==="autoplay"}function Il(n,e,t){try{if(typeof e=="string"){if(n.classList.contains(e))return!0}else for(let r=n.classList.length;r--;){let i=n.classList[r];if(e.test(i))return!0}if(t)return n.matches(t)}catch{}return!1}function gn(n,e,t){if(!n)return!1;if(n.nodeType!==n.ELEMENT_NODE)return t?gn(ye.parentNode(n),e,t):!1;for(let r=n.classList.length;r--;){let i=n.classList[r];if(e.test(i))return!0}return t?gn(ye.parentNode(n),e,t):!1}function Fl(n,e,t,r){let i;if(Zs(n)){if(i=n,!ye.childNodes(i).length)return!1}else{if(ye.parentElement(n)===null)return!1;i=ye.parentElement(n)}try{if(typeof e=="string"){if(r){if(i.closest(`.${e}`))return!0}else if(i.classList.contains(e))return!0}else if(gn(i,e,r))return!0;if(t){if(r){if(i.closest(t))return!0}else if(i.matches(t))return!0}}catch{}return!1}function Ll(n,e,t){let r=n.contentWindow;if(!r)return;let i=!1,s;try{s=r.document.readyState}catch{return}if(s!=="complete"){let a=setTimeout(()=>{i||(e(),i=!0)},t);n.addEventListener("load",()=>{clearTimeout(a),i=!0,e()});return}let o="about:blank";if(r.location.href!==o||n.src===o||n.src==="")return setTimeout(e,0),n.addEventListener("load",e);n.addEventListener("load",e)}function Pl(n,e,t){let r=!1,i;try{i=n.sheet}catch{return}if(i)return;let s=setTimeout(()=>{r||(e(),r=!0)},t);n.addEventListener("load",()=>{clearTimeout(s),r=!0,e()})}function Ul(n,e){let{doc:t,mirror:r,blockClass:i,blockSelector:s,needsMask:o,inlineStylesheet:a,maskInputOptions:l={},maskTextFn:u,maskInputFn:c,dataURLOptions:f={},inlineImages:d,recordCanvas:h,keepIframeSrcFn:w,newlyAddedElement:v=!1}=e,p=Bl(t,r);switch(n.nodeType){case n.DOCUMENT_NODE:return n.compatMode!=="CSS1Compat"?{type:pe.Document,childNodes:[],compatMode:n.compatMode}:{type:pe.Document,childNodes:[]};case n.DOCUMENT_TYPE_NODE:return{type:pe.DocumentType,name:n.name,publicId:n.publicId,systemId:n.systemId,rootId:p};case n.ELEMENT_NODE:return $l(n,{doc:t,blockClass:i,blockSelector:s,inlineStylesheet:a,maskInputOptions:l,maskInputFn:c,dataURLOptions:f,inlineImages:d,recordCanvas:h,keepIframeSrcFn:w,newlyAddedElement:v,rootId:p});case n.TEXT_NODE:return Wl(n,{doc:t,needsMask:o,maskTextFn:u,rootId:p});case n.CDATA_SECTION_NODE:return{type:pe.CDATA,textContent:"",rootId:p};case n.COMMENT_NODE:return{type:pe.Comment,textContent:ye.textContent(n)||"",rootId:p};default:return!1}}function Bl(n,e){if(!e.hasNode(n))return;let t=e.getId(n);return t===1?void 0:t}function Wl(n,e){var t;let{needsMask:r,maskTextFn:i,rootId:s}=e,o=ye.parentNode(n),a=o&&o.tagName,l=ye.textContent(n),u=a==="STYLE"?!0:void 0,c=a==="SCRIPT"?!0:void 0;if(u&&l){try{n.nextSibling||n.previousSibling||(t=o.sheet)!=null&&t.cssRules&&(l=dr(o.sheet))}catch(f){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${f}`,n)}l=pr(l,Mn(e.doc))}return c&&(l="SCRIPT_PLACEHOLDER"),!u&&!c&&l&&r&&(l=i?i(l,ye.parentElement(n)):l.replace(/[\S]/g,"*")),{type:pe.Text,textContent:l||"",isStyle:u,rootId:s}}function $l(n,e){let{doc:t,blockClass:r,blockSelector:i,inlineStylesheet:s,maskInputOptions:o={},maskInputFn:a,dataURLOptions:l={},inlineImages:u,recordCanvas:c,keepIframeSrcFn:f,newlyAddedElement:d=!1,rootId:h}=e,w=Il(n,r,i),v=Cl(n),p={},m=n.attributes.length;for(let g=0;g<m;g++){let B=n.attributes[g];Ml(v,B.name,B.value)||(p[B.name]=Ol(t,v,br(B.name),B.value))}if(v==="link"&&s){let g=Array.from(t.styleSheets).find(V=>V.href===n.href),B=null;g&&(B=dr(g)),B&&(delete p.rel,delete p.href,p._cssText=B)}if(v==="style"&&n.sheet&&!(n.innerText||ye.textContent(n)||"").trim().length){let g=dr(n.sheet);g&&(p._cssText=g)}if(v==="input"||v==="textarea"||v==="select"){let g=n.value,B=n.checked;p.type!=="radio"&&p.type!=="checkbox"&&p.type!=="submit"&&p.type!=="button"&&g?p.value=gl({element:n,type:bl(n),tagName:v,value:g,maskInputOptions:o,maskInputFn:a}):B&&(p.checked=B)}if(v==="option"&&(n.selected&&!o.select?p.selected=!0:delete p.selected),v==="dialog"&&n.open&&(p.rr_open_mode=n.matches("dialog:modal")?"modal":"non-modal"),v==="canvas"&&c){if(n.__context==="2d")yl(n)||(p.rr_dataURL=n.toDataURL(l.type,l.quality));else if(!("__context"in n)){let g=n.toDataURL(l.type,l.quality),B=t.createElement("canvas");B.width=n.width,B.height=n.height;let V=B.toDataURL(l.type,l.quality);g!==V&&(p.rr_dataURL=g)}}if(v==="img"&&u){ft||(ft=t.createElement("canvas"),Is=ft.getContext("2d"));let g=n,B=g.currentSrc||g.getAttribute("src")||"<unknown-src>",V=g.crossOrigin,G=()=>{g.removeEventListener("load",G);try{ft.width=g.naturalWidth,ft.height=g.naturalHeight,Is.drawImage(g,0,0),p.rr_dataURL=ft.toDataURL(l.type,l.quality)}catch(we){if(g.crossOrigin!=="anonymous"){g.crossOrigin="anonymous",g.complete&&g.naturalWidth!==0?G():g.addEventListener("load",G);return}else console.warn(`Cannot inline img src=${B}! Error: ${we}`)}g.crossOrigin==="anonymous"&&(V?p.crossOrigin=V:g.removeAttribute("crossorigin"))};g.complete&&g.naturalWidth!==0?G():g.addEventListener("load",G)}if(v==="audio"||v==="video"){let g=p;g.rr_mediaState=n.paused?"paused":"played",g.rr_mediaCurrentTime=n.currentTime,g.rr_mediaPlaybackRate=n.playbackRate,g.rr_mediaMuted=n.muted,g.rr_mediaLoop=n.loop,g.rr_mediaVolume=n.volume}if(d||(n.scrollLeft&&(p.rr_scrollLeft=n.scrollLeft),n.scrollTop&&(p.rr_scrollTop=n.scrollTop)),w){let{width:g,height:B}=n.getBoundingClientRect();p={class:p.class,rr_width:`${g}px`,rr_height:`${B}px`}}v==="iframe"&&!f(p.src)&&(n.contentDocument||(p.rr_src=p.src),delete p.src);let W;try{customElements.get(v)&&(W=!0)}catch{}return{type:pe.Element,tagName:v,attributes:p,childNodes:[],isSVG:Al(n)||void 0,needBlock:w,rootId:h,isCustom:W}}function Z(n){return n==null?"":n.toLowerCase()}function jl(n,e){if(e.comment&&n.type===pe.Comment)return!0;if(n.type===pe.Element){if(e.script&&(n.tagName==="script"||n.tagName==="link"&&(n.attributes.rel==="preload"||n.attributes.rel==="modulepreload")&&n.attributes.as==="script"||n.tagName==="link"&&n.attributes.rel==="prefetch"&&typeof n.attributes.href=="string"&&eo(n.attributes.href)==="js"))return!0;if(e.headFavicon&&(n.tagName==="link"&&n.attributes.rel==="shortcut icon"||n.tagName==="meta"&&(Z(n.attributes.name).match(/^msapplication-tile(image|color)$/)||Z(n.attributes.name)==="application-name"||Z(n.attributes.rel)==="icon"||Z(n.attributes.rel)==="apple-touch-icon"||Z(n.attributes.rel)==="shortcut icon")))return!0;if(n.tagName==="meta"){if(e.headMetaDescKeywords&&Z(n.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Z(n.attributes.property).match(/^(og|twitter|fb):/)||Z(n.attributes.name).match(/^(og|twitter):/)||Z(n.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(Z(n.attributes.name)==="robots"||Z(n.attributes.name)==="googlebot"||Z(n.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&n.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(Z(n.attributes.name)==="author"||Z(n.attributes.name)==="generator"||Z(n.attributes.name)==="framework"||Z(n.attributes.name)==="publisher"||Z(n.attributes.name)==="progid"||Z(n.attributes.property).match(/^article:/)||Z(n.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(Z(n.attributes.name)==="google-site-verification"||Z(n.attributes.name)==="yandex-verification"||Z(n.attributes.name)==="csrf-token"||Z(n.attributes.name)==="p:domain_verify"||Z(n.attributes.name)==="verify-v1"||Z(n.attributes.name)==="verification"||Z(n.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Rt(n,e){let{doc:t,mirror:r,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:a,skipChild:l=!1,inlineStylesheet:u=!0,maskInputOptions:c={},maskTextFn:f,maskInputFn:d,slimDOMOptions:h,dataURLOptions:w={},inlineImages:v=!1,recordCanvas:p=!1,onSerialize:m,onIframeLoad:W,iframeLoadTimeout:g=5e3,onStylesheetLoad:B,stylesheetLoadTimeout:V=5e3,keepIframeSrcFn:G=()=>!1,newlyAddedElement:we=!1}=e,{needsMask:fe}=e,{preserveWhiteSpace:ke=!0}=e;fe||(fe=Fl(n,o,a,fe===void 0));let Re=Ul(n,{doc:t,mirror:r,blockClass:i,blockSelector:s,needsMask:fe,inlineStylesheet:u,maskInputOptions:c,maskTextFn:f,maskInputFn:d,dataURLOptions:w,inlineImages:v,recordCanvas:p,keepIframeSrcFn:G,newlyAddedElement:we});if(!Re)return console.warn(n,"not serialized"),null;let Be;r.hasNode(n)?Be=r.getId(n):jl(Re,h)||!ke&&Re.type===pe.Text&&!Re.isStyle&&!Re.textContent.replace(/^\s+|\s+$/gm,"").length?Be=Ms:Be=Rl();let Y=Object.assign(Re,{id:Be});if(r.add(n,Y),Be===Ms)return null;m&&m(n);let Ve=!l;if(Y.type===pe.Element){Ve=Ve&&!Y.needBlock,delete Y.needBlock;let he=ye.shadowRoot(n);he&&cn(he)&&(Y.isShadowHost=!0)}if((Y.type===pe.Document||Y.type===pe.Element)&&Ve){h.headWhitespace&&Y.type===pe.Element&&Y.tagName==="head"&&(ke=!1);let he={doc:t,mirror:r,blockClass:i,blockSelector:s,needsMask:fe,maskTextClass:o,maskTextSelector:a,skipChild:l,inlineStylesheet:u,maskInputOptions:c,maskTextFn:f,maskInputFn:d,slimDOMOptions:h,dataURLOptions:w,inlineImages:v,recordCanvas:p,preserveWhiteSpace:ke,onSerialize:m,onIframeLoad:W,iframeLoadTimeout:g,onStylesheetLoad:B,stylesheetLoadTimeout:V,keepIframeSrcFn:G};if(!(Y.type===pe.Element&&Y.tagName==="textarea"&&Y.attributes.value!==void 0))for(let ne of Array.from(ye.childNodes(n))){let De=Rt(ne,he);De&&Y.childNodes.push(De)}let Ce=null;if(Zs(n)&&(Ce=ye.shadowRoot(n)))for(let ne of Array.from(ye.childNodes(Ce))){let De=Rt(ne,he);De&&(cn(Ce)&&(De.isShadow=!0),Y.childNodes.push(De))}}let Je=ye.parentNode(n);return Je&&ul(Je)&&cn(Je)&&(Y.isShadow=!0),Y.type===pe.Element&&Y.tagName==="iframe"&&Ll(n,()=>{let he=n.contentDocument;if(he&&W){let Ce=Rt(he,{doc:he,mirror:r,blockClass:i,blockSelector:s,needsMask:fe,maskTextClass:o,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:c,maskTextFn:f,maskInputFn:d,slimDOMOptions:h,dataURLOptions:w,inlineImages:v,recordCanvas:p,preserveWhiteSpace:ke,onSerialize:m,onIframeLoad:W,iframeLoadTimeout:g,onStylesheetLoad:B,stylesheetLoadTimeout:V,keepIframeSrcFn:G});Ce&&W(n,Ce)}},g),Y.type===pe.Element&&Y.tagName==="link"&&typeof Y.attributes.rel=="string"&&(Y.attributes.rel==="stylesheet"||Y.attributes.rel==="preload"&&typeof Y.attributes.href=="string"&&eo(Y.attributes.href)==="css")&&Pl(n,()=>{if(B){let he=Rt(n,{doc:t,mirror:r,blockClass:i,blockSelector:s,needsMask:fe,maskTextClass:o,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:c,maskTextFn:f,maskInputFn:d,slimDOMOptions:h,dataURLOptions:w,inlineImages:v,recordCanvas:p,preserveWhiteSpace:ke,onSerialize:m,onIframeLoad:W,iframeLoadTimeout:g,onStylesheetLoad:B,stylesheetLoadTimeout:V,keepIframeSrcFn:G});he&&B(n,he)}},V),Y}function to(n,e){let{mirror:t=new mn,blockClass:r="rr-block",blockSelector:i=null,maskTextClass:s="rr-mask",maskTextSelector:o=null,inlineStylesheet:a=!0,inlineImages:l=!1,recordCanvas:u=!1,maskAllInputs:c=!1,maskTextFn:f,maskInputFn:d,slimDOM:h=!1,dataURLOptions:w,preserveWhiteSpace:v,onSerialize:p,onIframeLoad:m,iframeLoadTimeout:W,onStylesheetLoad:g,stylesheetLoadTimeout:B,keepIframeSrcFn:V=()=>!1}=e||{};return Rt(n,{doc:n,mirror:t,blockClass:r,blockSelector:i,maskTextClass:s,maskTextSelector:o,skipChild:!1,inlineStylesheet:a,maskInputOptions:c===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:c===!1?{password:!0}:c,maskTextFn:f,maskInputFn:d,slimDOMOptions:h===!0||h==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:h==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:h===!1?{}:h,dataURLOptions:w,inlineImages:l,recordCanvas:u,preserveWhiteSpace:v,onSerialize:p,onIframeLoad:m,iframeLoadTimeout:W,onStylesheetLoad:g,stylesheetLoadTimeout:B,keepIframeSrcFn:V,newlyAddedElement:!1})}var Vl=/(max|min)-device-(width|height)/,KL=new RegExp(Vl.source,"g");function zl(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ql(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var In={exports:{}},ee=String,ro=function(){return{isColorSupported:!1,reset:ee,bold:ee,dim:ee,italic:ee,underline:ee,inverse:ee,hidden:ee,strikethrough:ee,black:ee,red:ee,green:ee,yellow:ee,blue:ee,magenta:ee,cyan:ee,white:ee,gray:ee,bgBlack:ee,bgRed:ee,bgGreen:ee,bgYellow:ee,bgBlue:ee,bgMagenta:ee,bgCyan:ee,bgWhite:ee}};In.exports=ro();In.exports.createColors=ro;var Hl=In.exports,Gl={},Yl=Object.freeze(Object.defineProperty({__proto__:null,default:Gl},Symbol.toStringTag,{value:"Module"})),Pe=ql(Yl),Ls=Hl,Ps=Pe,yn=class no extends Error{constructor(e,t,r,i,s,o){super(e),this.name="CssSyntaxError",this.reason=e,s&&(this.file=s),i&&(this.source=i),o&&(this.plugin=o),typeof t<"u"&&typeof r<"u"&&(typeof t=="number"?(this.line=t,this.column=r):(this.line=t.line,this.column=t.column,this.endLine=r.line,this.endColumn=r.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,no)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;e==null&&(e=Ls.isColorSupported),Ps&&e&&(t=Ps(t));let r=t.split(/\r?\n/),i=Math.max(this.line-3,0),s=Math.min(this.line+2,r.length),o=String(s).length,a,l;if(e){let{bold:u,gray:c,red:f}=Ls.createColors(!0);a=d=>u(f(d)),l=d=>c(d)}else a=l=u=>u;return r.slice(i,s).map((u,c)=>{let f=i+1+c,d=" "+(" "+f).slice(-o)+" | ";if(f===this.line){let h=l(d.replace(/\d/g," "))+u.slice(0,this.column-1).replace(/[^\t]/g," ");return a(">")+l(d)+u+`
 `+h+a("^")}return" "+l(d)+u}).join(`
`)}toString(){let e=this.showSourceCode();return e&&(e=`

`+e+`
`),this.name+": "+this.message+e}},Fn=yn;yn.default=yn;var At={};At.isClean=Symbol("isClean");At.my=Symbol("my");var Us={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function Jl(n){return n[0].toUpperCase()+n.slice(1)}var bn=class{constructor(e){this.builder=e}atrule(e,t){let r="@"+e.name,i=e.params?this.rawValue(e,"params"):"";if(typeof e.raws.afterName<"u"?r+=e.raws.afterName:i&&(r+=" "),e.nodes)this.block(e,r+i);else{let s=(e.raws.between||"")+(t?";":"");this.builder(r+i+s,e)}}beforeAfter(e,t){let r;e.type==="decl"?r=this.raw(e,null,"beforeDecl"):e.type==="comment"?r=this.raw(e,null,"beforeComment"):t==="before"?r=this.raw(e,null,"beforeRule"):r=this.raw(e,null,"beforeClose");let i=e.parent,s=0;for(;i&&i.type!=="root";)s+=1,i=i.parent;if(r.includes(`
`)){let o=this.raw(e,null,"indent");if(o.length)for(let a=0;a<s;a++)r+=o}return r}block(e,t){let r=this.raw(e,"between","beforeOpen");this.builder(t+r+"{",e,"start");let i;e.nodes&&e.nodes.length?(this.body(e),i=this.raw(e,"after")):i=this.raw(e,"after","emptyBody"),i&&this.builder(i),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&e.nodes[t].type==="comment";)t-=1;let r=this.raw(e,"semicolon");for(let i=0;i<e.nodes.length;i++){let s=e.nodes[i],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,t!==i||r)}}comment(e){let t=this.raw(e,"left","commentLeft"),r=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+r+"*/",e)}decl(e,t){let r=this.raw(e,"between","colon"),i=e.prop+r+this.rawValue(e,"value");e.important&&(i+=e.raws.important||" !important"),t&&(i+=";"),this.builder(i,e)}document(e){this.body(e)}raw(e,t,r){let i;if(r||(r=t),t&&(i=e.raws[t],typeof i<"u"))return i;let s=e.parent;if(r==="before"&&(!s||s.type==="root"&&s.first===e||s&&s.type==="document"))return"";if(!s)return Us[r];let o=e.root();if(o.rawCache||(o.rawCache={}),typeof o.rawCache[r]<"u")return o.rawCache[r];if(r==="before"||r==="after")return this.beforeAfter(e,r);{let a="raw"+Jl(r);this[a]?i=this[a](o,e):o.walk(l=>{if(i=l.raws[t],typeof i<"u")return!1})}return typeof i>"u"&&(i=Us[r]),o.rawCache[r]=i,i}rawBeforeClose(e){let t;return e.walk(r=>{if(r.nodes&&r.nodes.length>0&&typeof r.raws.after<"u")return t=r.raws.after,t.includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let r;return e.walkComments(i=>{if(typeof i.raws.before<"u")return r=i.raws.before,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),typeof r>"u"?r=this.raw(t,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(e,t){let r;return e.walkDecls(i=>{if(typeof i.raws.before<"u")return r=i.raws.before,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),typeof r>"u"?r=this.raw(t,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeOpen(e){let t;return e.walk(r=>{if(r.type!=="decl"&&(t=r.raws.between,typeof t<"u"))return!1}),t}rawBeforeRule(e){let t;return e.walk(r=>{if(r.nodes&&(r.parent!==e||e.first!==r)&&typeof r.raws.before<"u")return t=r.raws.before,t.includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(r=>{if(typeof r.raws.between<"u")return t=r.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(r=>{if(r.nodes&&r.nodes.length===0&&(t=r.raws.after,typeof t<"u"))return!1}),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk(r=>{let i=r.parent;if(i&&i!==e&&i.parent&&i.parent===e&&typeof r.raws.before<"u"){let s=r.raws.before.split(`
`);return t=s[s.length-1],t=t.replace(/\S/g,""),!1}}),t}rawSemicolon(e){let t;return e.walk(r=>{if(r.nodes&&r.nodes.length&&r.last.type==="decl"&&(t=r.raws.semicolon,typeof t<"u"))return!1}),t}rawValue(e,t){let r=e[t],i=e.raws[t];return i&&i.value===r?i.raw:r}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}},io=bn;bn.default=bn;var Kl=io;function wn(n,e){new Kl(e).stringify(n)}var wr=wn;wn.default=wn;var{isClean:tr,my:Xl}=At,Ql=Fn,Zl=io,eu=wr;function vn(n,e){let t=new n.constructor;for(let r in n){if(!Object.prototype.hasOwnProperty.call(n,r)||r==="proxyCache")continue;let i=n[r],s=typeof i;r==="parent"&&s==="object"?e&&(t[r]=e):r==="source"?t[r]=i:Array.isArray(i)?t[r]=i.map(o=>vn(o,t)):(s==="object"&&i!==null&&(i=vn(i)),t[r]=i)}return t}var xn=class{constructor(e={}){this.raws={},this[tr]=!1,this[Xl]=!0;for(let t in e)if(t==="nodes"){this.nodes=[];for(let r of e[t])typeof r.clone=="function"?this.append(r.clone()):this.append(r)}else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=vn(this);for(let r in e)t[r]=e[r];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:r,start:i}=this.rangeBy(t);return this.source.input.error(e,{column:i.column,line:i.line},{column:r.column,line:r.line},t)}return new Ql(e)}getProxyProcessor(){return{get(e,t){return t==="proxyOf"?e:t==="root"?()=>e.root().toProxy():e[t]},set(e,t,r){return e[t]===r||(e[t]=r,(t==="prop"||t==="value"||t==="name"||t==="params"||t==="important"||t==="text")&&e.markDirty()),!0}}}markDirty(){if(this[tr]){this[tr]=!1;let e=this;for(;e=e.parent;)e[tr]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let r=this.source.start;if(e.index)r=this.positionInside(e.index,t);else if(e.word){t=this.toString();let i=t.indexOf(e.word);i!==-1&&(r=this.positionInside(i,t))}return r}positionInside(e,t){let r=t||this.toString(),i=this.source.start.column,s=this.source.start.line;for(let o=0;o<e;o++)r[o]===`
`?(i=1,s+=1):i+=1;return{column:i,line:s}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},r=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let i=this.toString(),s=i.indexOf(e.word);s!==-1&&(t=this.positionInside(s,i),r=this.positionInside(s+e.word.length,i))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?r={column:e.end.column,line:e.end.line}:typeof e.endIndex=="number"?r=this.positionInside(e.endIndex):e.index&&(r=this.positionInside(e.index+1));return(r.line<t.line||r.line===t.line&&r.column<=t.column)&&(r={column:t.column+1,line:t.line}),{end:r,start:t}}raw(e,t){return new Zl().raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,r=!1;for(let i of e)i===this?r=!0:r?(this.parent.insertAfter(t,i),t=i):this.parent.insertBefore(t,i);r||this.remove()}return this}root(){let e=this;for(;e.parent&&e.parent.type!=="document";)e=e.parent;return e}toJSON(e,t){let r={},i=t==null;t=t||new Map;let s=0;for(let o in this){if(!Object.prototype.hasOwnProperty.call(this,o)||o==="parent"||o==="proxyCache")continue;let a=this[o];if(Array.isArray(a))r[o]=a.map(l=>typeof l=="object"&&l.toJSON?l.toJSON(null,t):l);else if(typeof a=="object"&&a.toJSON)r[o]=a.toJSON(null,t);else if(o==="source"){let l=t.get(a.input);l==null&&(l=s,t.set(a.input,s),s++),r[o]={end:a.end,inputId:l,start:a.start}}else r[o]=a}return i&&(r.inputs=[...t.keys()].map(o=>o.toJSON())),r}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=eu){e.stringify&&(e=e.stringify);let t="";return e(this,r=>{t+=r}),t}warn(e,t,r){let i={node:this};for(let s in r)i[s]=r[s];return e.warn(t,i)}get proxyOf(){return this}},vr=xn;xn.default=xn;var tu=vr,Sn=class extends tu{constructor(e){e&&typeof e.value<"u"&&typeof e.value!="string"&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}},xr=Sn;Sn.default=Sn;var ru="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",nu=(n,e=21)=>(t=e)=>{let r="",i=t;for(;i--;)r+=n[Math.random()*n.length|0];return r},iu=(n=21)=>{let e="",t=n;for(;t--;)e+=ru[Math.random()*64|0];return e},su={nanoid:iu,customAlphabet:nu},{SourceMapConsumer:Bs,SourceMapGenerator:Ws}=Pe,{existsSync:ou,readFileSync:au}=Pe,{dirname:fn,join:lu}=Pe;function uu(n){return Buffer?Buffer.from(n,"base64").toString():window.atob(n)}var En=class{constructor(e,t){if(t.map===!1)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let r=t.map?t.map.prev:void 0,i=this.loadMap(t.from,r);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=fn(this.mapFile)),i&&(this.text=i)}consumer(){return this.consumerCache||(this.consumerCache=new Bs(this.text)),this.consumerCache}decodeInline(e){let t=/^data:application\/json;charset=utf-?8;base64,/,r=/^data:application\/json;base64,/,i=/^data:application\/json;charset=utf-?8,/,s=/^data:application\/json,/;if(i.test(e)||s.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(t.test(e)||r.test(e))return uu(e.substr(RegExp.lastMatch.length));let o=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+o)}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return typeof e!="object"?!1:typeof e.mappings=="string"||typeof e._mappings=="string"||Array.isArray(e.sections)}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let r=e.lastIndexOf(t.pop()),i=e.indexOf("*/",r);r>-1&&i>-1&&(this.annotation=this.getAnnotationURL(e.substring(r,i)))}loadFile(e){if(this.root=fn(e),ou(e))return this.mapFile=e,au(e,"utf-8").toString().trim()}loadMap(e,t){if(t===!1)return!1;if(t){if(typeof t=="string")return t;if(typeof t=="function"){let r=t(e);if(r){let i=this.loadFile(r);if(!i)throw new Error("Unable to load previous source map: "+r.toString());return i}}else{if(t instanceof Bs)return Ws.fromSourceMap(t).toString();if(t instanceof Ws)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let r=this.annotation;return e&&(r=lu(fn(e),r)),this.loadFile(r)}}}startWith(e,t){return e?e.substr(0,t.length)===t:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}},so=En;En.default=En;var{SourceMapConsumer:cu,SourceMapGenerator:fu}=Pe,{fileURLToPath:$s,pathToFileURL:rr}=Pe,{isAbsolute:Tn,resolve:kn}=Pe,{nanoid:du}=su,dn=Pe,js=Fn,pu=so,pn=Symbol("fromOffsetCache"),hu=!!(cu&&fu),Vs=!!(kn&&Tn),hr=class{constructor(e,t={}){if(e===null||typeof e>"u"||typeof e=="object"&&!e.toString)throw new Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),this.css[0]==="\uFEFF"||this.css[0]==="\uFFFE"?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!Vs||/^\w+:\/\//.test(t.from)||Tn(t.from)?this.file=t.from:this.file=kn(t.from)),Vs&&hu){let r=new pu(this.css,t);if(r.text){this.map=r;let i=r.consumer().file;!this.file&&i&&(this.file=this.mapResolve(i))}}this.file||(this.id="<input css "+du(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,r,i={}){let s,o,a;if(t&&typeof t=="object"){let u=t,c=r;if(typeof u.offset=="number"){let f=this.fromOffset(u.offset);t=f.line,r=f.col}else t=u.line,r=u.column;if(typeof c.offset=="number"){let f=this.fromOffset(c.offset);o=f.line,a=f.col}else o=c.line,a=c.column}else if(!r){let u=this.fromOffset(t);t=u.line,r=u.col}let l=this.origin(t,r,o,a);return l?s=new js(e,l.endLine===void 0?l.line:{column:l.column,line:l.line},l.endLine===void 0?l.column:{column:l.endColumn,line:l.endLine},l.source,l.file,i.plugin):s=new js(e,o===void 0?t:{column:r,line:t},o===void 0?r:{column:a,line:o},this.css,this.file,i.plugin),s.input={column:r,endColumn:a,endLine:o,line:t,source:this.css},this.file&&(rr&&(s.input.url=rr(this.file).toString()),s.input.file=this.file),s}fromOffset(e){let t,r;if(this[pn])r=this[pn];else{let s=this.css.split(`
`);r=new Array(s.length);let o=0;for(let a=0,l=s.length;a<l;a++)r[a]=o,o+=s[a].length+1;this[pn]=r}t=r[r.length-1];let i=0;if(e>=t)i=r.length-1;else{let s=r.length-2,o;for(;i<s;)if(o=i+(s-i>>1),e<r[o])s=o-1;else if(e>=r[o+1])i=o+1;else{i=o;break}}return{col:e-r[i]+1,line:i+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:kn(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,r,i){if(!this.map)return!1;let s=this.map.consumer(),o=s.originalPositionFor({column:t,line:e});if(!o.source)return!1;let a;typeof r=="number"&&(a=s.originalPositionFor({column:i,line:r}));let l;Tn(o.source)?l=rr(o.source):l=new URL(o.source,this.map.consumer().sourceRoot||rr(this.map.mapFile));let u={column:o.column,endColumn:a&&a.column,endLine:a&&a.line,line:o.line,url:l.toString()};if(l.protocol==="file:")if($s)u.file=$s(l);else throw new Error("file: protocol is not available in this PostCSS build");let c=s.sourceContentFor(o.source);return c&&(u.source=c),u}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])this[t]!=null&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}},Sr=hr;hr.default=hr;dn&&dn.registerInput&&dn.registerInput(hr);var{SourceMapConsumer:oo,SourceMapGenerator:cr}=Pe,{dirname:fr,relative:ao,resolve:lo,sep:uo}=Pe,{pathToFileURL:zs}=Pe,mu=Sr,gu=!!(oo&&cr),yu=!!(fr&&lo&&ao&&uo),bu=class{constructor(e,t,r,i){this.stringify=e,this.mapOpts=r.map||{},this.root=t,this.opts=r,this.css=i,this.originalCSS=i,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;this.isInline()?e="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?e=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?e=this.mapOpts.annotation(this.opts.to,this.root):e=this.outputFile()+".map";let t=`
`;this.css.includes(`\r
`)&&(t=`\r
`),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t=this.toUrl(this.path(e.file)),r=e.root||fr(e.file),i;this.mapOpts.sourcesContent===!1?(i=new oo(e.text),i.sourcesContent&&(i.sourcesContent=null)):i=e.consumer(),this.map.applySourceMap(i,t,this.toUrl(this.path(r)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],e.type==="comment"&&e.text.indexOf("# sourceMappingURL=")===0&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),yu&&gu&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=cr.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new cr({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new cr({file:this.outputFile(),ignoreInvalidMapping:!0});let e=1,t=1,r="<no source>",i={generated:{column:0,line:0},original:{column:0,line:0},source:""},s,o;this.stringify(this.root,(a,l,u)=>{if(this.css+=a,l&&u!=="end"&&(i.generated.line=e,i.generated.column=t-1,l.source&&l.source.start?(i.source=this.sourcePath(l),i.original.line=l.source.start.line,i.original.column=l.source.start.column-1,this.map.addMapping(i)):(i.source=r,i.original.line=1,i.original.column=0,this.map.addMapping(i))),s=a.match(/\n/g),s?(e+=s.length,o=a.lastIndexOf(`
`),t=a.length-o):t+=a.length,l&&u!=="start"){let c=l.parent||{raws:{}};(!(l.type==="decl"||l.type==="atrule"&&!l.nodes)||l!==c.last||c.raws.semicolon)&&(l.source&&l.source.end?(i.source=this.sourcePath(l),i.original.line=l.source.end.line,i.original.column=l.source.end.column-1,i.generated.line=e,i.generated.column=t-2,this.map.addMapping(i)):(i.source=r,i.original.line=1,i.original.column=0,i.generated.line=e,i.generated.column=t-1,this.map.addMapping(i)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(e=>e.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let e=this.mapOpts.annotation;return typeof e<"u"&&e!==!0?!1:this.previous().length?this.previous().some(t=>t.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(e=>e.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||e.charCodeAt(0)===60||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let r=this.opts.to?fr(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(r=fr(lo(r,this.mapOpts.annotation)));let i=ao(r,e);return this.memoizedPaths.set(e,i),i}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new mu(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let r=t.source.input.from;if(r&&!e[r]){e[r]=!0;let i=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(i,t.source.input.css)}}});else if(this.css){let t=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(t,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(zs){let r=zs(e).toString();return this.memoizedFileURLs.set(e,r),r}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;uo==="\\"&&(e=e.replace(/\\/g,"/"));let r=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,r),r}},co=bu,wu=vr,Rn=class extends wu{constructor(e){super(e),this.type="comment"}},Er=Rn;Rn.default=Rn;var{isClean:fo,my:po}=At,ho=xr,mo=Er,vu=vr,go,Ln,Pn,yo;function bo(n){return n.map(e=>(e.nodes&&(e.nodes=bo(e.nodes)),delete e.source,e))}function wo(n){if(n[fo]=!1,n.proxyOf.nodes)for(let e of n.proxyOf.nodes)wo(e)}var je=class vo extends vu{append(...e){for(let t of e){let r=this.normalize(t,this.last);for(let i of r)this.proxyOf.nodes.push(i)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t=this.getIterator(),r,i;for(;this.indexes[t]<this.proxyOf.nodes.length&&(r=this.indexes[t],i=e(this.proxyOf.nodes[r],r),i!==!1);)this.indexes[t]+=1;return delete this.indexes[t],i}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get(e,t){return t==="proxyOf"?e:e[t]?t==="each"||typeof t=="string"&&t.startsWith("walk")?(...r)=>e[t](...r.map(i=>typeof i=="function"?(s,o)=>i(s.toProxy(),o):i)):t==="every"||t==="some"?r=>e[t]((i,...s)=>r(i.toProxy(),...s)):t==="root"?()=>e.root().toProxy():t==="nodes"?e.nodes.map(r=>r.toProxy()):t==="first"||t==="last"?e[t].toProxy():e[t]:e[t]},set(e,t,r){return e[t]===r||(e[t]=r,(t==="name"||t==="params"||t==="selector")&&e.markDirty()),!0}}}index(e){return typeof e=="number"?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let r=this.index(e),i=this.normalize(t,this.proxyOf.nodes[r]).reverse();r=this.index(e);for(let o of i)this.proxyOf.nodes.splice(r+1,0,o);let s;for(let o in this.indexes)s=this.indexes[o],r<s&&(this.indexes[o]=s+i.length);return this.markDirty(),this}insertBefore(e,t){let r=this.index(e),i=r===0?"prepend":!1,s=this.normalize(t,this.proxyOf.nodes[r],i).reverse();r=this.index(e);for(let a of s)this.proxyOf.nodes.splice(r,0,a);let o;for(let a in this.indexes)o=this.indexes[a],r<=o&&(this.indexes[a]=o+s.length);return this.markDirty(),this}normalize(e,t){if(typeof e=="string")e=bo(go(e).nodes);else if(typeof e>"u")e=[];else if(Array.isArray(e)){e=e.slice(0);for(let i of e)i.parent&&i.parent.removeChild(i,"ignore")}else if(e.type==="root"&&this.type!=="document"){e=e.nodes.slice(0);for(let i of e)i.parent&&i.parent.removeChild(i,"ignore")}else if(e.type)e=[e];else if(e.prop){if(typeof e.value>"u")throw new Error("Value field is missed in node creation");typeof e.value!="string"&&(e.value=String(e.value)),e=[new ho(e)]}else if(e.selector)e=[new Ln(e)];else if(e.name)e=[new Pn(e)];else if(e.text)e=[new mo(e)];else throw new Error("Unknown node type in node creation");return e.map(i=>(i[po]||vo.rebuild(i),i=i.proxyOf,i.parent&&i.parent.removeChild(i),i[fo]&&wo(i),typeof i.raws.before>"u"&&t&&typeof t.raws.before<"u"&&(i.raws.before=t.raws.before.replace(/\S/g,"")),i.parent=this.proxyOf,i))}prepend(...e){e=e.reverse();for(let t of e){let r=this.normalize(t,this.first,"prepend").reverse();for(let i of r)this.proxyOf.nodes.unshift(i);for(let i in this.indexes)this.indexes[i]=this.indexes[i]+r.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);let t;for(let r in this.indexes)t=this.indexes[r],t>=e&&(this.indexes[r]=t-1);return this.markDirty(),this}replaceValues(e,t,r){return r||(r=t,t={}),this.walkDecls(i=>{t.props&&!t.props.includes(i.prop)||t.fast&&!i.value.includes(t.fast)||(i.value=i.value.replace(e,r))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,r)=>{let i;try{i=e(t,r)}catch(s){throw t.addToError(s)}return i!==!1&&t.walk&&(i=t.walk(e)),i})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((r,i)=>{if(r.type==="atrule"&&e.test(r.name))return t(r,i)}):this.walk((r,i)=>{if(r.type==="atrule"&&r.name===e)return t(r,i)}):(t=e,this.walk((r,i)=>{if(r.type==="atrule")return t(r,i)}))}walkComments(e){return this.walk((t,r)=>{if(t.type==="comment")return e(t,r)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((r,i)=>{if(r.type==="decl"&&e.test(r.prop))return t(r,i)}):this.walk((r,i)=>{if(r.type==="decl"&&r.prop===e)return t(r,i)}):(t=e,this.walk((r,i)=>{if(r.type==="decl")return t(r,i)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((r,i)=>{if(r.type==="rule"&&e.test(r.selector))return t(r,i)}):this.walk((r,i)=>{if(r.type==="rule"&&r.selector===e)return t(r,i)}):(t=e,this.walk((r,i)=>{if(r.type==="rule")return t(r,i)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};je.registerParse=n=>{go=n};je.registerRule=n=>{Ln=n};je.registerAtRule=n=>{Pn=n};je.registerRoot=n=>{yo=n};var Ze=je;je.default=je;je.rebuild=n=>{n.type==="atrule"?Object.setPrototypeOf(n,Pn.prototype):n.type==="rule"?Object.setPrototypeOf(n,Ln.prototype):n.type==="decl"?Object.setPrototypeOf(n,ho.prototype):n.type==="comment"?Object.setPrototypeOf(n,mo.prototype):n.type==="root"&&Object.setPrototypeOf(n,yo.prototype),n[po]=!0,n.nodes&&n.nodes.forEach(e=>{je.rebuild(e)})};var xu=Ze,xo,So,Ct=class extends xu{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new xo(new So,this,e).stringify()}};Ct.registerLazyResult=n=>{xo=n};Ct.registerProcessor=n=>{So=n};var Un=Ct;Ct.default=Ct;var Cn=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let r=t.node.rangeBy(t);this.line=r.start.line,this.column=r.start.column,this.endLine=r.end.line,this.endColumn=r.end.column}for(let r in t)this[r]=t[r]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}},Eo=Cn;Cn.default=Cn;var Su=Eo,Nn=class{constructor(e,t,r){this.processor=e,this.messages=[],this.root=t,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let r=new Su(e,t);return this.messages.push(r),r}warnings(){return this.messages.filter(e=>e.type==="warning")}get content(){return this.css}},Bn=Nn;Nn.default=Nn;var hn=39,qs=34,nr=92,Hs=47,ir=10,Tt=32,sr=12,or=9,ar=13,Eu=91,Tu=93,ku=40,Ru=41,Cu=123,Nu=125,_u=59,Du=42,Au=58,Ou=64,lr=/[\t\n\f\r "#'()/;[\\\]{}]/g,ur=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,Mu=/.[\r\n"'(/\\]/,Gs=/[\da-f]/i,Iu=function(e,t={}){let r=e.css.valueOf(),i=t.ignoreErrors,s,o,a,l,u,c,f,d,h,w,v=r.length,p=0,m=[],W=[];function g(){return p}function B(fe){throw e.error("Unclosed "+fe,p)}function V(){return W.length===0&&p>=v}function G(fe){if(W.length)return W.pop();if(p>=v)return;let ke=fe?fe.ignoreUnclosed:!1;switch(s=r.charCodeAt(p),s){case ir:case Tt:case or:case ar:case sr:{o=p;do o+=1,s=r.charCodeAt(o);while(s===Tt||s===ir||s===or||s===ar||s===sr);w=["space",r.slice(p,o)],p=o-1;break}case Eu:case Tu:case Cu:case Nu:case Au:case _u:case Ru:{let Re=String.fromCharCode(s);w=[Re,Re,p];break}case ku:{if(d=m.length?m.pop()[1]:"",h=r.charCodeAt(p+1),d==="url"&&h!==hn&&h!==qs&&h!==Tt&&h!==ir&&h!==or&&h!==sr&&h!==ar){o=p;do{if(c=!1,o=r.indexOf(")",o+1),o===-1)if(i||ke){o=p;break}else B("bracket");for(f=o;r.charCodeAt(f-1)===nr;)f-=1,c=!c}while(c);w=["brackets",r.slice(p,o+1),p,o],p=o}else o=r.indexOf(")",p+1),l=r.slice(p,o+1),o===-1||Mu.test(l)?w=["(","(",p]:(w=["brackets",l,p,o],p=o);break}case hn:case qs:{a=s===hn?"'":'"',o=p;do{if(c=!1,o=r.indexOf(a,o+1),o===-1)if(i||ke){o=p+1;break}else B("string");for(f=o;r.charCodeAt(f-1)===nr;)f-=1,c=!c}while(c);w=["string",r.slice(p,o+1),p,o],p=o;break}case Ou:{lr.lastIndex=p+1,lr.test(r),lr.lastIndex===0?o=r.length-1:o=lr.lastIndex-2,w=["at-word",r.slice(p,o+1),p,o],p=o;break}case nr:{for(o=p,u=!0;r.charCodeAt(o+1)===nr;)o+=1,u=!u;if(s=r.charCodeAt(o+1),u&&s!==Hs&&s!==Tt&&s!==ir&&s!==or&&s!==ar&&s!==sr&&(o+=1,Gs.test(r.charAt(o)))){for(;Gs.test(r.charAt(o+1));)o+=1;r.charCodeAt(o+1)===Tt&&(o+=1)}w=["word",r.slice(p,o+1),p,o],p=o;break}default:{s===Hs&&r.charCodeAt(p+1)===Du?(o=r.indexOf("*/",p+2)+1,o===0&&(i||ke?o=r.length:B("comment")),w=["comment",r.slice(p,o+1),p,o],p=o):(ur.lastIndex=p+1,ur.test(r),ur.lastIndex===0?o=r.length-1:o=ur.lastIndex-2,w=["word",r.slice(p,o+1),p,o],m.push(w),p=o);break}}return p++,w}function we(fe){W.push(fe)}return{back:we,endOfFile:V,nextToken:G,position:g}},To=Ze,mr=class extends To{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}},Wn=mr;mr.default=mr;To.registerAtRule(mr);var ko=Ze,Ro,Co,pt=class extends ko{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,r){let i=super.normalize(e);if(t){if(r==="prepend")this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let s of i)s.raws.before=t.raws.before}return i}removeChild(e,t){let r=this.index(e);return!t&&r===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(e)}toResult(e={}){return new Ro(new Co,this,e).stringify()}};pt.registerLazyResult=n=>{Ro=n};pt.registerProcessor=n=>{Co=n};var Ot=pt;pt.default=pt;ko.registerRoot(pt);var Nt={comma(n){return Nt.split(n,[","],!0)},space(n){let e=[" ",`
`,"	"];return Nt.split(n,e)},split(n,e,t){let r=[],i="",s=!1,o=0,a=!1,l="",u=!1;for(let c of n)u?u=!1:c==="\\"?u=!0:a?c===l&&(a=!1):c==='"'||c==="'"?(a=!0,l=c):c==="("?o+=1:c===")"?o>0&&(o-=1):o===0&&e.includes(c)&&(s=!0),s?(i!==""&&r.push(i.trim()),i="",s=!1):i+=c;return(t||i!=="")&&r.push(i.trim()),r}},No=Nt;Nt.default=Nt;var _o=Ze,Fu=No,gr=class extends _o{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return Fu.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,r=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(r)}},$n=gr;gr.default=gr;_o.registerRule(gr);var Lu=xr,Pu=Iu,Uu=Er,Bu=Wn,Wu=Ot,Ys=$n,Js={empty:!0,space:!0};function $u(n){for(let e=n.length-1;e>=0;e--){let t=n[e],r=t[3]||t[2];if(r)return r}}var ju=class{constructor(e){this.input=e,this.root=new Wu,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t=new Bu;t.name=e[1].slice(1),t.name===""&&this.unnamedAtrule(t,e),this.init(t,e[2]);let r,i,s,o=!1,a=!1,l=[],u=[];for(;!this.tokenizer.endOfFile();){if(e=this.tokenizer.nextToken(),r=e[0],r==="("||r==="["?u.push(r==="("?")":"]"):r==="{"&&u.length>0?u.push("}"):r===u[u.length-1]&&u.pop(),u.length===0)if(r===";"){t.source.end=this.getPosition(e[2]),t.source.end.offset++,this.semicolon=!0;break}else if(r==="{"){a=!0;break}else if(r==="}"){if(l.length>0){for(s=l.length-1,i=l[s];i&&i[0]==="space";)i=l[--s];i&&(t.source.end=this.getPosition(i[3]||i[2]),t.source.end.offset++)}this.end(e);break}else l.push(e);else l.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}t.raws.between=this.spacesAndCommentsFromEnd(l),l.length?(t.raws.afterName=this.spacesAndCommentsFromStart(l),this.raw(t,"params",l),o&&(e=l[l.length-1],t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++,this.spaces=t.raws.between,t.raws.between="")):(t.raws.afterName="",t.params=""),a&&(t.nodes=[],this.current=t)}checkMissedSemicolon(e){let t=this.colon(e);if(t===!1)return;let r=0,i;for(let s=t-1;s>=0&&(i=e[s],!(i[0]!=="space"&&(r+=1,r===2)));s--);throw this.input.error("Missed semicolon",i[0]==="word"?i[3]+1:i[2])}colon(e){let t=0,r,i,s;for(let[o,a]of e.entries()){if(r=a,i=r[0],i==="("&&(t+=1),i===")"&&(t-=1),t===0&&i===":")if(!s)this.doubleColon(r);else{if(s[0]==="word"&&s[1]==="progid")continue;return o}s=r}return!1}comment(e){let t=new Uu;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let r=e[1].slice(2,-2);if(/^\s*$/.test(r))t.text="",t.raws.left=r,t.raws.right="";else{let i=r.match(/^(\s*)([^]*\S)(\s*)$/);t.text=i[2],t.raws.left=i[1],t.raws.right=i[3]}}createTokenizer(){this.tokenizer=Pu(this.input)}decl(e,t){let r=new Lu;this.init(r,e[0][2]);let i=e[e.length-1];for(i[0]===";"&&(this.semicolon=!0,e.pop()),r.source.end=this.getPosition(i[3]||i[2]||$u(e)),r.source.end.offset++;e[0][0]!=="word";)e.length===1&&this.unknownWord(e),r.raws.before+=e.shift()[1];for(r.source.start=this.getPosition(e[0][2]),r.prop="";e.length;){let u=e[0][0];if(u===":"||u==="space"||u==="comment")break;r.prop+=e.shift()[1]}r.raws.between="";let s;for(;e.length;)if(s=e.shift(),s[0]===":"){r.raws.between+=s[1];break}else s[0]==="word"&&/\w/.test(s[1])&&this.unknownWord([s]),r.raws.between+=s[1];(r.prop[0]==="_"||r.prop[0]==="*")&&(r.raws.before+=r.prop[0],r.prop=r.prop.slice(1));let o=[],a;for(;e.length&&(a=e[0][0],!(a!=="space"&&a!=="comment"));)o.push(e.shift());this.precheckMissedSemicolon(e);for(let u=e.length-1;u>=0;u--){if(s=e[u],s[1].toLowerCase()==="!important"){r.important=!0;let c=this.stringFrom(e,u);c=this.spacesFromEnd(e)+c,c!==" !important"&&(r.raws.important=c);break}else if(s[1].toLowerCase()==="important"){let c=e.slice(0),f="";for(let d=u;d>0;d--){let h=c[d][0];if(f.trim().indexOf("!")===0&&h!=="space")break;f=c.pop()[1]+f}f.trim().indexOf("!")===0&&(r.important=!0,r.raws.important=f,e=c)}if(s[0]!=="space"&&s[0]!=="comment")break}e.some(u=>u[0]!=="space"&&u[0]!=="comment")&&(r.raws.between+=o.map(u=>u[1]).join(""),o=[]),this.raw(r,"value",o.concat(e),t),r.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new Ys;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let t=this.current.nodes[this.current.nodes.length-1];t&&t.type==="rule"&&!t.raws.ownSemicolon&&(t.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="",e.type!=="comment"&&(this.semicolon=!1)}other(e){let t=!1,r=null,i=!1,s=null,o=[],a=e[1].startsWith("--"),l=[],u=e;for(;u;){if(r=u[0],l.push(u),r==="("||r==="[")s||(s=u),o.push(r==="("?")":"]");else if(a&&i&&r==="{")s||(s=u),o.push("}");else if(o.length===0)if(r===";")if(i){this.decl(l,a);return}else break;else if(r==="{"){this.rule(l);return}else if(r==="}"){this.tokenizer.back(l.pop()),t=!0;break}else r===":"&&(i=!0);else r===o[o.length-1]&&(o.pop(),o.length===0&&(s=null));u=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(s),t&&i){if(!a)for(;l.length&&(u=l[l.length-1][0],!(u!=="space"&&u!=="comment"));)this.tokenizer.back(l.pop());this.decl(l,a)}else this.unknownWord(l)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e);break}this.endFile()}precheckMissedSemicolon(){}raw(e,t,r,i){let s,o,a=r.length,l="",u=!0,c,f;for(let d=0;d<a;d+=1)s=r[d],o=s[0],o==="space"&&d===a-1&&!i?u=!1:o==="comment"?(f=r[d-1]?r[d-1][0]:"empty",c=r[d+1]?r[d+1][0]:"empty",!Js[f]&&!Js[c]?l.slice(-1)===","?u=!1:l+=s[1]:u=!1):l+=s[1];if(!u){let d=r.reduce((h,w)=>h+w[1],"");e.raws[t]={raw:d,value:l}}e[t]=l}rule(e){e.pop();let t=new Ys;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,r="";for(;e.length&&(t=e[e.length-1][0],!(t!=="space"&&t!=="comment"));)r=e.pop()[1]+r;return r}spacesAndCommentsFromStart(e){let t,r="";for(;e.length&&(t=e[0][0],!(t!=="space"&&t!=="comment"));)r+=e.shift()[1];return r}spacesFromEnd(e){let t,r="";for(;e.length&&(t=e[e.length-1][0],t==="space");)r=e.pop()[1]+r;return r}stringFrom(e,t){let r="";for(let i=t;i<e.length;i++)r+=e[i][1];return e.splice(t,e.length-t),r}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}},Vu=ju,zu=Ze,qu=Vu,Hu=Sr;function yr(n,e){let t=new Hu(n,e),r=new qu(t);try{r.parse()}catch(i){throw i}return r.root}var jn=yr;yr.default=yr;zu.registerParse(yr);var{isClean:Ue,my:Gu}=At,Yu=co,Ju=wr,Ku=Ze,Xu=Un;var Ks=Bn,Qu=jn,Zu=Ot,ec={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},tc={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},rc={Once:!0,postcssPlugin:!0,prepare:!0},ht=0;function kt(n){return typeof n=="object"&&typeof n.then=="function"}function Do(n){let e=!1,t=ec[n.type];return n.type==="decl"?e=n.prop.toLowerCase():n.type==="atrule"&&(e=n.name.toLowerCase()),e&&n.append?[t,t+"-"+e,ht,t+"Exit",t+"Exit-"+e]:e?[t,t+"-"+e,t+"Exit",t+"Exit-"+e]:n.append?[t,ht,t+"Exit"]:[t,t+"Exit"]}function Xs(n){let e;return n.type==="document"?e=["Document",ht,"DocumentExit"]:n.type==="root"?e=["Root",ht,"RootExit"]:e=Do(n),{eventIndex:0,events:e,iterator:0,node:n,visitorIndex:0,visitors:[]}}function _n(n){return n[Ue]=!1,n.nodes&&n.nodes.forEach(e=>_n(e)),n}var Dn={},mt=class Ao{constructor(e,t,r){this.stringified=!1,this.processed=!1;let i;if(typeof t=="object"&&t!==null&&(t.type==="root"||t.type==="document"))i=_n(t);else if(t instanceof Ao||t instanceof Ks)i=_n(t.root),t.map&&(typeof r.map>"u"&&(r.map={}),r.map.inline||(r.map.inline=!1),r.map.prev=t.map);else{let s=Qu;r.syntax&&(s=r.syntax.parse),r.parser&&(s=r.parser),s.parse&&(s=s.parse);try{i=s(t,r)}catch(o){this.processed=!0,this.error=o}i&&!i[Gu]&&Ku.rebuild(i)}this.result=new Ks(e,i,r),this.helpers={...Dn,postcss:Dn,result:this.result},this.plugins=this.processor.plugins.map(s=>typeof s=="object"&&s.prepare?{...s,...s.prepare(this.result)}:s)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let r=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,e.name==="CssSyntaxError"&&!e.plugin?(e.plugin=r.postcssPlugin,e.setMessage()):r.postcssVersion}catch(i){console&&console.error&&console.error(i)}return e}prepareVisitors(){this.listeners={};let e=(t,r,i)=>{this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push([t,i])};for(let t of this.plugins)if(typeof t=="object")for(let r in t){if(!tc[r]&&/^[A-Z]/.test(r))throw new Error(`Unknown event ${r} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!rc[r])if(typeof t[r]=="object")for(let i in t[r])i==="*"?e(t,r,t[r][i]):e(t,r+"-"+i.toLowerCase(),t[r][i]);else typeof t[r]=="function"&&e(t,r,t[r])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],r=this.runOnRoot(t);if(kt(r))try{await r}catch(i){throw this.handleError(i)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Ue];){e[Ue]=!0;let t=[Xs(e)];for(;t.length>0;){let r=this.visitTick(t);if(kt(r))try{await r}catch(i){let s=t[t.length-1].node;throw this.handleError(i,s)}}}if(this.listeners.OnceExit)for(let[t,r]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if(e.type==="document"){let i=e.nodes.map(s=>r(s,this.helpers));await Promise.all(i)}else await r(e,this.helpers)}catch(i){throw this.handleError(i)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if(typeof e=="object"&&e.Once){if(this.result.root.type==="document"){let t=this.result.root.nodes.map(r=>e.Once(r,this.helpers));return kt(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}else if(typeof e=="function")return e(this.result.root,this.result)}catch(t){throw this.handleError(t)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=Ju;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let i=new Yu(t,this.result.root,this.result.opts).generate();return this.result.css=i[0],this.result.map=i[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){let t=this.runOnRoot(e);if(kt(t))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Ue];)e[Ue]=!0,this.walkSync(e);if(this.listeners.OnceExit)if(e.type==="document")for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[r,i]of e){this.result.lastPlugin=r;let s;try{s=i(t,this.helpers)}catch(o){throw this.handleError(o,t.proxyOf)}if(t.type!=="root"&&t.type!=="document"&&!t.parent)return!0;if(kt(s))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:r,visitors:i}=t;if(r.type!=="root"&&r.type!=="document"&&!r.parent){e.pop();return}if(i.length>0&&t.visitorIndex<i.length){let[o,a]=i[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===i.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=o;try{return a(r.toProxy(),this.helpers)}catch(l){throw this.handleError(l,r)}}if(t.iterator!==0){let o=t.iterator,a;for(;a=r.nodes[r.indexes[o]];)if(r.indexes[o]+=1,!a[Ue]){a[Ue]=!0,e.push(Xs(a));return}t.iterator=0,delete r.indexes[o]}let s=t.events;for(;t.eventIndex<s.length;){let o=s[t.eventIndex];if(t.eventIndex+=1,o===ht){r.nodes&&r.nodes.length&&(r[Ue]=!0,t.iterator=r.getIterator());return}else if(this.listeners[o]){t.visitors=this.listeners[o];return}}e.pop()}walkSync(e){e[Ue]=!0;let t=Do(e);for(let r of t)if(r===ht)e.nodes&&e.each(i=>{i[Ue]||this.walkSync(i)});else{let i=this.listeners[r];if(i&&this.visitSync(i,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};mt.registerPostcss=n=>{Dn=n};var Oo=mt;mt.default=mt;Zu.registerLazyResult(mt);Xu.registerLazyResult(mt);var nc=co,ic=wr;var sc=jn,oc=Bn,An=class{constructor(e,t,r){t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=r,this._map=void 0;let i,s=ic;this.result=new oc(this._processor,i,this._opts),this.result.css=t;let o=this;Object.defineProperty(this.result,"root",{get(){return o.root}});let a=new nc(s,i,this._opts,t);if(a.isMap()){let[l,u]=a.generate();l&&(this.result.css=l),u&&(this.result.map=u)}else a.clearAnnotation(),this.result.css=a.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let e,t=sc;try{e=t(this._css,this._opts)}catch(r){this.error=r}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}},ac=An;An.default=An;var lc=ac,uc=Oo,cc=Un,fc=Ot,_t=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let r of e)if(r.postcss===!0?r=r():r.postcss&&(r=r.postcss),typeof r=="object"&&Array.isArray(r.plugins))t=t.concat(r.plugins);else if(typeof r=="object"&&r.postcssPlugin)t.push(r);else if(typeof r=="function")t.push(r);else if(!(typeof r=="object"&&(r.parse||r.stringify)))throw new Error(r+" is not a PostCSS plugin");return t}process(e,t={}){return!this.plugins.length&&!t.parser&&!t.stringifier&&!t.syntax?new lc(this,e,t):new uc(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}},dc=_t;_t.default=_t;fc.registerProcessor(_t);cc.registerProcessor(_t);var pc=xr,hc=so,mc=Er,gc=Wn,yc=Sr,bc=Ot,wc=$n;function Dt(n,e){if(Array.isArray(n))return n.map(i=>Dt(i));let{inputs:t,...r}=n;if(t){e=[];for(let i of t){let s={...i,__proto__:yc.prototype};s.map&&(s.map={...s.map,__proto__:hc.prototype}),e.push(s)}}if(r.nodes&&(r.nodes=n.nodes.map(i=>Dt(i,e))),r.source){let{inputId:i,...s}=r.source;r.source=s,i!=null&&(r.source.input=e[i])}if(r.type==="root")return new bc(r);if(r.type==="decl")return new pc(r);if(r.type==="rule")return new wc(r);if(r.type==="comment")return new mc(r);if(r.type==="atrule")return new gc(r);throw new Error("Unknown node type: "+n.type)}var vc=Dt;Dt.default=Dt;var xc=Fn,Mo=xr,Sc=Oo,Ec=Ze,Vn=dc,Tc=wr,kc=vc,Io=Un,Rc=Eo,Fo=Er,Lo=Wn,Cc=Bn,Nc=Sr,_c=jn,Dc=No,Po=$n,Uo=Ot,Ac=vr;function X(...n){return n.length===1&&Array.isArray(n[0])&&(n=n[0]),new Vn(n)}X.plugin=function(e,t){let r=!1;function i(...o){console&&console.warn&&!r&&(r=!0,console.warn(e+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(e+`: \u91CC\u9762 postcss.plugin \u88AB\u5F03\u7528. \u8FC1\u79FB\u6307\u5357:
https://www.w3ctech.com/topic/2226`));let a=t(...o);return a.postcssPlugin=e,a.postcssVersion=new Vn().version,a}let s;return Object.defineProperty(i,"postcss",{get(){return s||(s=i()),s}}),i.process=function(o,a,l){return X([i(l)]).process(o,a)},i};X.stringify=Tc;X.parse=_c;X.fromJSON=kc;X.list=Dc;X.comment=n=>new Fo(n);X.atRule=n=>new Lo(n);X.decl=n=>new Mo(n);X.rule=n=>new Po(n);X.root=n=>new Uo(n);X.document=n=>new Io(n);X.CssSyntaxError=xc;X.Declaration=Mo;X.Container=Ec;X.Processor=Vn;X.Document=Io;X.Comment=Fo;X.Warning=Rc;X.AtRule=Lo;X.Result=Cc;X.Input=Nc;X.Rule=Po;X.Root=Uo;X.Node=Ac;Sc.registerPostcss(X);var Oc=X;X.default=X;var re=zl(Oc);re.stringify;re.fromJSON;re.plugin;re.parse;re.list;re.document;re.comment;re.atRule;re.rule;re.decl;re.root;re.CssSyntaxError;re.Declaration;re.Container;re.Processor;re.Document;re.Comment;re.Warning;re.AtRule;re.Result;re.Input;re.Rule;re.Root;re.Node;var Mc=Oe("offscreen.modules.rrweb_compressor");function Ic(n){let e=n.document;return{left:e.scrollingElement?e.scrollingElement.scrollLeft:n.pageXOffset!==void 0?n.pageXOffset:e.documentElement.scrollLeft||e?.body?.scrollLeft||0,top:e.scrollingElement?e.scrollingElement.scrollTop:n.pageYOffset!==void 0?n.pageYOffset:e?.documentElement.scrollTop||e?.body?.scrollTop||0}}async function Bo(n,e){let r=[n,...e].sort((c,f)=>c.timestamp-f.timestamp),i=0,s=null;for(;!s&&i<r.length;){if(r[i].type===K.FullSnapshot){s=r[i];break}i++}if(!s){let c="Unable to find full snapshot for reconstruction";return Mc.error(c),be(new Q(c))}let o=r.slice(i),a=new Et(o),l=a.getMetaData();return await le(()=>new Promise((c,f)=>{a.setConfig({speed:1/0}),a.play(0),setTimeout(()=>{if(!a.iframe.contentDocument||!a.iframe.contentWindow)return f(new Q("Missing content document or window"));let d=to(a.iframe.contentDocument,{mirror:a.getMirror()});if(!d)return f(new Q("No compressed snapshot was produced"));let h={type:K.FullSnapshot,timestamp:l.endTime,delay:0,data:{node:d,initialOffset:Ic(a.iframe.contentWindow)}};return a.destroy(),c(h)},10)}))}async function Wo(n,e){let t=new Blob([n],{type:e}),r=Te(()=>URL.createObjectURL(t));return r.success,r}async function $o(n,e){let t=await Ie.getFile(n);return t.success?Te(()=>URL.createObjectURL(new Blob([t.value],{type:e??t.value.type}))):t}var HU=y.object().partial({backgroundColor:y.string(),toBlackAndWhite:y.boolean(),toGreyscale:y.boolean()});function jo(n){return Fc(n,{threshold:128})}function Fc(n,e){let t=n.data,r=e?.threshold;for(let i=0;i<t.length;i+=4){let s=t[i],o=t[i+1],a=t[i+2],l=.299*s+.587*o+.114*a;if(t[i]=t[i+1]=t[i+2]=l,r!=null){let u=l>=r?255:0;t[i]=t[i+1]=t[i+2]=u}}return n}var et=class n extends Q{_statusCode;_statusMessage;constructor(e,t,r){super(`HTTPError [${e}] for ${t}`),this._statusCode=e,this._statusMessage=r,this._type="HTTPError",this.setState({url:t,code:e,message:r})}get statusCode(){return this._statusCode}get statusMessage(){return this._statusMessage}static fromCode(e,t,r){switch(e){case 0:return new zn(t);case 401:return new qn(t,r);case 403:return new Hn(t,r);case 404:return new Gn(t,r);case 405:return new Yn(t,r);case 410:return new Jn(t,r);case 425:return new Kn(t,r);case 500:return new Xn(t,r);case 501:return new Qn(t,r);case 502:return new Zn(t,r);case 503:return new ei(t,r);case 504:return new ti(t,r);default:return new n(e,t,"Unknown HTTP Error")}}},Ye=class extends et{constructor(e,t,r="ClientHTTPError"){super(e,t,r)}},tt=class extends et{constructor(e,t,r="ServerHTTPError"){super(e,t,r)}},zn=class extends et{constructor(e){super(0,e,"Unable to connect to the server")}},qn=class extends Ye{constructor(e,t="Unauthorized"){super(401,e,t)}},Hn=class extends Ye{constructor(e,t="Forbidden"){super(403,e,t)}},Gn=class extends Ye{constructor(e,t="Not Found"){super(404,e,t)}},Yn=class extends Ye{constructor(e,t="Method Not Allowed"){super(405,e,t)}},Jn=class extends Ye{constructor(e,t="Gone"){super(410,e,t)}},Kn=class extends Ye{constructor(e,t="Too Early"){super(425,e,t)}},Xn=class extends tt{constructor(e,t="Internal Server Error"){super(500,e,t)}},Qn=class extends tt{constructor(e,t="Not Implemented"){super(501,e,t)}},Zn=class extends tt{constructor(e,t="Bad Gateway"){super(502,e,t)}},ei=class extends tt{constructor(e,t="Service Unavailable"){super(503,e,t)}},ti=class extends tt{constructor(e,t="Gateway Timeout"){super(504,e,t)}};var ri=Oe("common.utilities.image_data_extractor"),Tr=class n{#r;#e;#t;constructor(e){if(globalThis.ServiceWorkerGlobalScope)throw new Error("Image data extraction is not available in a service worker context");globalThis.DedicatedWorkerGlobalScope&&e==="dom"&&(ri.warn("DOM Canvas can not be used in a dedicated worker. Offscreen canvas will be used instead"),e="offscreen"),this.#r=e;let{canvas:t,context:r}=n.spawnCanvas(e);this.#e=t,this.#t=r}resetCanvas(e){let{canvas:t,context:r}=n.spawnCanvas(e);this.#e=t,this.#t=r}static spawnCanvas(e,t){let r=e==="dom"?document.createElement("canvas"):new OffscreenCanvas(t?.width??0,t?.height??0);e==="dom"&&t&&(r.width=t.width,r.height=t.height);let i=r.getContext("2d",{alpha:!0,willReadFrequently:!0});if(!i)throw new Error("Unable to get 2D rendering context from canvas");return i.imageSmoothingEnabled=!1,{canvas:r,context:i}}static extractImage=async e=>globalThis.Image?n.extractImageFromDom(e):n.extractImageFromBitmap(e);static async extractImageFromDom(e){let t=new Image;t.crossOrigin="Anonymous";let r=e instanceof Blob?URL.createObjectURL(e):e;return t.src=r,(!t.complete||t.naturalWidth===0)&&await new Promise((i,s)=>{let o=a=>{e instanceof Blob&&setTimeout(()=>URL.revokeObjectURL(r),1e3),t.removeEventListener("load",o),t.removeEventListener("error",o),a instanceof ErrorEvent?(ri.error(`Error extracting image from DOM [${e}]`,a.error),s(a.error)):i()};t.addEventListener("load",o),t.addEventListener("error",o)}),t}static async extractImageFromBitmap(e){let t=typeof e=="string"?await le(async()=>{let r=await fetch(e);if(r.ok)return r.blob();throw et.fromCode(r.status,e,r.statusText)}):await le(async()=>e);if(!t.success)throw ri.error("Error loading image from URL",e,t.error),new Error(`Failed to load image from url [${e}]`);return await createImageBitmap(t.value)}extractImageData=async(e,t=[{}],r)=>{let i=await n.extractImage(e),s="naturalWidth"in i?i.naturalWidth:i.width,o="naturalHeight"in i?i.naturalHeight:i.height;if(s===0||!(r?.(i,{width:s,height:o})??!0))return null;let a=[];this.#e.height=o,this.#e.width=s;for(let l of t){this.#t.clearRect(0,0,this.#e.width,this.#e.height),l.backgroundColor&&(this.#t.fillStyle=l.backgroundColor,this.#t.fillRect(0,0,this.#e.width,this.#e.height)),this.#t.drawImage(i,0,0);let u=Te(()=>this.#t.getImageData(0,0,this.#e.width,this.#e.height));if(!u.success){if(!(e instanceof Blob))throw u.error;this.resetCanvas(this.#r);let f=await new Promise((d,h)=>{let w=new FileReader;w.readAsDataURL(e),w.onload=()=>d(w.result),w.onerror=()=>h(w.error)});return this.extractImageData(f,t,r)}let c=l.toBlackAndWhite?jo(u.value):u.value;a.push({variation:l,data:c})}return a}};var Lc=new Tr("dom");async function Vo(n,e){return await Lc.extractImageData(n,e)??[]}async function zo(n){return Te(()=>URL.revokeObjectURL(n))}var Mt=new Yt;Mt.registerServiceDocumentModule("compressRrwebEvents",{requestPacking:"json",responsePacking:"json",handler:Bo});Mt.registerServiceDocumentModule("createObjectUrlFromBytes",{requestPacking:"binary-pack",responsePacking:"json",handler:Wo});Mt.registerServiceDocumentModule("createObjectUrlFromOpfs",{requestPacking:"json",responsePacking:"json",handler:$o});Mt.registerServiceDocumentModule("extractImageData",{requestPacking:"json",responsePacking:"binary-pack",handler:Vo});Mt.registerServiceDocumentModule("revokeObjectUrl",{requestPacking:"json",responsePacking:"json",handler:zo});})();
/*! Bundled license information:

rrweb/es/rrweb/ext/tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

rrweb/es/rrweb/ext/@xstate/fsm/es/index.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
